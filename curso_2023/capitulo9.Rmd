
```{r,echo=FALSE,message=FALSE,warning=FALSE}
library(knitr)
library(pander)
library(kableExtra)

# Set so that long lines in R will be wrapped:
opts_chunk$set(tidy.opts=list(width.cutoff=50),tidy=TRUE)

```

# Dados de Área II

## Introdução

- Hipótese de independência das observações em geral é Falsa ⇒ **Dependência Espacial**

- **Efeitos Espaciais** ⇒ Se existir forte tendência ou correlação espacial, os resultados serão influenciados,
apresentando associação estatística onde não existe (e vice-versa);

- **Como verificar?** ⇒ Medir a autocorrelação espacial dos resíduos da regressão (Índice de Moran dos resíduos).

- Autocorrelação espacial constatada! **E agora ?** ⇒  Utilizar Modelos de regressão que incorporam efeitos espaciais.

  <!-- - Globais: utilizam um único parâmetro para capturar a estrutura de correlação espacial; -->

  <!-- - Locais: parâmetros variam continuamente no espaço. -->


:::: {.greenbox data-latex=""}
::: {.center data-latex=""}
**Modelos Estatísticos espaciais VS Modelos Econométricos espacias** 
:::

Os primeiros  modelos em estatística espacial começam em meados da década de 1950 e ganham grande impulso com os trabalhos de Besag (1974); Besag and Moran (1975); Ord (1975) e o livro de Ripley (1981). 

Já os modelos econométricos espaciais começam a se desenvolver a partir do inicio da década de 1980, tendo entre seus pioneiros Luc Anselin, que desenvolveu muitos métodos nessa área. Alguns desses métodos diferem dos modelos tradicionais baseados em estatística espacial. E isso é relevante, pois Luc Anselin e colaboradores desenvolveram um software de análise espacial chamado GEODA baseado nos princípios de econometria espacial! Ainda que alguns métodos sejam em comum com a estatística espacial, por exemplo o I de Moran, os modelos de regressão partem de visões diferentes sobre a como incorporar a autocorrelação espacial. Os modelos espaciais econométricos são chamados *spatial lag model (SAR)* e *spatial error model (CAR)*, porém **não são os mesmos CAR e SAR da modelagem estatística espacial!**  

Em epidemiologia os modelos de regressão espacial são baseados essencialmente nos modelos estatísticos espaciais que colocam a estrutura de correlação junto ao componente de erro.

Assim sendo é necessário atenção ao utilizar o GEODA e outros softwares dedicados para se certificar se estão de acordo com a maioria dos modelos empregados em Epidemiologia! 

::::


## Modelos Estatísticos Espaciais

<!-- **Suposição:** É possível capturar a estrutura de correlação espacial num único parâmetro (adicionado ao modelo de regressão). -->

Considerando:

$$ Y = X\beta + e $$
Sendo:

- $Y$ o vetor do desfecho nas áreas $i = 1, 2, ..., N$.

- $beta$ o vetor de coeficientes das variáveis do vetor $X$.

- $e$ o vetor dos erros aleatórios,

Os modelos vão se diferenciar na forma de estimar $e$!


<!-- Não gostei dessa forma de apresentar, onde está o peso, efeitos fixos! -->
<!-- R: Apresentados abaixo, nos subitens respectivos. Segui Bivand e Waller  -->

<!-- **Atenção!** Os dados devem ter uma distribuição normal! Podem ser aplicadas transformações. -->

Alguns tipos de modelos espaciais:

  - **Simultaneous Autoregressive Models (SAR)** 

  - **Conditional Autoregressive Models (CAR)** 

Ambos os tipos de modelos incluem a dependência espacial no erro aleatório. 


:::: {.blackbox data-latex=""}
::: {.center data-latex=""}
**Atenção!**
:::
Em econometria espacial, SAR significa Spatial Autoregressive e se refere ao modelo spatial lag.
::::


### Simultaneous Autoregressive Models (SAR)

<!-- **Suposição:** O erro de cada área $e_i$ depende dos erros das outras áreas. -->


<!-- $$e_i = \sum^{N}_{j=1} b_{ij}e_j + \varepsilon_i$$ -->
<!-- Sendo, -->

<!--   - $\varepsilon_i$ os erros independentes;  -->

<!--   - $b_{ij}$ a dependência espacial entre áreas *i* e *j*. -->
  
<!-- Sendo: -->

$$ e = \lambda W(Y - X \beta) + \varepsilon $$ 
Sendo:

- $\lambda$ o parâmetro de autocorrelação espacial
- $W$ a matriz de dependência espacial (de vizinhança)
- $\varepsilon$ o vetor dos erros independentes

Então, para o modelo SAR:

$$ Y = X\beta + \lambda W(Y - X\beta) + \varepsilon $$

Pode ser ajustado pela função `spautolm` do pacote `spatialreg`. 

**Atenção!**

Antigamente a função `spautolm` encontrava-se no pacote `spdep`.


### Conditional Autoregressive Models (CAR)

Introduzidos por Besag em 1974.

<!-- **Suposição:** Os erros espaciais possuem uma distribuição condicional. -->

$$ e_i | e_{j \sim i} \sim N \bigg( \sum_{j \sim i} {{c_{ij}e_j} \over {\sum_{j \sim j} c_{ij}}} , {{\sigma^2_{e_i}} \over \sum_{j \sim i} c_{ij}} \bigg)  $$
Sendo,

  - $c_{ij}$ os parâmetros de dependência espacial 

Também pode ser ajustado pela função `spautolm`, especificando `family = "CAR"`. 



<!-- Oswaldo, fiquei na dúvida onde é o lambda do modelo CAR, e não consegui entender exatamente a difererença entre eles na prática. -->
  

<!-- O lambda está no termo de erro do CAR -->



<!-- ### Modelos SAR vs CAR -->

<!-- - Motivações diferentes, porém próximas em termos formais; -->
<!-- - Premissa: processo espacial analisado é estacionário e -->
<!-- pode ser capturado em um único parâmetro; -->
<!-- - Porém isto nem sempre é verdade ! -->
<!--   - Verificar se padrões diversos de associação espacial estão presentes; -->
<!--   - Indicadores Locais de Autocorrelação Espacial; -->
<!--   - Resumindo, fazer uma boa análise exploratória de dados espaciais. -->






  
### Exemplo prático

Vamos modelar espacialmente a taxa de detecção da hanseníase em Olinda/PE.

```{r, echo=T, warning=FALSE, results='hide', message = FALSE, out.width = "80%", fig.align = "center"}

library(sf)
library(spdep)
library(spatialreg)
library(ggplot2)

```

Antes de mais nada como na aula anterior vamos baixar o *ZIP* contendo os arquivos no formato **shape**

```{r, echo=T, warning=FALSE, results='hide', message = FALSE, out.width = "100%", fig.align = "center"}

#opções para o Windows não se perder
options(download.file.method='libcurl',url.method='libcurl')

#local dos dados na rede
local <- 'https://gitlab.procc.fiocruz.br/oswaldo/eco2019/raw/master/dados/'

tmpdir <- tempdir()
download.file(paste0(local,'olinda.zip'),
              destfile = paste0(tmpdir,'/olinda.zip'))

unzip(zipfile = paste0(tmpdir,'/olinda.zip'),exdir = tmpdir)
dir(tmpdir)

```

Leando o shape file de Olinda/PE.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", results='markdown'}

olinda.sf <- read_sf(paste0(tmpdir,'/olinda.shp'), crs = 5535)

# Calculando a taxa

olinda.sf$tx <- olinda.sf$CASES*10000/olinda.sf$POP

```

Fazendo o sumário estatístico da variável taxa.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA}

summary(olinda.sf$tx)

```

Criando a matriz de vizinhaça por contiguidade.

```{r, echo=T, warning=FALSE, results='asis', message = FALSE, out.width = "80%", fig.align = "center"}
viz <- poly2nb(olinda.sf)
pesos.viz <- nb2listw(viz)

```

Ajustando o modelo de regressão linear simples.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

olinda.lm <- lm(tx ~ DEPRIV, data=olinda.sf)
summary(olinda.lm)

```

Checando os residuos para verificar a presença de autocorrelação.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}


olinda.lm$lmresid<-residuals(olinda.lm)
moran.test(olinda.lm$lmresid, pesos.viz)

```

Ajustando o modelo SAR.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

olinda.sar <- spautolm (tx ~ DEPRIV, data=olinda.sf, listw=pesos.viz,family="SAR")
summary(olinda.sar)

```

Checando os residuos para verificar a presença de autocorrelação.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

olinda.sar$lagresid<-residuals(olinda.sar)
moran.test(olinda.sar$lagresid, pesos.viz)

```

Ajustando o modelo CAR.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

olinda.car <- spautolm (tx ~ DEPRIV, data=olinda.sf, listw=pesos.viz,family = "CAR")
summary(olinda.car)

```

Checando os residuos para verificar a presença de autocorrelação.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}


olinda.car$carresid<-residuals(olinda.car)
moran.test(olinda.car$carresid, pesos.viz)

```

Mapeando os valores observados e preditos dos modelos ajustados

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

library(colorspace) 

olinda.sf$brks <- cut(olinda.sf$tx, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-0.01, 0, 15, 30, 45, 100, 231), 
                   labels=c("0", "0 - 15", "15 - 30", "30 - 45", "45 - 100", "> 100"))

tx.bruta <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks), color = 'black') +
  ggtitle("Taxa Bruta") + 
  scale_fill_discrete_sequential(palette ='Heat',  
                                 c1=80,c2 =30,l1=30,l2=90,p1=0.2,p2=1.5,
                                 na.value = "grey75", 
                                 drop=FALSE,
                                 name='Taxa') +
  theme_void()
  
  
 
olinda.sf$brks.lm <- cut(olinda.lm$fitted.values, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-0.01, 0, 15, 30, 45, 100, 231), 
                   labels=c("0", "0 - 15", "15 - 30", "30 - 45", "45 - 100", "> 100"))


tx.lm <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks.lm), color = 'black') +
  ggtitle("Taxa Predita - LM") + 
  scale_fill_discrete_sequential(palette ='Heat',  
                                 c1=80,c2 =30,l1=30,l2=90,p1=0.2,p2=1.5,
                                 na.value = "grey75", 
                                 drop=FALSE,
                                 name='Taxa') +
  theme_void()

olinda.sf$brks.sar <- cut(olinda.sar$fit$fitted.values, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-0.01, 0, 15, 30, 45, 100, 231), 
                   labels=c("0", "0 - 15", "15 - 30", "30 - 45", "45 - 100", "> 100"))


tx.sar <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks.sar), color = 'black') +
  ggtitle("Taxa Predita - SAR") + 
  scale_fill_discrete_sequential(palette ='Heat', 
                                 c1=80,c2 =30,l1=30,l2=90,p1=0.2,p2=1.5,
                                 na.value = "grey75", 
                                 drop=FALSE,
                                 name='Taxa') +
  theme_void()

olinda.sf$brks.car <- cut(olinda.car$fit$fitted.values, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-0.01, 0, 15, 30, 45, 100, 231), 
                   labels=c("0", "0 - 15", "15 - 30", "30 - 45", "45 - 100", "> 100"))


tx.car <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks.car), color = 'black') +
  ggtitle("Taxa Predita - CAR") + 
  scale_fill_discrete_sequential(palette ='Heat', 
                                 c1=80,c2 =30,l1=30,l2=90,p1=0.2,p2=1.5,
                                 na.value = "grey75", 
                                 drop=FALSE,
                                 name='Taxa') +
  theme_void()


library(ggpubr)
ggarrange(tx.bruta, tx.lm, tx.sar, tx.car, ncol=2, nrow=2,
          common.legend = TRUE, legend = 'right')

```

Verificando a distribuição dos resíduos.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
library(vioplot)
vioplot(olinda.lm$residuals, olinda.sar$fit$residuals, olinda.car$fit$residuals, 
        names=c("LM", "SAR", "CAR"),
        col="gold")
title("Gráficos violinos da distribuição dos resíduos")



```

Mapeando a distribuição dos resíduos.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

olinda.sf$brks.res.lm <- cut(olinda.lm$residuals, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-116, -20, -1, 1, 20, 176), 
                   labels=c("< -20", "-20 - 0", "0", "0 - 20", "> 20"))


res.lm <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks.res.lm), color = 'black') +
  ggtitle("Resíduos - LM") + 
  scale_fill_discrete_sequential(palette ='Heat', 
                                 na.value = "grey75", 
                                 name='Taxa') +
  theme_void()



olinda.sf$brks.res.sar <- cut(olinda.sar$fit$residuals, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-116, -20, -1, 1, 20, 176), 
                   labels=c("< -20", "-20 - 0", "0", "0 - 20", "> 20"))

res.sar <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks.res.lm), color = 'black') +
  ggtitle("Resíduos - SAR") + 
  scale_fill_discrete_sequential(palette ='Heat', 
                                 na.value = "grey75", 
                                 name='Taxa') +
  theme_void()



olinda.sf$brks.res.car <- cut(olinda.car$fit$residuals, include.lowest=TRUE,  right=TRUE,
                   breaks=c(-116, -20, -1, 1, 20, 176), 
                   labels=c("< -20", "-20 - 0", "0", "0 - 20", "> 20"))


res.car <- ggplot(olinda.sf) + 
  geom_sf(aes(fill = brks.res.lm), color = 'black') +
  ggtitle("Resíduos - CAR") + 
  scale_fill_discrete_sequential(palette ='Heat', 
                                 na.value = "grey75", 
                                 name='Taxa') +
  theme_void()


ggarrange(res.lm, res.sar, res.car, ncol=2, nrow=2, 
          common.legend = TRUE, legend = 'right')

```


<!-- Oswaldo, eu não sei se essa parte abaixo está correta. Me parece que os modelos anteriores são local também, pelo menos o CAR -->

## Modelos com Efeitos Espaciais Locais

- Tais modelos consideram o espaço geográfico heterogêneo ou não-estacionário e a relação entre as variáveis dependentes e independentes assume padrões mais ou menos regionalizados;

- Os parâmetros estimados podem ser mapeados para examinar as variações locais;

- Idem para os erros dos parâmetros;

- Possibilidade de testar, por exemplo, a hipótese da variação dos parâmetros da área de estudo ser ou não
aleatória.

Ex: 

- Regressão Geograficamente Ponderada (GWR)

- Modelos Bayesianos Completos (Bugs,WinBugs,OpenBugs,JAGS,Stan,BayesX,Nimble,etc...)

- INLA (integrated nested Laplace approximations)


### Regressão Geograficamente Ponderada (GWR)

- Ajusta um modelo de regressão a cada ponto observado, ponderando todas as demais observações como função da distância deste ponto;

$$Y(s) = \beta(s)X+e$$

Sabendo que:

- $Y(s)$: É a variável que representa o processo no ponto $s$;

- $\beta(s)$: São os parâmetros estimados no ponto $s$;

- Para estimar os parâmetros desse modelo, a solução é o uso de um estimador baseado em mínimos quadrados generalizado por algum métodos de ajuste local (ex: *kernel*);


$$\beta(s) = (X^T W(s) X)^{-1}X^T W(s)Y$$

- O ajuste local é feito de forma a garantir uma influência maior dos pontos mais próximos (como o kernel);

- Valor da largura de banda;

- As duas funções mais usadas para o cálculo dos pesos é a *"bi-square"* e a *"gaussiana"*;

- Tais modelos consideram o espaço geográfico heterogêneo ou não-estacionário e a relação entre as variáveis dependentes e independentes assume padrões mais ou menos regionalizados;

- Os parâmetros estimados podem ser mapeados para examinar as variações locais;

- Idem para os erros dos parâmetros;

- Possibilidade de testar, por exemplo, a hipótese da variação dos parâmetros da área de estudo ser ou não aleatória;

- O método **GWR** permite a realização de estudos de fenômenos com diferentes nı́veis de heterogeneidade espacial;

- Mapeamentos de diagnóstico e dos parâmetros permitem novas interpretações e *insights* de padrões espaciais.


Ex: Vamos modelar a taxa de detecção de hanseníase em Olinada/PE utilizando um modelo GWR.

Primeiramente vamos transformar os centroides dos setores censitários em formato *sp*, pois iremnos precisar das colunas referentes as coordenadas.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
centroides <- st_centroid(st_geometry(olinda.sf))
centroides.sp <- as.data.frame(as_Spatial(centroides))
names(centroides.sp) <- c('X','Y')

plot(centroides.sp)

```

Precisamos estimar a largura de banda **"ideal"** para o *kernel*

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
# Biblioteca para ajustar o  modelos GWR
library(spgwr)
GWRbanda <- gwr.sel(tx ~ DEPRIV, data=olinda.sf, coords=cbind(centroides.sp$X,centroides.sp$Y) , adapt=T) 
GWRbanda
```


Ajustando o modelo *GWR*

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

gwr.model = gwr(tx ~ DEPRIV, data=olinda.sf, coords=cbind(centroides.sp$X,centroides.sp$Y), adapt=GWRbanda, hatmatrix=TRUE, se.fit=TRUE) 

gwr.model

```

Colocando a saída do modelo dentro de um dataframe.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
results<-as.data.frame(gwr.model$SDF)
head(results)

```

Verificando a distribuição dos coeficientes de regressão para a variável **DEPRIVED**

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
hist(results$DEPRIV)
abline(v = median(results$DEPRIV), col="blue")

```

Verificando a distribuição dos **localR2**

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
hist(results$localR2)
abline(v =median(results$localR2), col="blue")

```

Incorporando alguns parâmetros de saída do modelo na tabela *olinda.sf*

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

olinda.sf$coefDEPRIV <- results$DEPRIV
olinda.sf$localR2 <- results$localR2
olinda.sf$pred.gwr <- results$pred

```

Definindo as paletes de cores para a construção dos mapas.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
library(wesanderson)
names(wes_palettes)
pal <- wes_palette("Zissou1", 50, type = "continuous")

```

Mapa dos coeficientes de regressão para a variável **DEPRIVED**

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
ggplot(olinda.sf) + 
  geom_sf(aes(fill = coefDEPRIV), color = 'black') +
  scale_fill_gradientn(colours = pal) +
  ggtitle("Distribuição dos coef. var. DEPRIV") + 
  theme_void()

```

Mapa dos coeficientes de determinação regionalizados ($R^2$ local).

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

ggplot(olinda.sf) + 
  geom_sf(aes(fill = localR2), color = 'black') +
  scale_fill_gradientn(colours = pal) +
  ggtitle("R² local") + 
  theme_void()

```

Mapa dos valores preditos a partir do GWR.
```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

ggplot(olinda.sf) + 
  geom_sf(aes(fill = pred.gwr), color = 'black') +
  scale_fill_gradientn(colours = pal) +
  ggtitle("Valores Preditos do GWR") + 
  theme_void()

```

Vewrificando o processo de predição do modelo.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}

plot(olinda.sf$tx, olinda.sf$pred.gwr)

```

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
cor(olinda.sf$tx, olinda.sf$pred.gwr)

```

Verificando a autocorrelação espacial dos resíduos.

```{r echo=T, fig.align="center", message=FALSE, warning=FALSE, comments=NA, out.width="80%", comment=NA, results='markdown'}
moran.test((olinda.sf$tx - olinda.sf$pred.gwr), pesos.viz)

```

Podemos verificar que a hipótese de autocorrelação foi descartada.

<!-- ## Observação -->

<!-- :::: {.greenbox data-latex=""} -->
<!-- ::: {.center data-latex=""} -->
<!-- Observação  -->
<!-- :::   -->
<!-- O pacote **spdep**  antes disponibilizava as funções de modelagem para SAR e CAR mas foi substituido pelo pacote **spatialreg** (Spatial Regression Analysis) que devera ser usado.  A função **spautolm()**  deve ser usada tanto para SAR quanto para o CAR usando a especificação *family="CAR"* , *family="SAR"*  ou ainda *family="SMA"*  este ultimo para modelos de médias moveis espaciais.  -->
<!-- :::  -->

<!-- acho interessante manter caso achem uma referencia antiga na internet -->
<!-- R: Coloquei lá em cima onde falamos da função a primeira vez -->

## Bibliografia sugerida

Applied Spatial Data Analysis with R;  Roger S. Bivand, Edzer Pebesma , Virgilio Gomez-Rubio Springer; Edição: 2nd ed. 2013

Fotheringham, A. S., Brunsdon, C., and Charlton, M. E. Geographically
Weighted Regression: The Analysis of Spatially Varying Relationships. Wiley,
Chichester. 2002.

Lloyd, C. D. (2007). Local Models for Spatial Analysis. CRC, Boca Raton.
Schabenberger, O. and Gotway, C. A. Statistical Methods for Spatial Data
Analysis. Chapman & Hall, London. 2005.

Ver Hoef, Jay M.; Hanks, Ephraim M.; Hooten, Mevin B. On the relationship between conditional (CAR) and simultaneous (SAR) autoregressive models. Spatial statistics, v. 25, p. 68-85, 2018.

Waller, L. A. and Gotway, C. A. Applied Spatial Statistics for Public Health
Data. Wiley, Hoboken, NJ. 2004.

Ward, M.D. and K.S. Gleditsch.  Spatial Regression Models.  Thousand Oaks, CA: Sage. 2008.

Wheeler, D. and Tiefelsdorf, M. Multicollinearity and correlation among local
regression coefficients in geographically weighted regression. Journal of Geograph-
ical Systems, 7:161–187. 2005.

* Online

[Geographically Weighted Regression - Roger Bivand (2017)](https://cran.r-project.org/web/packages/spgwr/vignettes/GWR.pdf)

[Coordinate Reference Systems(CRS)](https://www.nceas.ucsb.edu/~frazier/RSpatialGuides/OverviewCoordinateReferenceSystems.pdf)