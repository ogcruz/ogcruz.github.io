<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 7 Padrões Pontuais I | ESTUDOS ECOLÓGICOS 2023</title>
  <meta name="description" content=" 7 Padrões Pontuais I | ESTUDOS ECOLÓGICOS 2023" />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content=" 7 Padrões Pontuais I | ESTUDOS ECOLÓGICOS 2023" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 7 Padrões Pontuais I | ESTUDOS ECOLÓGICOS 2023" />
  
  
  

<meta name="author" content="Oswaldo G Cruz" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introdução-à-análise-estatística-espacial.html"/>
<link rel="next" href="padrões-pontuais-ii.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.26/datatables.js"></script>
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estudos Ecológicos 2023</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="apresentação.html"><a href="apresentação.html"><i class="fa fa-check"></i><b>1</b> Apresentação</a></li>
<li class="chapter" data-level="2" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html"><i class="fa fa-check"></i><b>2</b> Estudos Ecológicos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#o-que-são-estudos-ecológicos"><i class="fa fa-check"></i><b>2.1</b> O que são Estudos Ecológicos ?</a></li>
<li class="chapter" data-level="2.2" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#principais-objetivos"><i class="fa fa-check"></i><b>2.2</b> Principais objetivos</a></li>
<li class="chapter" data-level="2.3" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#tipos-de-variáveis-utilizadas"><i class="fa fa-check"></i><b>2.3</b> Tipos de Variáveis Utilizadas</a></li>
<li class="chapter" data-level="2.4" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#tipos-de-desenhos-de-estudos-ecológicos"><i class="fa fa-check"></i><b>2.4</b> Tipos de Desenhos de Estudos Ecológicos</a></li>
<li class="chapter" data-level="2.5" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#aspectos-históricos"><i class="fa fa-check"></i><b>2.5</b> Aspectos históricos</a></li>
<li class="chapter" data-level="2.6" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#epidemiologia-social"><i class="fa fa-check"></i><b>2.6</b> Epidemiologia social</a></li>
<li class="chapter" data-level="2.7" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#árvores-bosques-ou-as-florestas"><i class="fa fa-check"></i><b>2.7</b> Árvores, Bosques ou as Florestas?</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#as-árvores"><i class="fa fa-check"></i><b>2.7.1</b> As Árvores</a></li>
<li class="chapter" data-level="2.7.2" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#os-bosques"><i class="fa fa-check"></i><b>2.7.2</b> Os Bosques</a></li>
<li class="chapter" data-level="2.7.3" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#as-florestas"><i class="fa fa-check"></i><b>2.7.3</b> As Florestas</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#falácia-ecológica-ou-viés-de-agregação"><i class="fa fa-check"></i><b>2.8</b> Falácia Ecológica ou viés de agregação</a></li>
<li class="chapter" data-level="2.9" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#problemas-práticos"><i class="fa fa-check"></i><b>2.9</b> Problemas práticos</a></li>
<li class="chapter" data-level="2.10" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#vantagens"><i class="fa fa-check"></i><b>2.10</b> Vantagens</a></li>
<li class="chapter" data-level="2.11" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#desvantagens"><i class="fa fa-check"></i><b>2.11</b> Desvantagens</a></li>
<li class="chapter" data-level="2.12" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#resumindo"><i class="fa fa-check"></i><b>2.12</b> Resumindo</a></li>
<li class="chapter" data-level="2.13" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#exercícios-propostos"><i class="fa fa-check"></i><b>2.13</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="2.14" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#bibliografia-sugerida"><i class="fa fa-check"></i><b>2.14</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html"><i class="fa fa-check"></i><b>3</b> Introdução às Séries Temporais</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#o-que-são-séries-temporais"><i class="fa fa-check"></i><b>3.1</b> O que são Séries Temporais ?</a></li>
<li class="chapter" data-level="3.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#hipóteses-básicas-do-estudo-das-séries-temporais"><i class="fa fa-check"></i><b>3.2</b> Hipóteses básicas do estudo das séries temporais</a></li>
<li class="chapter" data-level="3.3" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#classificação-dos-tipos-de-séries-temporais"><i class="fa fa-check"></i><b>3.3</b> Classificação dos tipos de séries temporais</a></li>
<li class="chapter" data-level="3.4" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#processo-estocástico"><i class="fa fa-check"></i><b>3.4</b> Processo Estocástico</a></li>
<li class="chapter" data-level="3.5" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#notação-e-nomenclatura"><i class="fa fa-check"></i><b>3.5</b> Notação e Nomenclatura</a></li>
<li class="chapter" data-level="3.6" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#objetivos-análise-de-séries-temporais"><i class="fa fa-check"></i><b>3.6</b> Objetivos: análise de séries temporais</a></li>
<li class="chapter" data-level="3.7" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#estacionariedade"><i class="fa fa-check"></i><b>3.7</b> Estacionariedade</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#função-de-autocovariância-de-um-processo-estacionário"><i class="fa fa-check"></i><b>3.7.1</b> Função de Autocovariância de um processo estacionário</a></li>
<li class="chapter" data-level="3.7.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#por-que-a-estacionariedade-é-importante"><i class="fa fa-check"></i><b>3.7.2</b> Por que a estacionariedade é importante ?</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#pressuposto-da-independência"><i class="fa fa-check"></i><b>3.8</b> Pressuposto da Independência</a></li>
<li class="chapter" data-level="3.9" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#dependência-serial"><i class="fa fa-check"></i><b>3.9</b> Dependência serial</a></li>
<li class="chapter" data-level="3.10" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#função-de-autocorrelação---fac-autocorrelation-function---acf"><i class="fa fa-check"></i><b>3.10</b> Função de Autocorrelação - FAC (<em>Autocorrelation function - ACF</em>)</a></li>
<li class="chapter" data-level="3.11" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#componentes-de-uma-série-temporal"><i class="fa fa-check"></i><b>3.11</b> Componentes de uma Série Temporal</a></li>
<li class="chapter" data-level="3.12" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#tendência"><i class="fa fa-check"></i><b>3.12</b> Tendência</a></li>
<li class="chapter" data-level="3.13" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#sazonalidade"><i class="fa fa-check"></i><b>3.13</b> Sazonalidade</a></li>
<li class="chapter" data-level="3.14" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#ciclo"><i class="fa fa-check"></i><b>3.14</b> Ciclo</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#como-detectar-a-sazonalidade"><i class="fa fa-check"></i><b>3.14.1</b> Como detectar a sazonalidade ?</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#termo-aleatório-ou-ruído-branco"><i class="fa fa-check"></i><b>3.15</b> Termo Aleatório ou Ruído Branco</a></li>
<li class="chapter" data-level="3.16" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#composição-dos-modelos-de-séries-temporais"><i class="fa fa-check"></i><b>3.16</b> Composição dos Modelos de séries temporais</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#modelo-aditivo"><i class="fa fa-check"></i><b>3.16.1</b> Modelo Aditivo</a></li>
<li class="chapter" data-level="3.16.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#modelo-multiplicativo"><i class="fa fa-check"></i><b>3.16.2</b> Modelo Multiplicativo</a></li>
</ul></li>
<li class="chapter" data-level="3.17" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#decomposição-de-séries-temporais"><i class="fa fa-check"></i><b>3.17</b> Decomposição de séries temporais</a></li>
<li class="chapter" data-level="3.18" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#prática-no-r"><i class="fa fa-check"></i><b>3.18</b> Prática no R</a>
<ul>
<li class="chapter" data-level="3.18.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#a-biblioteca-ts-é-a-mais-utilizada-no-r"><i class="fa fa-check"></i><b>3.18.1</b> A biblioteca <em>ts</em> é a mais utilizada no R</a></li>
<li class="chapter" data-level="3.18.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#simulando-uma-série-temporal"><i class="fa fa-check"></i><b>3.18.2</b> Simulando uma Série Temporal</a></li>
<li class="chapter" data-level="3.18.3" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#importando-uma-vetor-e-transformando-em-série-temporal"><i class="fa fa-check"></i><b>3.18.3</b> Importando uma vetor e transformando em Série Temporal</a></li>
<li class="chapter" data-level="3.18.4" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#utilizando-dados-da-incidência-de-dengue-nas-filipinas-2008---2016"><i class="fa fa-check"></i><b>3.18.4</b> Utilizando dados da incidência de dengue nas Filipinas, 2008 - 2016</a></li>
</ul></li>
<li class="chapter" data-level="3.19" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#exercícios-propostos-1"><i class="fa fa-check"></i><b>3.19</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="3.20" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#outros-materiais-sobre-séries-temporais"><i class="fa fa-check"></i><b>3.20</b> Outros materiais sobre Séries Temporais</a></li>
<li class="chapter" data-level="3.21" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#bibliografia-sugerida-1"><i class="fa fa-check"></i><b>3.21</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html"><i class="fa fa-check"></i><b>4</b> Transformações e Suavizações</a>
<ul>
<li class="chapter" data-level="4.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#introdução"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#transfomação-dos-dados-em-st"><i class="fa fa-check"></i><b>4.2</b> Transfomação dos dados em ST</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#transformações-box-cox-diferenciação-e-logarítmica"><i class="fa fa-check"></i><b>4.2.1</b> Transformações Box-Cox, Diferenciação e Logarítmica</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#métodos-de-alisamento-ou-suavização"><i class="fa fa-check"></i><b>4.3</b> Métodos de Alisamento ou Suavização</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#algumas-funções-de-suavização"><i class="fa fa-check"></i><b>4.3.1</b> Algumas funções de suavização</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#médias-móveis"><i class="fa fa-check"></i><b>4.4</b> Médias móveis</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#utilização-das-médias-móveis"><i class="fa fa-check"></i><b>4.4.1</b> Utilização das Médias Móveis</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#kernel"><i class="fa fa-check"></i><b>4.5</b> Kernel</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#diferentes-funções-kernel"><i class="fa fa-check"></i><b>4.5.1</b> Diferentes Funções Kernel</a></li>
<li class="chapter" data-level="4.5.2" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#largura-de-banda"><i class="fa fa-check"></i><b>4.5.2</b> Largura de Banda</a></li>
<li class="chapter" data-level="4.5.3" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#utilização-do-kernel"><i class="fa fa-check"></i><b>4.5.3</b> Utilização do Kernel</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#loess-lowess"><i class="fa fa-check"></i><b>4.6</b> Loess / Lowess</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#utilização-do-loesslowess"><i class="fa fa-check"></i><b>4.6.1</b> Utilização do loess/lowess</a></li>
<li class="chapter" data-level="4.6.2" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#comparando"><i class="fa fa-check"></i><b>4.6.2</b> Comparando</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#splines"><i class="fa fa-check"></i><b>4.7</b> Splines</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#splines-vs-loesslowess"><i class="fa fa-check"></i><b>4.7.1</b> Splines <em>vs</em> Loess/Lowess</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#exercícios-propostos-2"><i class="fa fa-check"></i><b>4.8</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="4.9" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#bibliografia-sugerida-2"><i class="fa fa-check"></i><b>4.9</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html"><i class="fa fa-check"></i><b>5</b> Modelagem em Séries Temporais</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#o-que-são-os-modelos-box-jenkins"><i class="fa fa-check"></i><b>5.1</b> O que são os Modelos Box &amp; Jenkins</a></li>
<li class="chapter" data-level="5.2" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#alguns-processos-estocásticos"><i class="fa fa-check"></i><b>5.2</b> Alguns processos estocásticos</a></li>
<li class="chapter" data-level="5.3" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-arima"><i class="fa fa-check"></i><b>5.3</b> Modelo ARIMA</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-autorregressivo-de-ordem-p---arp-ou-arimap00"><i class="fa fa-check"></i><b>5.3.1</b> Modelo Autorregressivo de ordem <em>p</em> - AR(p) ou ARIMA(p,0,0)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#condições-de-estacionariedade"><i class="fa fa-check"></i><b>5.3.2</b> Condições de estacionariedade</a></li>
<li class="chapter" data-level="5.3.3" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-de-médias-móveis-de-ordem-q---maq-ou-arima00q"><i class="fa fa-check"></i><b>5.3.3</b> Modelo de Médias Móveis de ordem <em>q</em> - MA(q) ou ARIMA(0,0,q)</a></li>
<li class="chapter" data-level="5.3.4" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#condições-de-invertibilidade"><i class="fa fa-check"></i><b>5.3.4</b> Condições de invertibilidade</a></li>
<li class="chapter" data-level="5.3.5" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-autorregressivo-de-médias-móveis-de-ordem-p-e-q---armapq-ou-arimap0q"><i class="fa fa-check"></i><b>5.3.5</b> Modelo Autorregressivo de Médias Móveis de ordem <em>p</em> e <em>q</em> - ARMA(p,q) ou ARIMA(p,0,q)</a></li>
<li class="chapter" data-level="5.3.6" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-autorregressivo-integrado-de-médias-móveis-de-ordem-p-d-e-q---arimapdq"><i class="fa fa-check"></i><b>5.3.6</b> Modelo Autorregressivo Integrado de Médias Móveis de ordem <em>p</em>, <em>d</em> e <em>q</em> - ARIMA(p,d,q)</a></li>
<li class="chapter" data-level="5.3.7" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#resumo---modelos-arima-não-sazonais"><i class="fa fa-check"></i><b>5.3.7</b> Resumo - Modelos ARIMA não sazonais</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelos-arima-sazonais-sarima---arimapdqpdq_m"><i class="fa fa-check"></i><b>5.4</b> Modelos ARIMA sazonais (SARIMA) - <span class="math inline">\(ARIMA(p,d,q)(P,D,Q)_m\)</span></a></li>
<li class="chapter" data-level="5.5" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#função-de-autocorrelação-parcial-facp---partial-autocorrelation-function---pacf"><i class="fa fa-check"></i><b>5.5</b> Função de Autocorrelação Parcial (FACP) - (<em>Partial Autocorrelation Function - PACF</em>)</a></li>
<li class="chapter" data-level="5.6" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#processo-de-modelagem"><i class="fa fa-check"></i><b>5.6</b> Processo de Modelagem</a></li>
<li class="chapter" data-level="5.7" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#processo-de-identificação"><i class="fa fa-check"></i><b>5.7</b> Processo de Identificação</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#simulando-os-dados-das-st-com-estruturas-arima"><i class="fa fa-check"></i><b>5.7.1</b> Simulando os dados das ST com estruturas ARIMA</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#métricas-para-avaliar-a-qualidade-do-ajuste"><i class="fa fa-check"></i><b>5.8</b> Métricas para avaliar a qualidade do ajuste</a></li>
<li class="chapter" data-level="5.9" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#análise-de-resíduos"><i class="fa fa-check"></i><b>5.9</b> Análise de Resíduos</a></li>
<li class="chapter" data-level="5.10" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#ajuste-manual-de-modelo-arima"><i class="fa fa-check"></i><b>5.10</b> Ajuste manual de modelo ARIMA</a></li>
<li class="chapter" data-level="5.11" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#ajuste-automático-de-modelos-arima"><i class="fa fa-check"></i><b>5.11</b> Ajuste automático de modelos ARIMA</a></li>
<li class="chapter" data-level="5.12" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelos-de-previsão"><i class="fa fa-check"></i><b>5.12</b> Modelos de Previsão</a></li>
<li class="chapter" data-level="5.13" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#correlação-cruzada-cross-correlation"><i class="fa fa-check"></i><b>5.13</b> Correlação Cruzada (<em>Cross-Correlation</em>)</a></li>
<li class="chapter" data-level="5.14" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#gam-generalized-additive-models"><i class="fa fa-check"></i><b>5.14</b> GAM (Generalized Additive Models)</a>
<ul>
<li class="chapter" data-level="5.14.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#tipos-de-splines"><i class="fa fa-check"></i><b>5.14.1</b> Tipos de splines</a></li>
<li class="chapter" data-level="5.14.2" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#por-que-não-usar"><i class="fa fa-check"></i><b>5.14.2</b> Por que não usar ?</a></li>
<li class="chapter" data-level="5.14.3" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#gam-em-séries-temporais"><i class="fa fa-check"></i><b>5.14.3</b> GAM em Séries Temporais</a></li>
<li class="chapter" data-level="5.14.4" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#exemplo-de-modelo-gam-aplicado-a-st-ldeaths"><i class="fa fa-check"></i><b>5.14.4</b> Exemplo de modelo GAM aplicado a ST ldeaths</a></li>
<li class="chapter" data-level="5.14.5" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#exemplo-gam-casos-de-leptospirose-vs-clima"><i class="fa fa-check"></i><b>5.14.5</b> Exemplo GAM: Casos de Leptospirose <em>vs</em> Clima</a></li>
</ul></li>
<li class="chapter" data-level="5.15" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#exercícios-propostos-3"><i class="fa fa-check"></i><b>5.15</b> Exercícios Propostos</a>
<ul>
<li class="chapter" data-level="5.15.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#exercícios-resolvidos"><i class="fa fa-check"></i><b>5.15.1</b> Exercícios Resolvidos</a></li>
</ul></li>
<li class="chapter" data-level="5.16" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#bibliografia-sugerida-3"><i class="fa fa-check"></i><b>5.16</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html"><i class="fa fa-check"></i><b>6</b> Introdução à Análise Estatística Espacial</a>
<ul>
<li class="chapter" data-level="6.1" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#o-que-é-análise-estatística-espacial"><i class="fa fa-check"></i><b>6.1</b> O que é Análise Estatística Espacial?</a></li>
<li class="chapter" data-level="6.2" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#origem-da-estatística-espacial"><i class="fa fa-check"></i><b>6.2</b> Origem da Estatística Espacial</a></li>
<li class="chapter" data-level="6.3" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#quando-usar-métodos-de-análise-espacial"><i class="fa fa-check"></i><b>6.3</b> Quando usar métodos de análise espacial?</a></li>
<li class="chapter" data-level="6.4" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#dependência-espacial"><i class="fa fa-check"></i><b>6.4</b> Dependência espacial</a></li>
<li class="chapter" data-level="6.5" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#principais-aplicações-em-saúde"><i class="fa fa-check"></i><b>6.5</b> Principais aplicações em Saúde</a></li>
<li class="chapter" data-level="6.6" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#tipologia-dos-dados-espaciais"><i class="fa fa-check"></i><b>6.6</b> Tipologia dos dados espaciais</a></li>
<li class="chapter" data-level="6.7" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#dados-de-processos-pontuais"><i class="fa fa-check"></i><b>6.7</b> Dados de Processos Pontuais</a></li>
<li class="chapter" data-level="6.8" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#geoestatıstica"><i class="fa fa-check"></i><b>6.8</b> Geoestatı́stica</a></li>
<li class="chapter" data-level="6.9" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#dados-de-área"><i class="fa fa-check"></i><b>6.9</b> Dados de Área</a></li>
<li class="chapter" data-level="6.10" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#geoprocessamento"><i class="fa fa-check"></i><b>6.10</b> Geoprocessamento</a></li>
<li class="chapter" data-level="6.11" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#tecnologias-de-geoprocessamento"><i class="fa fa-check"></i><b>6.11</b> Tecnologias de Geoprocessamento</a></li>
<li class="chapter" data-level="6.12" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#sistema-de-informações-geográficas"><i class="fa fa-check"></i><b>6.12</b> Sistema de Informações Geográficas</a>
<ul>
<li class="chapter" data-level="6.12.1" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#qgis"><i class="fa fa-check"></i><b>6.12.1</b> QGIS</a></li>
</ul></li>
<li class="chapter" data-level="6.13" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#análise-espacial-no-r"><i class="fa fa-check"></i><b>6.13</b> Análise Espacial no R</a></li>
<li class="chapter" data-level="6.14" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#alguns-conceitos"><i class="fa fa-check"></i><b>6.14</b> Alguns Conceitos</a>
<ul>
<li class="chapter" data-level="6.14.1" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#autocorrelação-espacial"><i class="fa fa-check"></i><b>6.14.1</b> Autocorrelação espacial</a></li>
<li class="chapter" data-level="6.14.2" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#estacionariedade-1"><i class="fa fa-check"></i><b>6.14.2</b> Estacionariedade</a></li>
<li class="chapter" data-level="6.14.3" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#isotropia"><i class="fa fa-check"></i><b>6.14.3</b> Isotropia</a></li>
</ul></li>
<li class="chapter" data-level="6.15" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#aplicações"><i class="fa fa-check"></i><b>6.15</b> Aplicações</a>
<ul>
<li class="chapter" data-level="6.15.1" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#dengue-em-douradosms"><i class="fa fa-check"></i><b>6.15.1</b> Dengue em Dourados/MS</a></li>
<li class="chapter" data-level="6.15.2" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#vigilância-dos-vetores-da-dengue-usando-modelagem-espaço-temporal-bayesiana"><i class="fa fa-check"></i><b>6.15.2</b> Vigilância dos vetores da Dengue usando modelagem espaço-temporal Bayesiana</a></li>
<li class="chapter" data-level="6.15.3" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#modelo-espaço-temporal-para-a-análise-da-morbimortalidade-por-influenza"><i class="fa fa-check"></i><b>6.15.3</b> Modelo Espaço-Temporal para a Análise da Morbimortalidade por Influenza</a></li>
<li class="chapter" data-level="6.15.4" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#análise-da-temperatura-na-costa-central-da-califórnia"><i class="fa fa-check"></i><b>6.15.4</b> Análise da temperatura na costa central da Califórnia</a></li>
<li class="chapter" data-level="6.15.5" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#a-relação-entre-a-malária-e-a-chuva-no-estado-do-pará-uma-análise-espaço-temporal."><i class="fa fa-check"></i><b>6.15.5</b> A Relação entre a Malária e a Chuva no Estado do Pará: Uma Análise Espaço-Temporal.</a></li>
<li class="chapter" data-level="6.15.6" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#modelagem-espaço-temporal-da-chikungunya-no-município-do-rio-de-janeiro"><i class="fa fa-check"></i><b>6.15.6</b> Modelagem espaço temporal da Chikungunya no município do Rio de Janeiro</a></li>
<li class="chapter" data-level="6.15.7" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#mapas-de-fluxo"><i class="fa fa-check"></i><b>6.15.7</b> Mapas de Fluxo</a></li>
</ul></li>
<li class="chapter" data-level="6.16" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#material-on-line-sobre-estatística-espacial"><i class="fa fa-check"></i><b>6.16</b> Material on line sobre Estatística Espacial</a></li>
<li class="chapter" data-level="6.17" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#onde-encontrar-dados-espaciais"><i class="fa fa-check"></i><b>6.17</b> Onde encontrar dados espaciais ?</a></li>
<li class="chapter" data-level="6.18" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#exemplo-i-malhas-no-r-com-geobr"><i class="fa fa-check"></i><b>6.18</b> Exemplo I: Malhas no R com geobr</a></li>
<li class="chapter" data-level="6.19" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#exemplo-ii-geocodificação"><i class="fa fa-check"></i><b>6.19</b> Exemplo II: Geocodificação</a></li>
<li class="chapter" data-level="6.20" data-path="introdução-à-análise-estatística-espacial.html"><a href="introdução-à-análise-estatística-espacial.html#bibliografia-sugerida-4"><i class="fa fa-check"></i><b>6.20</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html"><i class="fa fa-check"></i><b>7</b> Padrões Pontuais I</a>
<ul>
<li class="chapter" data-level="7.1" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#o-que-são-padrões-pontuais"><i class="fa fa-check"></i><b>7.1</b> O que são Padrões Pontuais?</a></li>
<li class="chapter" data-level="7.2" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#tipos-de-distribuições"><i class="fa fa-check"></i><b>7.2</b> Tipos de Distribuições</a></li>
<li class="chapter" data-level="7.3" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#processos-pontuais"><i class="fa fa-check"></i><b>7.3</b> Processos pontuais</a></li>
<li class="chapter" data-level="7.4" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#completa-aletoriedade-espacial-csr---complete-spatial-randomness"><i class="fa fa-check"></i><b>7.4</b> Completa Aletoriedade Espacial (<em>CSR - complete spatial randomness</em>)</a></li>
<li class="chapter" data-level="7.5" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#estimativa-de-kernel"><i class="fa fa-check"></i><b>7.5</b> Estimativa de Kernel</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#estimativa-de-kernel-com-correção-por-bordas"><i class="fa fa-check"></i><b>7.5.1</b> Estimativa de Kernel com correção por bordas</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#kernel-por-atributo"><i class="fa fa-check"></i><b>7.6</b> Kernel por atributo</a></li>
<li class="chapter" data-level="7.7" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#razão-de-kernel"><i class="fa fa-check"></i><b>7.7</b> Razão de Kernel</a></li>
<li class="chapter" data-level="7.8" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#análise-preliminar-de-um-processo-pontual"><i class="fa fa-check"></i><b>7.8</b> Análise preliminar de um processo pontual</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#função-f-e-g---distância-do-vizinho-mais-próximo"><i class="fa fa-check"></i><b>7.8.1</b> Função F e G - Distância do vizinho mais próximo</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#propriedade-de-segunda-ordem"><i class="fa fa-check"></i><b>7.9</b> Propriedade de segunda ordem</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#função-k-de-ripley-ou-apenas-função-k"><i class="fa fa-check"></i><b>7.9.1</b> Função K de Ripley (ou apenas função K)</a></li>
<li class="chapter" data-level="7.9.2" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#função-l"><i class="fa fa-check"></i><b>7.9.2</b> Função <em>L</em></a></li>
</ul></li>
<li class="chapter" data-level="7.10" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#detecção-de-cluster"><i class="fa fa-check"></i><b>7.10</b> Detecção de cluster</a>
<ul>
<li class="chapter" data-level="7.10.1" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#testes-genéricos-de-cluster"><i class="fa fa-check"></i><b>7.10.1</b> Testes Genéricos de Cluster</a></li>
<li class="chapter" data-level="7.10.2" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#fonte-específica"><i class="fa fa-check"></i><b>7.10.2</b> Fonte Específica</a></li>
</ul></li>
<li class="chapter" data-level="7.11" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#exercícios-propostos-4"><i class="fa fa-check"></i><b>7.11</b> Exercícios Propostos</a>
<ul>
<li class="chapter" data-level="7.11.1" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#exercícios-resolvidos-1"><i class="fa fa-check"></i><b>7.11.1</b> Exercícios Resolvidos</a></li>
</ul></li>
<li class="chapter" data-level="7.12" data-path="padrões-pontuais-i.html"><a href="padrões-pontuais-i.html#bibliografia-sugerida-5"><i class="fa fa-check"></i><b>7.12</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="padrões-pontuais-ii.html"><a href="padrões-pontuais-ii.html"><i class="fa fa-check"></i><b>8</b> Padrões Pontuais II</a>
<ul>
<li class="chapter" data-level="8.1" data-path="padrões-pontuais-ii.html"><a href="padrões-pontuais-ii.html#alguns-usos-em-epidemiologia-espacial"><i class="fa fa-check"></i><b>8.1</b> Alguns usos em Epidemiologia Espacial</a></li>
<li class="chapter" data-level="8.2" data-path="padrões-pontuais-ii.html"><a href="padrões-pontuais-ii.html#exemplo-com-os-dados-de-dengue-em-douradosms"><i class="fa fa-check"></i><b>8.2</b> Exemplo com os dados de dengue em Dourados/MS</a></li>
<li class="chapter" data-level="8.3" data-path="padrões-pontuais-ii.html"><a href="padrões-pontuais-ii.html#modelos-aditivos-generalizados-gam"><i class="fa fa-check"></i><b>8.3</b> Modelos Aditivos Generalizados (GAM)</a></li>
<li class="chapter" data-level="8.4" data-path="padrões-pontuais-ii.html"><a href="padrões-pontuais-ii.html#modelos-espaciais-generalizados-aditivos"><i class="fa fa-check"></i><b>8.4</b> Modelos Espaciais Generalizados Aditivos</a></li>
<li class="chapter" data-level="8.5" data-path="padrões-pontuais-ii.html"><a href="padrões-pontuais-ii.html#bibliografia-sugerida-6"><i class="fa fa-check"></i><b>8.5</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://ogcruz.github.io" target="blank">Página Inicial</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ESTUDOS ECOLÓGICOS 2023</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="padrões-pontuais-i" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number"> 7</span> Padrões Pontuais I<a href="padrões-pontuais-i.html#padrões-pontuais-i" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="o-que-são-padrões-pontuais" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> O que são Padrões Pontuais?<a href="padrões-pontuais-i.html#o-que-são-padrões-pontuais" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A análise de padrão de pontos é o tipo mais simples de análise de dados espaciais. Baseia-se na localização dos eventos em um determinada área de estudo a partir das coordenadas. O objetivo é estudar a disposição espacial dos pontos a partir de suas coordenadas.</p>
<ul>
<li><p>Os processos pontuais são definidos como um conjunto de pontos cuja localização está em <span class="math inline">\(R^2\)</span>, sendo esse processo gerado por um mecanismo estocástico.</p></li>
<li><p>Os pontos são os pares de coordenadas <em>(x, y)</em>, que representam os eventos (observações, indivíduos, lugares ou qualquer outro objeto discreto definido no espaço).</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="center">Evento</th>
<th align="center">Coord X</th>
<th align="center">Coord Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">4,30</td>
<td align="center">2,45</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">5,39</td>
<td align="center">3,35</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">4,10</td>
<td align="center">3,50</td>
</tr>
</tbody>
</table>
<ul>
<li>Em geral o que se deseja é verificar a ocorrência de padrões espaciais nos pontos e se estão aglomerados espacialmente (<em>clusters</em>) ou se estão aleatoriamente distribuídos .</li>
</ul>
<p>No exemplo abaixo temos os pontos dos casos suspeitos em uma investigação de surto de hepatite A no Rio de Janeiro no verão de 2017/2018. As estrelas amarelas mostram locais onde foi encontrado o vírus da hepatite A (HAV) em amostras de água.</p>
<p><img src="figuras/surtoHEPA.png" style="width:100.0%" /></p>
</div>
<div id="tipos-de-distribuições" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Tipos de Distribuições<a href="padrões-pontuais-i.html#tipos-de-distribuições" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p><strong>Aleatória</strong>: qualquer ponto tem a mesma probabilidade de ocorrer em qualquer local e a posição de qualquer ponto não é afetada pela posição de qualquer outro ponto;</p></li>
<li><p><strong>Uniforme</strong>: cada ponto é tão longe de todos os seus vizinhos quanto possível;</p></li>
<li><p><strong>Cluster</strong>: Muitos pontos estão concentrados juntos, e grandes áreas podem conter pouquíssimos pontos, se houver algum.</p></li>
</ul>
<p><img src="figuras/pp0.jpg" style="width:70.0%" /></p>
<p><a href="https://training.fws.gov/courses/references/tutorials/geospatial/CSP7304/">Fonte: Geospatial Training Workshop</a></p>
<p>Lendo os bancos com as localizações dos casos de homicídios, suicídios e acidentes de carro em Porto Alegre/RS.</p>
<p>As principais bibliotecas do <strong>R</strong> que estaremos usando nos exemplos abaixo são:</p>
<ul>
<li><code>sf</code></li>
<li><code>spatstat</code></li>
<li><code>splancs</code></li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="padrões-pontuais-i.html#cb124-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb124-2"><a href="padrões-pontuais-i.html#cb124-2" tabindex="-1"></a><span class="fu">library</span>(spatstat)</span>
<span id="cb124-3"><a href="padrões-pontuais-i.html#cb124-3" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb124-4"><a href="padrões-pontuais-i.html#cb124-4" tabindex="-1"></a><span class="fu">library</span>(splancs)</span>
<span id="cb124-5"><a href="padrões-pontuais-i.html#cb124-5" tabindex="-1"></a></span>
<span id="cb124-6"><a href="padrões-pontuais-i.html#cb124-6" tabindex="-1"></a><span class="co"># lendo os bancos</span></span>
<span id="cb124-7"><a href="padrões-pontuais-i.html#cb124-7" tabindex="-1"></a>local <span class="ot">&lt;-</span> <span class="st">&quot;https://raw.githubusercontent.com/ogcruz/dados_eco_2023/main/dados/&quot;</span></span>
<span id="cb124-8"><a href="padrões-pontuais-i.html#cb124-8" tabindex="-1"></a></span>
<span id="cb124-9"><a href="padrões-pontuais-i.html#cb124-9" tabindex="-1"></a>homic <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(local, <span class="st">&quot;homic.dat&quot;</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb124-10"><a href="padrões-pontuais-i.html#cb124-10" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span>))</span>
<span id="cb124-11"><a href="padrões-pontuais-i.html#cb124-11" tabindex="-1"></a>suic <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(local, <span class="st">&quot;suic.dat&quot;</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb124-12"><a href="padrões-pontuais-i.html#cb124-12" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span>))</span>
<span id="cb124-13"><a href="padrões-pontuais-i.html#cb124-13" tabindex="-1"></a>acid <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(local, <span class="st">&quot;acid.dat&quot;</span>), <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,</span>
<span id="cb124-14"><a href="padrões-pontuais-i.html#cb124-14" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span>))</span>
<span id="cb124-15"><a href="padrões-pontuais-i.html#cb124-15" tabindex="-1"></a></span>
<span id="cb124-16"><a href="padrões-pontuais-i.html#cb124-16" tabindex="-1"></a><span class="co"># Plotando os casos de homicídios em um plano</span></span>
<span id="cb124-17"><a href="padrões-pontuais-i.html#cb124-17" tabindex="-1"></a><span class="co"># cartesiano</span></span>
<span id="cb124-18"><a href="padrões-pontuais-i.html#cb124-18" tabindex="-1"></a></span>
<span id="cb124-19"><a href="padrões-pontuais-i.html#cb124-19" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(homic) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(x, y, <span class="at">color =</span> <span class="st">&quot;Homicídios&quot;</span>),</span>
<span id="cb124-20"><a href="padrões-pontuais-i.html#cb124-20" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb124-21"><a href="padrões-pontuais-i.html#cb124-21" tabindex="-1"></a></span>
<span id="cb124-22"><a href="padrões-pontuais-i.html#cb124-22" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-129-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
<p>Porto Alegre é uma cidade disposta ao longo do eixo norte/sul. O grafico perdeu a estrutura espacial, ajustando para o tamanho e forma da janela. Por isso é necessario informar ao programa que este tipo de objeto é um objeto espacial e tem uma escala, que deve ser preservada. Vamos fazer isso com transformando-o em um objeto espacial do pacote <code>sf</code>.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="padrões-pontuais-i.html#cb125-1" tabindex="-1"></a><span class="co"># Transformando os pontos em geometria espacial</span></span>
<span id="cb125-2"><a href="padrões-pontuais-i.html#cb125-2" tabindex="-1"></a><span class="co"># de pontos</span></span>
<span id="cb125-3"><a href="padrões-pontuais-i.html#cb125-3" tabindex="-1"></a></span>
<span id="cb125-4"><a href="padrões-pontuais-i.html#cb125-4" tabindex="-1"></a>homic_sf <span class="ot">&lt;-</span> homic <span class="sc">%&gt;%</span></span>
<span id="cb125-5"><a href="padrões-pontuais-i.html#cb125-5" tabindex="-1"></a>    <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb125-6"><a href="padrões-pontuais-i.html#cb125-6" tabindex="-1"></a>suic_sf <span class="ot">&lt;-</span> suic <span class="sc">%&gt;%</span></span>
<span id="cb125-7"><a href="padrões-pontuais-i.html#cb125-7" tabindex="-1"></a>    <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb125-8"><a href="padrões-pontuais-i.html#cb125-8" tabindex="-1"></a>acid_sf <span class="ot">&lt;-</span> acid <span class="sc">%&gt;%</span></span>
<span id="cb125-9"><a href="padrões-pontuais-i.html#cb125-9" tabindex="-1"></a>    <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb125-10"><a href="padrões-pontuais-i.html#cb125-10" tabindex="-1"></a></span>
<span id="cb125-11"><a href="padrões-pontuais-i.html#cb125-11" tabindex="-1"></a><span class="co"># Repetindo o mesmo gráfico. Repare que agora</span></span>
<span id="cb125-12"><a href="padrões-pontuais-i.html#cb125-12" tabindex="-1"></a><span class="co"># usamos a função `geom_sf()`:</span></span>
<span id="cb125-13"><a href="padrões-pontuais-i.html#cb125-13" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> homic_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry,</span>
<span id="cb125-14"><a href="padrões-pontuais-i.html#cb125-14" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Homicídios&quot;</span>), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb125-15"><a href="padrões-pontuais-i.html#cb125-15" tabindex="-1"></a></span>
<span id="cb125-16"><a href="padrões-pontuais-i.html#cb125-16" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-130-1.png" width="672" /></p>
<p>Agora vamos adicionar os pontos referentes a suicídios e acidentes:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="padrões-pontuais-i.html#cb126-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> g <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> suic_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry,</span>
<span id="cb126-2"><a href="padrões-pontuais-i.html#cb126-2" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Suícidios&quot;</span>), <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> acid_sf,</span>
<span id="cb126-3"><a href="padrões-pontuais-i.html#cb126-3" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry, <span class="at">color =</span> <span class="st">&quot;Acidentes&quot;</span>),</span>
<span id="cb126-4"><a href="padrões-pontuais-i.html#cb126-4" tabindex="-1"></a>    <span class="at">shape =</span> <span class="dv">1</span>)</span>
<span id="cb126-5"><a href="padrões-pontuais-i.html#cb126-5" tabindex="-1"></a>g</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-131-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Importando o polígono do contorno de Porto Alegre:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="padrões-pontuais-i.html#cb127-1" tabindex="-1"></a><span class="co"># contorno de porto alegre</span></span>
<span id="cb127-2"><a href="padrões-pontuais-i.html#cb127-2" tabindex="-1"></a>contorno.poa <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(local, <span class="st">&quot;/contpoa.dat&quot;</span>),</span>
<span id="cb127-3"><a href="padrões-pontuais-i.html#cb127-3" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>))</span>
<span id="cb127-4"><a href="padrões-pontuais-i.html#cb127-4" tabindex="-1"></a></span>
<span id="cb127-5"><a href="padrões-pontuais-i.html#cb127-5" tabindex="-1"></a><span class="co"># plotando com a função `geom_polygon`:</span></span>
<span id="cb127-6"><a href="padrões-pontuais-i.html#cb127-6" tabindex="-1"></a>g <span class="sc">+</span> <span class="fu">geom_polygon</span>(<span class="at">data =</span> contorno.poa, <span class="fu">aes</span>(x, y), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb127-7"><a href="padrões-pontuais-i.html#cb127-7" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-132-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Os pontos fora do contorno sao das ilhas, não devem ser incorporados a análise. Vamos transformar o contorno também em um objeto espacial (<code>st_polygon</code>) para identificar os pontos fora do contorno:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="padrões-pontuais-i.html#cb128-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb128-2"><a href="padrões-pontuais-i.html#cb128-2" tabindex="-1"></a></span>
<span id="cb128-3"><a href="padrões-pontuais-i.html#cb128-3" tabindex="-1"></a><span class="co"># Para transformar em polígono espacial,</span></span>
<span id="cb128-4"><a href="padrões-pontuais-i.html#cb128-4" tabindex="-1"></a><span class="co"># transformamos primeiro em matriz e em seguida</span></span>
<span id="cb128-5"><a href="padrões-pontuais-i.html#cb128-5" tabindex="-1"></a><span class="co"># em uma lista:</span></span>
<span id="cb128-6"><a href="padrões-pontuais-i.html#cb128-6" tabindex="-1"></a></span>
<span id="cb128-7"><a href="padrões-pontuais-i.html#cb128-7" tabindex="-1"></a>poa_sf <span class="ot">&lt;-</span> contorno.poa <span class="sc">%&gt;%</span></span>
<span id="cb128-8"><a href="padrões-pontuais-i.html#cb128-8" tabindex="-1"></a>    <span class="fu">as.matrix</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-9"><a href="padrões-pontuais-i.html#cb128-9" tabindex="-1"></a>    <span class="fu">list</span>() <span class="sc">%&gt;%</span></span>
<span id="cb128-10"><a href="padrões-pontuais-i.html#cb128-10" tabindex="-1"></a>    <span class="fu">st_polygon</span>()</span></code></pre></div>
<p>Agora sim, podemos utilizar a função <code>st_within()</code> para identificar os pontos fora do contorno:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="padrões-pontuais-i.html#cb129-1" tabindex="-1"></a><span class="co"># A função st_within() tem essa funcionalidade</span></span>
<span id="cb129-2"><a href="padrões-pontuais-i.html#cb129-2" tabindex="-1"></a>homic_sf <span class="ot">&lt;-</span> homic_sf <span class="sc">%&gt;%</span></span>
<span id="cb129-3"><a href="padrões-pontuais-i.html#cb129-3" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dentro =</span> <span class="fu">lengths</span>(<span class="fu">st_within</span>(homic_sf, poa_sf)))</span>
<span id="cb129-4"><a href="padrões-pontuais-i.html#cb129-4" tabindex="-1"></a></span>
<span id="cb129-5"><a href="padrões-pontuais-i.html#cb129-5" tabindex="-1"></a><span class="fu">ggplot</span>(homic_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry)) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">as.factor</span>(dentro))) <span class="sc">+</span></span>
<span id="cb129-6"><a href="padrões-pontuais-i.html#cb129-6" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="sc">+</span></span>
<span id="cb129-7"><a href="padrões-pontuais-i.html#cb129-7" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">&quot;Dentro do polĩgono&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-134-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="padrões-pontuais-i.html#cb130-1" tabindex="-1"></a><span class="co"># Filtra somente as observações dentro do</span></span>
<span id="cb130-2"><a href="padrões-pontuais-i.html#cb130-2" tabindex="-1"></a><span class="co"># polígono</span></span>
<span id="cb130-3"><a href="padrões-pontuais-i.html#cb130-3" tabindex="-1"></a>homic_sf2 <span class="ot">&lt;-</span> homic_sf <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="padrões-pontuais-i.html#cb130-4" tabindex="-1"></a>    <span class="fu">filter</span>(dentro <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<p><br />
</p>
</div>
<div id="processos-pontuais" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Processos pontuais<a href="padrões-pontuais-i.html#processos-pontuais" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Os processos pontuais podem ser descritos como:</p>
<ol style="list-style-type: lower-roman">
<li><strong>Processo de primeira ordem</strong>, considerados globais ou de larga escala, que correspondem a variações no valor médio do processo no espaço.</li>
</ol>
<ul>
<li>Tal processo pode ser representado por mensurações da intensidade baseado na densidade dos pontos (média dos eventos) na área de estudo (ex: Estimativa de Kernel).</li>
</ul>
<ol start="2" style="list-style-type: lower-roman">
<li><strong>Processo de segunda ordem</strong>, denominados locais ou de pequena escala, é o processo representado pela interação entre dois pontos arbitrários.</li>
</ol>
<ul>
<li>O objetivo desse processo é a mensuração da dependência espacial baseado na distância entre os pontos (ex: Vizinhos mais próximos, Função K).</li>
</ul>
</div>
<div id="completa-aletoriedade-espacial-csr---complete-spatial-randomness" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Completa Aletoriedade Espacial (<em>CSR - complete spatial randomness</em>)<a href="padrões-pontuais-i.html#completa-aletoriedade-espacial-csr---complete-spatial-randomness" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="math inline">\(H_0\)</span>: Os pontos estão distribuidos aleatoriamente no espaço</p>
<p><span class="math inline">\(H_1\)</span>: Os pontos podem formar clusters ou estão dispersos no espaço</p>
<ul>
<li><p><em>CSR</em> assume que os pontos seguem um processo homogêneo de Poisson na área de estudo.</p>
<!-- - A densidade dos pontos é constante homogênea ao longo da área de estudo; -->
<!-- - Para uma amostra aleatória de subregiões, a distribuição da frequência do número de pontos em cada região segue uma distribuição de poisson; --></li>
</ul>
<!--     - O número de pontos em uma dada subregião e o mesmo para todas as subregiões na área de estudo; -->
<p><!-- - O número de pontos na subregião, independe do número de pontos em qualquer outra subregião. --></p>
<p>Simulando alguns padrões dos dados de ponto, temos o seguinte:</p>
<ul>
<li>Simulando os processo espaciais:</li>
</ul>
<p>O pacote sf possui a função <code>st_sample()</code> que permite a geração de <span class="math inline">\(n\)</span> pontos dentro de uma janela:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="padrões-pontuais-i.html#cb131-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9999</span>)</span>
<span id="cb131-2"><a href="padrões-pontuais-i.html#cb131-2" tabindex="-1"></a></span>
<span id="cb131-3"><a href="padrões-pontuais-i.html#cb131-3" tabindex="-1"></a><span class="co"># padrão aleatório</span></span>
<span id="cb131-4"><a href="padrões-pontuais-i.html#cb131-4" tabindex="-1"></a>alea_sf <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(poa_sf, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>)</span>
<span id="cb131-5"><a href="padrões-pontuais-i.html#cb131-5" tabindex="-1"></a></span>
<span id="cb131-6"><a href="padrões-pontuais-i.html#cb131-6" tabindex="-1"></a>g_alea <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(alea_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry)) <span class="sc">+</span></span>
<span id="cb131-7"><a href="padrões-pontuais-i.html#cb131-7" tabindex="-1"></a>    <span class="fu">geom_sf</span>() <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf, <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="sc">+</span></span>
<span id="cb131-8"><a href="padrões-pontuais-i.html#cb131-8" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">&quot;Distribuição aleatória&quot;</span>)</span>
<span id="cb131-9"><a href="padrões-pontuais-i.html#cb131-9" tabindex="-1"></a></span>
<span id="cb131-10"><a href="padrões-pontuais-i.html#cb131-10" tabindex="-1"></a>g_alea</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-137-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="padrões-pontuais-i.html#cb132-1" tabindex="-1"></a><span class="co"># padrão regular</span></span>
<span id="cb132-2"><a href="padrões-pontuais-i.html#cb132-2" tabindex="-1"></a></span>
<span id="cb132-3"><a href="padrões-pontuais-i.html#cb132-3" tabindex="-1"></a>uni_sf <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(poa_sf, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">type =</span> <span class="st">&quot;regular&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-4"><a href="padrões-pontuais-i.html#cb132-4" tabindex="-1"></a>    <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb132-5"><a href="padrões-pontuais-i.html#cb132-5" tabindex="-1"></a>    <span class="co"># a função jitter é bastante utilizada e</span></span>
<span id="cb132-6"><a href="padrões-pontuais-i.html#cb132-6" tabindex="-1"></a>    <span class="co"># serve para adicionar uma flutuação (desvio)</span></span>
<span id="cb132-7"><a href="padrões-pontuais-i.html#cb132-7" tabindex="-1"></a>    <span class="co"># aleatória aos pontos</span></span>
<span id="cb132-8"><a href="padrões-pontuais-i.html#cb132-8" tabindex="-1"></a><span class="fu">st_jitter</span>(<span class="at">amount =</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb132-9"><a href="padrões-pontuais-i.html#cb132-9" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">lengths</span>(<span class="fu">st_within</span>(., poa_sf)) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb132-10"><a href="padrões-pontuais-i.html#cb132-10" tabindex="-1"></a></span>
<span id="cb132-11"><a href="padrões-pontuais-i.html#cb132-11" tabindex="-1"></a>g_uni <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(uni_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> x)) <span class="sc">+</span> <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb132-12"><a href="padrões-pontuais-i.html#cb132-12" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry),</span>
<span id="cb132-13"><a href="padrões-pontuais-i.html#cb132-13" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Distribuição regular&quot;</span>)</span>
<span id="cb132-14"><a href="padrões-pontuais-i.html#cb132-14" tabindex="-1"></a></span>
<span id="cb132-15"><a href="padrões-pontuais-i.html#cb132-15" tabindex="-1"></a>g_uni</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-139-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="padrões-pontuais-i.html#cb133-1" tabindex="-1"></a><span class="co"># padrão clusterizado</span></span></code></pre></div>
<p>A função <code>st_sample()</code> permite a geração de pontos clusterizados a partir de um processo determinado, como um processo de cluster de Poisson, ou processo Thomas (para mais informações, ver <code>??spatsat.random</code>). Essas funções levam um tempo para gerar as amostras, por isso iremos implementar uma função mais simples:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="padrões-pontuais-i.html#cb134-1" tabindex="-1"></a><span class="co"># Função para gerar uma distribuição</span></span>
<span id="cb134-2"><a href="padrões-pontuais-i.html#cb134-2" tabindex="-1"></a><span class="co"># clusterizada: Recebe um conjunto de centroides</span></span>
<span id="cb134-3"><a href="padrões-pontuais-i.html#cb134-3" tabindex="-1"></a><span class="co"># dos clusters e gera pontos ao redor deles</span></span>
<span id="cb134-4"><a href="padrões-pontuais-i.html#cb134-4" tabindex="-1"></a>st_make_clusters <span class="ot">&lt;-</span> <span class="cf">function</span>(centroids, n, amount,</span>
<span id="cb134-5"><a href="padrões-pontuais-i.html#cb134-5" tabindex="-1"></a>    <span class="at">factor =</span> <span class="fl">0.002</span>) {</span>
<span id="cb134-6"><a href="padrões-pontuais-i.html#cb134-6" tabindex="-1"></a>    clustered <span class="ot">&lt;-</span> centroids  <span class="co"># começa com centroides dos clusters e adiciona pontos em volta</span></span>
<span id="cb134-7"><a href="padrões-pontuais-i.html#cb134-7" tabindex="-1"></a></span>
<span id="cb134-8"><a href="padrões-pontuais-i.html#cb134-8" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(n)) {</span>
<span id="cb134-9"><a href="padrões-pontuais-i.html#cb134-9" tabindex="-1"></a>        clustered <span class="ot">&lt;-</span> clustered <span class="sc">%&gt;%</span></span>
<span id="cb134-10"><a href="padrões-pontuais-i.html#cb134-10" tabindex="-1"></a>            <span class="fu">rbind</span>(centroids <span class="sc">%&gt;%</span></span>
<span id="cb134-11"><a href="padrões-pontuais-i.html#cb134-11" tabindex="-1"></a>                <span class="fu">st_jitter</span>(<span class="at">amount =</span> amount, <span class="at">factor =</span> factor))</span>
<span id="cb134-12"><a href="padrões-pontuais-i.html#cb134-12" tabindex="-1"></a>    }</span>
<span id="cb134-13"><a href="padrões-pontuais-i.html#cb134-13" tabindex="-1"></a></span>
<span id="cb134-14"><a href="padrões-pontuais-i.html#cb134-14" tabindex="-1"></a>    clustered</span>
<span id="cb134-15"><a href="padrões-pontuais-i.html#cb134-15" tabindex="-1"></a>}</span>
<span id="cb134-16"><a href="padrões-pontuais-i.html#cb134-16" tabindex="-1"></a></span>
<span id="cb134-17"><a href="padrões-pontuais-i.html#cb134-17" tabindex="-1"></a><span class="co"># agora sim, gerando um padrão clusterizado</span></span>
<span id="cb134-18"><a href="padrões-pontuais-i.html#cb134-18" tabindex="-1"></a>clu_sf <span class="ot">&lt;-</span> <span class="fu">st_sample</span>(poa_sf, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">type =</span> <span class="st">&quot;random&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-19"><a href="padrões-pontuais-i.html#cb134-19" tabindex="-1"></a>    <span class="fu">st_as_sf</span>() <span class="sc">%&gt;%</span></span>
<span id="cb134-20"><a href="padrões-pontuais-i.html#cb134-20" tabindex="-1"></a>    <span class="fu">st_make_clusters</span>(<span class="dv">10</span>, <span class="at">amount =</span> <span class="dv">200</span>, <span class="at">factor =</span> <span class="fl">0.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb134-21"><a href="padrões-pontuais-i.html#cb134-21" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">lengths</span>(<span class="fu">st_within</span>(., poa_sf)) <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb134-22"><a href="padrões-pontuais-i.html#cb134-22" tabindex="-1"></a></span>
<span id="cb134-23"><a href="padrões-pontuais-i.html#cb134-23" tabindex="-1"></a>g_clu <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(clu_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> x)) <span class="sc">+</span> <span class="fu">geom_sf</span>() <span class="sc">+</span></span>
<span id="cb134-24"><a href="padrões-pontuais-i.html#cb134-24" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf, <span class="fu">aes</span>(<span class="at">geometry =</span> geometry),</span>
<span id="cb134-25"><a href="padrões-pontuais-i.html#cb134-25" tabindex="-1"></a>        <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Distribuição aglomerada&quot;</span>)</span>
<span id="cb134-26"><a href="padrões-pontuais-i.html#cb134-26" tabindex="-1"></a></span>
<span id="cb134-27"><a href="padrões-pontuais-i.html#cb134-27" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_alea, g_clu, g_uni, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-140-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
<p>Através da função <code>quadratcount()</code> do pacote <code>spatstat</code>, podemos analisar a contagem de observações por quadrantes, que nos auxilia na análise da distribuição dos pontos. Para isso, precisamos converter nossos objetos para o formato específico <code>ppp</code> (<em>spatial point pattern</em>):</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="padrões-pontuais-i.html#cb135-1" tabindex="-1"></a><span class="co"># Convertendo para a class ppp</span></span>
<span id="cb135-2"><a href="padrões-pontuais-i.html#cb135-2" tabindex="-1"></a></span>
<span id="cb135-3"><a href="padrões-pontuais-i.html#cb135-3" tabindex="-1"></a>alea_ppp <span class="ot">&lt;-</span> alea_sf2 <span class="sc">%&gt;%</span></span>
<span id="cb135-4"><a href="padrões-pontuais-i.html#cb135-4" tabindex="-1"></a>    <span class="fu">as.ppp</span>()</span>
<span id="cb135-5"><a href="padrões-pontuais-i.html#cb135-5" tabindex="-1"></a>uni_ppp <span class="ot">&lt;-</span> uni_sf2 <span class="sc">%&gt;%</span></span>
<span id="cb135-6"><a href="padrões-pontuais-i.html#cb135-6" tabindex="-1"></a>    <span class="fu">as.ppp</span>()</span>
<span id="cb135-7"><a href="padrões-pontuais-i.html#cb135-7" tabindex="-1"></a>clu_ppp <span class="ot">&lt;-</span> clu_sf2 <span class="sc">%&gt;%</span></span>
<span id="cb135-8"><a href="padrões-pontuais-i.html#cb135-8" tabindex="-1"></a>    <span class="fu">as.ppp</span>()</span>
<span id="cb135-9"><a href="padrões-pontuais-i.html#cb135-9" tabindex="-1"></a></span>
<span id="cb135-10"><a href="padrões-pontuais-i.html#cb135-10" tabindex="-1"></a><span class="co"># Construindo os quadrantes com as respectivas</span></span>
<span id="cb135-11"><a href="padrões-pontuais-i.html#cb135-11" tabindex="-1"></a><span class="co"># contagens</span></span>
<span id="cb135-12"><a href="padrões-pontuais-i.html#cb135-12" tabindex="-1"></a>alea_qc <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(alea_ppp, <span class="at">nx =</span> <span class="dv">5</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span>
<span id="cb135-13"><a href="padrões-pontuais-i.html#cb135-13" tabindex="-1"></a>uni_qc <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(uni_ppp, <span class="at">nx =</span> <span class="dv">5</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span>
<span id="cb135-14"><a href="padrões-pontuais-i.html#cb135-14" tabindex="-1"></a>clu_qc <span class="ot">&lt;-</span> <span class="fu">quadratcount</span>(clu_ppp, <span class="at">nx =</span> <span class="dv">5</span>, <span class="at">ny =</span> <span class="dv">6</span>)</span>
<span id="cb135-15"><a href="padrões-pontuais-i.html#cb135-15" tabindex="-1"></a></span>
<span id="cb135-16"><a href="padrões-pontuais-i.html#cb135-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb135-17"><a href="padrões-pontuais-i.html#cb135-17" tabindex="-1"></a><span class="fu">plot</span>(alea_qc, <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb135-18"><a href="padrões-pontuais-i.html#cb135-18" tabindex="-1"></a><span class="fu">plot</span>(alea_ppp, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb135-19"><a href="padrões-pontuais-i.html#cb135-19" tabindex="-1"></a></span>
<span id="cb135-20"><a href="padrões-pontuais-i.html#cb135-20" tabindex="-1"></a><span class="fu">plot</span>(uni_qc, <span class="at">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb135-21"><a href="padrões-pontuais-i.html#cb135-21" tabindex="-1"></a><span class="fu">plot</span>(uni_ppp, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb135-22"><a href="padrões-pontuais-i.html#cb135-22" tabindex="-1"></a></span>
<span id="cb135-23"><a href="padrões-pontuais-i.html#cb135-23" tabindex="-1"></a><span class="fu">plot</span>(clu_qc, <span class="at">main =</span> <span class="st">&quot;Agregado&quot;</span>)</span>
<span id="cb135-24"><a href="padrões-pontuais-i.html#cb135-24" tabindex="-1"></a><span class="fu">plot</span>(clu_ppp, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;gray&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-143-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
<p>Testando a Completa Aletoriedade Espacial (<em>CSR - complete spatial randomness</em>):</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="padrões-pontuais-i.html#cb136-1" tabindex="-1"></a><span class="fu">quadrat.test</span>(alea_qc)</span></code></pre></div>
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 27, df = 29, p-value = 0.9
alternative hypothesis: two.sided

Quadrats: 5 by 6 grid of tiles</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="padrões-pontuais-i.html#cb138-1" tabindex="-1"></a><span class="fu">quadrat.test</span>(clu_qc)</span></code></pre></div>
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 170, df = 29, p-value &lt;2e-16
alternative hypothesis: two.sided

Quadrats: 5 by 6 grid of tiles</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="padrões-pontuais-i.html#cb140-1" tabindex="-1"></a><span class="fu">quadrat.test</span>(uni_qc)</span></code></pre></div>
<pre><code>
    Chi-squared test of CSR using quadrat counts

data:  
X2 = 7.1, df = 29, p-value = 2e-05
alternative hypothesis: two.sided

Quadrats: 5 by 6 grid of tiles</code></pre>
<hr />
</div>
<div id="estimativa-de-kernel" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Estimativa de Kernel<a href="padrões-pontuais-i.html#estimativa-de-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Uma análise exploratória de um processo pontual geralmente é iniciada pela estimação da intensidade de ocorrências do processo em toda a região em estudo. Com isso, gera-se uma superfície cujo valor é proporcional à intensidade de eventos por unidade de área.</p>
<p>O estimador Kernel é um interpolador, que possibilita a estimação da intensidade do evento em toda a área, mesmo nas regiões onde o processo não tenha gerado nenhuma ocorrência real.</p>
<p>Essa técnica de alisamento, utiliza janela móvel que, para cada área, estima um peso variável conforme a distância.</p>
<p>O objetivo é de estimar a intensidade do processo pontual <span class="math inline">\(=\)</span> número de eventos por unidade de área.</p>
<p><img src="figuras/pp3.jpg" style="width:100.0%" /></p>
<p><span class="math display">\[\hat{\lambda}(s) = \sum\limits_{i=1}^{n} \dfrac{1}{\tau^2} K \left( \frac{(s - s_i)}{\tau} \right) \nonumber\]</span></p>
<p>Sendo:</p>
<ul>
<li><p><span class="math inline">\(\hat{\lambda}(s)\)</span> o valor estimado por área;</p></li>
<li><p>A função <span class="math inline">\(K(\bullet)\)</span> uma FDP, escolhida de forma adequada para construir uma superfície contínua sobre os dados;</p></li>
<li><p>O parâmetro <span class="math inline">\(\tau\)</span> denominado “largura de banda ou faixa” (<em>bandwidth</em>), controla a suavização da superfície gerada;</p></li>
<li><p><span class="math inline">\(s\)</span> o centro da área, representado por uma localização qualquer na área de estudo;</p></li>
<li><p><span class="math inline">\(s_i\)</span> as localizações dos eventos observados;</p></li>
<li><p><span class="math inline">\(n\)</span> o número de pontos (eventos).</p></li>
</ul>
<p><img src="figuras/pp5.jpg" style="width:100.0%" /></p>
<!-- - Foi desenvolvida originalmente para obter uma estimação alisada -->
<!-- da densidade de probabilidade uni ou multivariada, ou um -->
<!-- histograma alisado. -->
<!-- - Estimar a intensidade de pontos dispostos no espaço é semelhante a estimar uma densidade de probabilidade bivariada. -->
<div id="estimativa-de-kernel-com-correção-por-bordas" class="section level3 hasAnchor" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Estimativa de Kernel com correção por bordas<a href="padrões-pontuais-i.html#estimativa-de-kernel-com-correção-por-bordas" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Primeiramente calcula-se o volume sob o Kernel que está de fato dentro da região de estudo.</p>
<p><span class="math display">\[\delta_{\tau}(s) = \int_{R}\dfrac{1}{\tau^2}k \left( \dfrac{(s-u)}{\tau}\right) du\]</span></p>
<p>Aplicando a correção das bordas, obtém-se um estimador corrigido:</p>
<p><span class="math display">\[\hat{\lambda}(s) = \dfrac{1}{\delta_{\tau}(s)} \sum\limits_{i=1}^{n} \dfrac{1}{\tau^2} K \left( \frac{(s - s_i)}{\tau} \right) \nonumber\]</span></p>
<p><strong>Exemplo:</strong></p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="padrões-pontuais-i.html#cb142-1" tabindex="-1"></a>alea_den <span class="ot">&lt;-</span> <span class="fu">density</span>(alea_ppp, <span class="at">sigma =</span> <span class="dv">100</span>)</span>
<span id="cb142-2"><a href="padrões-pontuais-i.html#cb142-2" tabindex="-1"></a>clu_den <span class="ot">&lt;-</span> <span class="fu">density</span>(clu_ppp, <span class="at">sigma =</span> <span class="dv">100</span>)</span>
<span id="cb142-3"><a href="padrões-pontuais-i.html#cb142-3" tabindex="-1"></a>uni_den <span class="ot">&lt;-</span> <span class="fu">density</span>(uni_ppp, <span class="at">sigma =</span> <span class="dv">100</span>)</span>
<span id="cb142-4"><a href="padrões-pontuais-i.html#cb142-4" tabindex="-1"></a></span>
<span id="cb142-5"><a href="padrões-pontuais-i.html#cb142-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb142-6"><a href="padrões-pontuais-i.html#cb142-6" tabindex="-1"></a><span class="fu">plot</span>(alea_den, <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb142-7"><a href="padrões-pontuais-i.html#cb142-7" tabindex="-1"></a><span class="fu">plot</span>(alea_ppp, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb142-8"><a href="padrões-pontuais-i.html#cb142-8" tabindex="-1"></a></span>
<span id="cb142-9"><a href="padrões-pontuais-i.html#cb142-9" tabindex="-1"></a><span class="fu">plot</span>(clu_den, <span class="at">main =</span> <span class="st">&quot;Aglomerado&quot;</span>)</span>
<span id="cb142-10"><a href="padrões-pontuais-i.html#cb142-10" tabindex="-1"></a><span class="fu">plot</span>(clu_ppp, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb142-11"><a href="padrões-pontuais-i.html#cb142-11" tabindex="-1"></a></span>
<span id="cb142-12"><a href="padrões-pontuais-i.html#cb142-12" tabindex="-1"></a><span class="fu">plot</span>(uni_den, <span class="at">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb142-13"><a href="padrões-pontuais-i.html#cb142-13" tabindex="-1"></a><span class="fu">plot</span>(uni_ppp, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-147-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><br />
</p>
<p>Na própria função <code>density()</code> (veja: <code>?density.ppp</code>) podemos alterar alguns parâmetros para o kernel, como sua largura de banda (<code>sigma</code>), tipo de Kernel (<code>kernel</code>), correção de bordas (<code>diggle</code>), vetor de pesos (<code>weights</code>), etc.</p>
<p>Alterando a largura de banda de forma exploratória para os dados clusterizados:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="padrões-pontuais-i.html#cb143-1" tabindex="-1"></a>clu_den1 <span class="ot">&lt;-</span> <span class="fu">density</span>(clu_ppp, <span class="at">sigma =</span> <span class="dv">200</span>)</span>
<span id="cb143-2"><a href="padrões-pontuais-i.html#cb143-2" tabindex="-1"></a>clu_den2 <span class="ot">&lt;-</span> <span class="fu">density</span>(clu_ppp, <span class="at">sigma =</span> <span class="dv">500</span>)</span>
<span id="cb143-3"><a href="padrões-pontuais-i.html#cb143-3" tabindex="-1"></a>clu_den3 <span class="ot">&lt;-</span> <span class="fu">density</span>(clu_ppp, <span class="at">sigma =</span> <span class="dv">1000</span>)</span>
<span id="cb143-4"><a href="padrões-pontuais-i.html#cb143-4" tabindex="-1"></a></span>
<span id="cb143-5"><a href="padrões-pontuais-i.html#cb143-5" tabindex="-1"></a><span class="co"># vamos apresentar agora os gráficos em ggplot</span></span>
<span id="cb143-6"><a href="padrões-pontuais-i.html#cb143-6" tabindex="-1"></a></span>
<span id="cb143-7"><a href="padrões-pontuais-i.html#cb143-7" tabindex="-1"></a>g_den1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(clu_den1), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb143-8"><a href="padrões-pontuais-i.html#cb143-8" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(clu_ppp),</span>
<span id="cb143-9"><a href="padrões-pontuais-i.html#cb143-9" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-10"><a href="padrões-pontuais-i.html#cb143-10" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cluster&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;Sigma = 200&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-11"><a href="padrões-pontuais-i.html#cb143-11" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb143-12"><a href="padrões-pontuais-i.html#cb143-12" tabindex="-1"></a></span>
<span id="cb143-13"><a href="padrões-pontuais-i.html#cb143-13" tabindex="-1"></a>g_den2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(clu_den2), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb143-14"><a href="padrões-pontuais-i.html#cb143-14" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(clu_ppp),</span>
<span id="cb143-15"><a href="padrões-pontuais-i.html#cb143-15" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-16"><a href="padrões-pontuais-i.html#cb143-16" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cluster&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;Sigma = 500&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-17"><a href="padrões-pontuais-i.html#cb143-17" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb143-18"><a href="padrões-pontuais-i.html#cb143-18" tabindex="-1"></a></span>
<span id="cb143-19"><a href="padrões-pontuais-i.html#cb143-19" tabindex="-1"></a>g_den3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(clu_den3), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb143-20"><a href="padrões-pontuais-i.html#cb143-20" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(clu_ppp),</span>
<span id="cb143-21"><a href="padrões-pontuais-i.html#cb143-21" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-22"><a href="padrões-pontuais-i.html#cb143-22" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cluster&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;Sigma = 1000&quot;</span>) <span class="sc">+</span></span>
<span id="cb143-23"><a href="padrões-pontuais-i.html#cb143-23" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb143-24"><a href="padrões-pontuais-i.html#cb143-24" tabindex="-1"></a></span>
<span id="cb143-25"><a href="padrões-pontuais-i.html#cb143-25" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_den1, g_den2, g_den3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-148-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Alterando o tipo de kernel (padrão: <code>"gaussian"</code>):</p>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-149-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Com correção de bordas:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="padrões-pontuais-i.html#cb144-1" tabindex="-1"></a>clu_den1_dig <span class="ot">&lt;-</span> <span class="fu">density</span>(clu_ppp, <span class="at">sigma =</span> <span class="dv">200</span>, <span class="at">diggle =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-151-1.png" width="100%" /></p>
<p>O <code>ggplot</code> possui funções próprias que permitem a visualizar de estimativas de densidade, entre elas o kernel espacial. Nesses casos, o kernel é ajustado na própria função de visualização (<code>stat_density2d</code>).</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="padrões-pontuais-i.html#cb145-1" tabindex="-1"></a><span class="co"># vamos inserir linhas de contorno também</span></span>
<span id="cb145-2"><a href="padrões-pontuais-i.html#cb145-2" tabindex="-1"></a></span>
<span id="cb145-3"><a href="padrões-pontuais-i.html#cb145-3" tabindex="-1"></a>g_contour1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(alea_ppp), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb145-4"><a href="padrões-pontuais-i.html#cb145-4" tabindex="-1"></a>    <span class="fu">stat_density2d_filled</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)) <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">500</span>,</span>
<span id="cb145-5"><a href="padrões-pontuais-i.html#cb145-5" tabindex="-1"></a>    <span class="dv">500</span>), <span class="at">n =</span> <span class="dv">200</span>, <span class="at">contour_var =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-6"><a href="padrões-pontuais-i.html#cb145-6" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Aleatório&quot;</span>) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-7"><a href="padrões-pontuais-i.html#cb145-7" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb145-8"><a href="padrões-pontuais-i.html#cb145-8" tabindex="-1"></a></span>
<span id="cb145-9"><a href="padrões-pontuais-i.html#cb145-9" tabindex="-1"></a>g_contour2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(clu_ppp), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb145-10"><a href="padrões-pontuais-i.html#cb145-10" tabindex="-1"></a>    <span class="fu">stat_density2d_filled</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)) <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">500</span>,</span>
<span id="cb145-11"><a href="padrões-pontuais-i.html#cb145-11" tabindex="-1"></a>    <span class="dv">500</span>), <span class="at">n =</span> <span class="dv">200</span>, <span class="at">contour_var =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-12"><a href="padrões-pontuais-i.html#cb145-12" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cluster&quot;</span>) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-13"><a href="padrões-pontuais-i.html#cb145-13" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb145-14"><a href="padrões-pontuais-i.html#cb145-14" tabindex="-1"></a></span>
<span id="cb145-15"><a href="padrões-pontuais-i.html#cb145-15" tabindex="-1"></a>g_contour3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(uni_ppp), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb145-16"><a href="padrões-pontuais-i.html#cb145-16" tabindex="-1"></a>    <span class="fu">stat_density2d_filled</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">500</span>)) <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">h =</span> <span class="fu">c</span>(<span class="dv">500</span>,</span>
<span id="cb145-17"><a href="padrões-pontuais-i.html#cb145-17" tabindex="-1"></a>    <span class="dv">500</span>), <span class="at">n =</span> <span class="dv">200</span>, <span class="at">contour_var =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-18"><a href="padrões-pontuais-i.html#cb145-18" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Regular&quot;</span>) <span class="sc">+</span> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb145-19"><a href="padrões-pontuais-i.html#cb145-19" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb145-20"><a href="padrões-pontuais-i.html#cb145-20" tabindex="-1"></a></span>
<span id="cb145-21"><a href="padrões-pontuais-i.html#cb145-21" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_contour1, g_contour2, g_contour3,</span>
<span id="cb145-22"><a href="padrões-pontuais-i.html#cb145-22" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-152-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>As linhas de contorno também podem ser visualizadas com a função <code>contour()</code> do R base:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="padrões-pontuais-i.html#cb146-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb146-2"><a href="padrões-pontuais-i.html#cb146-2" tabindex="-1"></a><span class="fu">plot</span>(alea_den, <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb146-3"><a href="padrões-pontuais-i.html#cb146-3" tabindex="-1"></a><span class="fu">contour</span>(alea_den, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb146-4"><a href="padrões-pontuais-i.html#cb146-4" tabindex="-1"></a></span>
<span id="cb146-5"><a href="padrões-pontuais-i.html#cb146-5" tabindex="-1"></a><span class="fu">plot</span>(clu_den, <span class="at">main =</span> <span class="st">&quot;Aglomerado&quot;</span>)</span>
<span id="cb146-6"><a href="padrões-pontuais-i.html#cb146-6" tabindex="-1"></a><span class="fu">contour</span>(clu_den, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span>
<span id="cb146-7"><a href="padrões-pontuais-i.html#cb146-7" tabindex="-1"></a></span>
<span id="cb146-8"><a href="padrões-pontuais-i.html#cb146-8" tabindex="-1"></a><span class="fu">plot</span>(uni_den, <span class="at">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb146-9"><a href="padrões-pontuais-i.html#cb146-9" tabindex="-1"></a><span class="fu">contour</span>(uni_den, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<!-- Visualizando a superfície do Kernel em 3D: -->
<!-- ![](figuras/anima3d.gif) -->
<!-- Clique [AQUI para explorar interativamente a perspectiva em 3D](teste3d.html) -->
<p><br />
</p>
<p>O pacote <code>MASS</code> possui uma função que determina uma largura de banda mais adequada para a estimação do kernel, e é a opção <em>default</em> quando visualizamos um kernel com <code>ggplot()</code>. O pacote <code>splancs</code> também implementa essa funcionalidade utilizando outra metodologia, atravé da função <code>Mse2d()</code>.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="padrões-pontuais-i.html#cb147-1" tabindex="-1"></a>opt_bw <span class="ot">&lt;-</span> <span class="fu">c</span>(MASS<span class="sc">::</span><span class="fu">bandwidth.nrd</span>(clu_ppp<span class="sc">$</span>x), MASS<span class="sc">::</span><span class="fu">bandwidth.nrd</span>(clu_ppp<span class="sc">$</span>y))</span>
<span id="cb147-2"><a href="padrões-pontuais-i.html#cb147-2" tabindex="-1"></a></span>
<span id="cb147-3"><a href="padrões-pontuais-i.html#cb147-3" tabindex="-1"></a>opt_bw</span></code></pre></div>
<p>[1] 1118 1450</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="padrões-pontuais-i.html#cb148-1" tabindex="-1"></a>g_contour_opt <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(clu_ppp), <span class="fu">aes</span>(x,</span>
<span id="cb148-2"><a href="padrões-pontuais-i.html#cb148-2" tabindex="-1"></a>    y)) <span class="sc">+</span> <span class="fu">stat_density2d_filled</span>(<span class="at">h =</span> opt_bw) <span class="sc">+</span> <span class="fu">stat_density2d</span>(<span class="at">h =</span> opt_bw,</span>
<span id="cb148-3"><a href="padrões-pontuais-i.html#cb148-3" tabindex="-1"></a>    <span class="at">n =</span> <span class="dv">200</span>, <span class="at">contour_var =</span> <span class="st">&quot;count&quot;</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb148-4"><a href="padrões-pontuais-i.html#cb148-4" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Cluster&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;Largura de banda ótima&quot;</span>) <span class="sc">+</span></span>
<span id="cb148-5"><a href="padrões-pontuais-i.html#cb148-5" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb148-6"><a href="padrões-pontuais-i.html#cb148-6" tabindex="-1"></a></span>
<span id="cb148-7"><a href="padrões-pontuais-i.html#cb148-7" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_contour2 <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">&quot;Largura de banda arbitrária (500)&quot;</span>),</span>
<span id="cb148-8"><a href="padrões-pontuais-i.html#cb148-8" tabindex="-1"></a>    g_contour_opt, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-154-1.png" width="100%" style="display: block; margin: auto;" /></p>
<!-- Neste caso a largura de banda sugerida pelo método MSE se mostrou mais interessante para evidenciar mais os locais com possíveis clusters, ao passo que o valor de $\tau$ de 0.20 suaviza mais, mostrando menos locais de elevação da densidade de pontos.  -->
</div>
</div>
<div id="kernel-por-atributo" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Kernel por atributo<a href="padrões-pontuais-i.html#kernel-por-atributo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>O alisamento utilizando o Kernel permite estimar a densidade de eventos por unidade de área. É possível, também, se usar uma covariável (atributo).</p></li>
<li><p>Como exemplo, pode-se estimar a “população por unidade de área”, e até mesmo fazer a razão entre dois Kernels obtendo uma estimativa alisada de “eventos por população”.</p></li>
</ul>
<p><span class="math display">\[\hat{\lambda}(s) = \sum\limits_{i=1}^{n} \dfrac{1}{\tau^2} K \left( \frac{(s - s&#39;_j)}{\tau} \right) y_i \nonumber\]</span>
<!-- Oswaldo, conferir a formula com a descrição abaixo, pq na formula nao tem $\lambda'$. e o que é o j?--></p>
<p>Sendo:</p>
<p><span class="math inline">\(\lambda&#39;\)</span> : Estimativa do atributo para unidade de área</p>
<p><span class="math inline">\(\tau\)</span> : Largura de banda</p>
<p><span class="math inline">\(y_i\)</span> : valor do atributo em cada ponto</p>
<p>Pode-se atribuir ao centróide do setor censitário ou ao centro populacional o número de habitantes de toda a área (atributo), por exemplo.</p>
</div>
<div id="razão-de-kernel" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Razão de Kernel<a href="padrões-pontuais-i.html#razão-de-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vamos criar uma “taxa suavizada” a partir da divisão dos alisamentos dos eventos por unidade de área dividido pelo alisamento da população por unidade de área.</p>
<p><span class="math display">\[\hat{\lambda}(s) = \dfrac{\sum\limits_{i=1}^{n} \dfrac{1}{\tau^2} K \left( \frac{(s - s_i)}{\tau} \right)}{\sum\limits_{i=1}^{n} \dfrac{1}{\tau^2} K \left( \frac{(s - s&#39;_j)}{\tau} \right) y_i} \nonumber\]</span></p>
<p><br />
</p>
<ul>
<li><p>Pode-se usar diferentes larguras de banda (em geral maior no denominador para estabilizar mais).</p></li>
<li><p>Pode-se usar outro evento pontual como “estimador da população a risco”.</p></li>
</ul>
<p><br />
</p>
<p><strong>Exemplo:</strong> Comparando 2 eventos: casos clusterizados (<em>casos</em>) vs casos aleatórios (<em>controle</em>):</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="padrões-pontuais-i.html#cb149-1" tabindex="-1"></a>alea_den1 <span class="ot">&lt;-</span> <span class="fu">density</span>(alea_ppp, <span class="at">sigma =</span> <span class="dv">200</span>)</span>
<span id="cb149-2"><a href="padrões-pontuais-i.html#cb149-2" tabindex="-1"></a></span>
<span id="cb149-3"><a href="padrões-pontuais-i.html#cb149-3" tabindex="-1"></a>clu_alea_ratio <span class="ot">&lt;-</span> clu_den1<span class="sc">/</span>alea_den1</span>
<span id="cb149-4"><a href="padrões-pontuais-i.html#cb149-4" tabindex="-1"></a></span>
<span id="cb149-5"><a href="padrões-pontuais-i.html#cb149-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb149-6"><a href="padrões-pontuais-i.html#cb149-6" tabindex="-1"></a><span class="fu">plot</span>(clu_den1, <span class="at">main =</span> <span class="st">&quot;Cluster&quot;</span>)</span>
<span id="cb149-7"><a href="padrões-pontuais-i.html#cb149-7" tabindex="-1"></a><span class="fu">plot</span>(clu_ppp, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb149-8"><a href="padrões-pontuais-i.html#cb149-8" tabindex="-1"></a></span>
<span id="cb149-9"><a href="padrões-pontuais-i.html#cb149-9" tabindex="-1"></a><span class="fu">plot</span>(alea_den1, <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb149-10"><a href="padrões-pontuais-i.html#cb149-10" tabindex="-1"></a><span class="fu">plot</span>(alea_ppp, <span class="at">add =</span> T, <span class="at">col =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb149-11"><a href="padrões-pontuais-i.html#cb149-11" tabindex="-1"></a></span>
<span id="cb149-12"><a href="padrões-pontuais-i.html#cb149-12" tabindex="-1"></a><span class="fu">plot</span>(clu_alea_ratio, <span class="at">main =</span> <span class="st">&quot;Razão&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-157-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><strong>Exemplo</strong>: Verificando o padrão espacial de segunda ordem dos casos de homicídos em POA/RS:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="padrões-pontuais-i.html#cb150-1" tabindex="-1"></a><span class="co"># Além de transformar os pontos para ppp, vamos</span></span>
<span id="cb150-2"><a href="padrões-pontuais-i.html#cb150-2" tabindex="-1"></a><span class="co"># especificar uma janela para delimitar a área de</span></span>
<span id="cb150-3"><a href="padrões-pontuais-i.html#cb150-3" tabindex="-1"></a><span class="co"># estimação para o kernel:</span></span>
<span id="cb150-4"><a href="padrões-pontuais-i.html#cb150-4" tabindex="-1"></a></span>
<span id="cb150-5"><a href="padrões-pontuais-i.html#cb150-5" tabindex="-1"></a>homic_ppp <span class="ot">&lt;-</span> homic_sf2 <span class="sc">%&gt;%</span></span>
<span id="cb150-6"><a href="padrões-pontuais-i.html#cb150-6" tabindex="-1"></a>    <span class="fu">as.ppp</span>()</span>
<span id="cb150-7"><a href="padrões-pontuais-i.html#cb150-7" tabindex="-1"></a><span class="fu">Window</span>(homic_ppp) <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(poa_sf)</span>
<span id="cb150-8"><a href="padrões-pontuais-i.html#cb150-8" tabindex="-1"></a></span>
<span id="cb150-9"><a href="padrões-pontuais-i.html#cb150-9" tabindex="-1"></a>homic_den1 <span class="ot">&lt;-</span> <span class="fu">density</span>(homic_ppp, <span class="at">sigma =</span> <span class="dv">200</span>, <span class="at">diggle =</span> <span class="cn">TRUE</span>)</span>
<span id="cb150-10"><a href="padrões-pontuais-i.html#cb150-10" tabindex="-1"></a></span>
<span id="cb150-11"><a href="padrões-pontuais-i.html#cb150-11" tabindex="-1"></a>g_homic_den1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(homic_den1), <span class="fu">aes</span>(x,</span>
<span id="cb150-12"><a href="padrões-pontuais-i.html#cb150-12" tabindex="-1"></a>    y)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(homic_ppp),</span>
<span id="cb150-13"><a href="padrões-pontuais-i.html#cb150-13" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf,</span>
<span id="cb150-14"><a href="padrões-pontuais-i.html#cb150-14" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb150-15"><a href="padrões-pontuais-i.html#cb150-15" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-16"><a href="padrões-pontuais-i.html#cb150-16" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Homicídios&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;sigma = 200&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-17"><a href="padrões-pontuais-i.html#cb150-17" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb150-18"><a href="padrões-pontuais-i.html#cb150-18" tabindex="-1"></a></span>
<span id="cb150-19"><a href="padrões-pontuais-i.html#cb150-19" tabindex="-1"></a>suic_ppp <span class="ot">&lt;-</span> suic_sf <span class="sc">%&gt;%</span></span>
<span id="cb150-20"><a href="padrões-pontuais-i.html#cb150-20" tabindex="-1"></a>    <span class="fu">as.ppp</span>()</span>
<span id="cb150-21"><a href="padrões-pontuais-i.html#cb150-21" tabindex="-1"></a><span class="fu">Window</span>(suic_ppp) <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(poa_sf)</span>
<span id="cb150-22"><a href="padrões-pontuais-i.html#cb150-22" tabindex="-1"></a></span>
<span id="cb150-23"><a href="padrões-pontuais-i.html#cb150-23" tabindex="-1"></a>suic_den1 <span class="ot">&lt;-</span> <span class="fu">density</span>(suic_ppp, <span class="at">sigma =</span> <span class="dv">200</span>, <span class="at">diggle =</span> <span class="cn">TRUE</span>)</span>
<span id="cb150-24"><a href="padrões-pontuais-i.html#cb150-24" tabindex="-1"></a></span>
<span id="cb150-25"><a href="padrões-pontuais-i.html#cb150-25" tabindex="-1"></a>g_suic_den1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(suic_den1), <span class="fu">aes</span>(x,</span>
<span id="cb150-26"><a href="padrões-pontuais-i.html#cb150-26" tabindex="-1"></a>    y)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(suic_ppp),</span>
<span id="cb150-27"><a href="padrões-pontuais-i.html#cb150-27" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf,</span>
<span id="cb150-28"><a href="padrões-pontuais-i.html#cb150-28" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb150-29"><a href="padrões-pontuais-i.html#cb150-29" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-30"><a href="padrões-pontuais-i.html#cb150-30" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Suicídios&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;sigma = 200&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-31"><a href="padrões-pontuais-i.html#cb150-31" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb150-32"><a href="padrões-pontuais-i.html#cb150-32" tabindex="-1"></a></span>
<span id="cb150-33"><a href="padrões-pontuais-i.html#cb150-33" tabindex="-1"></a>acid_ppp <span class="ot">&lt;-</span> acid_sf <span class="sc">%&gt;%</span></span>
<span id="cb150-34"><a href="padrões-pontuais-i.html#cb150-34" tabindex="-1"></a>    <span class="fu">as.ppp</span>()</span>
<span id="cb150-35"><a href="padrões-pontuais-i.html#cb150-35" tabindex="-1"></a><span class="fu">Window</span>(acid_ppp) <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(poa_sf)</span>
<span id="cb150-36"><a href="padrões-pontuais-i.html#cb150-36" tabindex="-1"></a></span>
<span id="cb150-37"><a href="padrões-pontuais-i.html#cb150-37" tabindex="-1"></a>acid_den1 <span class="ot">&lt;-</span> <span class="fu">density</span>(acid_ppp, <span class="at">sigma =</span> <span class="dv">200</span>, <span class="at">diggle =</span> <span class="cn">TRUE</span>)</span>
<span id="cb150-38"><a href="padrões-pontuais-i.html#cb150-38" tabindex="-1"></a></span>
<span id="cb150-39"><a href="padrões-pontuais-i.html#cb150-39" tabindex="-1"></a>g_acid_den1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(acid_den1), <span class="fu">aes</span>(x,</span>
<span id="cb150-40"><a href="padrões-pontuais-i.html#cb150-40" tabindex="-1"></a>    y)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(acid_ppp),</span>
<span id="cb150-41"><a href="padrões-pontuais-i.html#cb150-41" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf,</span>
<span id="cb150-42"><a href="padrões-pontuais-i.html#cb150-42" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb150-43"><a href="padrões-pontuais-i.html#cb150-43" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-44"><a href="padrões-pontuais-i.html#cb150-44" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Acidentes&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;sigma = 200&quot;</span>) <span class="sc">+</span></span>
<span id="cb150-45"><a href="padrões-pontuais-i.html#cb150-45" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb150-46"><a href="padrões-pontuais-i.html#cb150-46" tabindex="-1"></a></span>
<span id="cb150-47"><a href="padrões-pontuais-i.html#cb150-47" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_homic_den1, g_suic_den1,</span>
<span id="cb150-48"><a href="padrões-pontuais-i.html#cb150-48" tabindex="-1"></a>    g_acid_den1, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-158-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="padrões-pontuais-i.html#cb151-1" tabindex="-1"></a>homic_den2 <span class="ot">&lt;-</span> <span class="fu">density</span>(homic_ppp, <span class="at">sigma =</span> <span class="dv">100</span>, <span class="at">diggle =</span> <span class="cn">TRUE</span>)</span>
<span id="cb151-2"><a href="padrões-pontuais-i.html#cb151-2" tabindex="-1"></a></span>
<span id="cb151-3"><a href="padrões-pontuais-i.html#cb151-3" tabindex="-1"></a>g_homic_den2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(homic_den2), <span class="fu">aes</span>(x,</span>
<span id="cb151-4"><a href="padrões-pontuais-i.html#cb151-4" tabindex="-1"></a>    y)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(homic_ppp),</span>
<span id="cb151-5"><a href="padrões-pontuais-i.html#cb151-5" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf,</span>
<span id="cb151-6"><a href="padrões-pontuais-i.html#cb151-6" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb151-7"><a href="padrões-pontuais-i.html#cb151-7" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-8"><a href="padrões-pontuais-i.html#cb151-8" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Homicídios&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;sigma = 100&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-9"><a href="padrões-pontuais-i.html#cb151-9" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb151-10"><a href="padrões-pontuais-i.html#cb151-10" tabindex="-1"></a></span>
<span id="cb151-11"><a href="padrões-pontuais-i.html#cb151-11" tabindex="-1"></a>homic_den3 <span class="ot">&lt;-</span> <span class="fu">density</span>(homic_ppp, <span class="at">sigma =</span> <span class="dv">500</span>, <span class="at">diggle =</span> <span class="cn">TRUE</span>)</span>
<span id="cb151-12"><a href="padrões-pontuais-i.html#cb151-12" tabindex="-1"></a></span>
<span id="cb151-13"><a href="padrões-pontuais-i.html#cb151-13" tabindex="-1"></a>g_homic_den3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(homic_den3), <span class="fu">aes</span>(x,</span>
<span id="cb151-14"><a href="padrões-pontuais-i.html#cb151-14" tabindex="-1"></a>    y)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">as_tibble</span>(homic_ppp),</span>
<span id="cb151-15"><a href="padrões-pontuais-i.html#cb151-15" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf,</span>
<span id="cb151-16"><a href="padrões-pontuais-i.html#cb151-16" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb151-17"><a href="padrões-pontuais-i.html#cb151-17" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-18"><a href="padrões-pontuais-i.html#cb151-18" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Homicídios&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;sigma = 500&quot;</span>) <span class="sc">+</span></span>
<span id="cb151-19"><a href="padrões-pontuais-i.html#cb151-19" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb151-20"><a href="padrões-pontuais-i.html#cb151-20" tabindex="-1"></a></span>
<span id="cb151-21"><a href="padrões-pontuais-i.html#cb151-21" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_homic_den2, g_homic_den1,</span>
<span id="cb151-22"><a href="padrões-pontuais-i.html#cb151-22" tabindex="-1"></a>    g_homic_den3, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-158-2.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Exemplo:</strong> Fazendo a razão de kernel entre as causas de homicídio e suicídios de Porto alegre/RS:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="padrões-pontuais-i.html#cb152-1" tabindex="-1"></a>suic_homic_ratio <span class="ot">&lt;-</span> suic_den1<span class="sc">/</span>homic_den1</span>
<span id="cb152-2"><a href="padrões-pontuais-i.html#cb152-2" tabindex="-1"></a></span>
<span id="cb152-3"><a href="padrões-pontuais-i.html#cb152-3" tabindex="-1"></a>g_suic_homic <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">as_tibble</span>(suic_homic_ratio),</span>
<span id="cb152-4"><a href="padrões-pontuais-i.html#cb152-4" tabindex="-1"></a>    <span class="fu">aes</span>(x, y)) <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill =</span> value)) <span class="sc">+</span> <span class="fu">geom_sf</span>(<span class="at">data =</span> poa_sf,</span>
<span id="cb152-5"><a href="padrões-pontuais-i.html#cb152-5" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">geometry =</span> geometry), <span class="at">fill =</span> <span class="st">&quot;transparent&quot;</span>,</span>
<span id="cb152-6"><a href="padrões-pontuais-i.html#cb152-6" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb152-7"><a href="padrões-pontuais-i.html#cb152-7" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Razão&quot;</span>, <span class="at">subtitle =</span> <span class="st">&quot;Suicídios/Homicídios&quot;</span>) <span class="sc">+</span></span>
<span id="cb152-8"><a href="padrões-pontuais-i.html#cb152-8" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">fill =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="fu">theme_void</span>()</span>
<span id="cb152-9"><a href="padrões-pontuais-i.html#cb152-9" tabindex="-1"></a></span>
<span id="cb152-10"><a href="padrões-pontuais-i.html#cb152-10" tabindex="-1"></a>gridExtra<span class="sc">::</span><span class="fu">grid.arrange</span>(g_homic_den1, g_suic_den1,</span>
<span id="cb152-11"><a href="padrões-pontuais-i.html#cb152-11" tabindex="-1"></a>    g_suic_homic, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
<div id="análise-preliminar-de-um-processo-pontual" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> Análise preliminar de um processo pontual<a href="padrões-pontuais-i.html#análise-preliminar-de-um-processo-pontual" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="função-f-e-g---distância-do-vizinho-mais-próximo" class="section level3 hasAnchor" number="7.8.1">
<h3><span class="header-section-number">7.8.1</span> Função F e G - Distância do vizinho mais próximo<a href="padrões-pontuais-i.html#função-f-e-g---distância-do-vizinho-mais-próximo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Kernel e quadrat permitem explorar a variação da média do processo na região de estudo (propriedade de primeira ordem).</p></li>
<li><p>Para investigar a propriedade de segunda ordem é necessário observar as distâncias entre os eventos.</p></li>
<li><p>O método do vizinho mais próximo estima a função de distribuição cumulativa baseado nas distâncias entre eventos ou pontos em uma região de análise.</p></li>
<li><p>Dois tipos de distâncias: <strong>evento-evento (W)</strong> e <strong>ponto aleatório-evento (X)</strong></p></li>
</ul>
<p><span class="math display">\[\hat{F}(x) = \dfrac{\#(x_i \leq x)}{m}\]</span></p>
<p><span class="math display">\[\hat{G}(w) = \dfrac{\#(w_i \leq w)}{n}\]</span></p>
<ul>
<li>Sabendo que:</li>
</ul>
<p><em>W</em> - evento-evento</p>
<p><em>X</em> - ponto-evento</p>
<p><em>#</em> - contagem de pontos onde a condição acontece</p>
<p><em>n</em> - total de eventos</p>
<p><em>m</em> - total de pontos aleatórios</p>
<ul>
<li><p>Podemos dizer que ambas as funções podem ser representadas pelo número de (<span class="math inline">\(x_i\)</span>) ou (<span class="math inline">\(w_i\)</span>) cuja distância é menor ou igual ao evento (<span class="math inline">\(x\)</span>) ou ponto (<span class="math inline">\(w\)</span>), dividido pelo total de pontos (<span class="math inline">\(m\)</span>) ou total de eventos (<span class="math inline">\(n\)</span>) na região.</p></li>
<li><p>O resultado desta função empírica é o histograma das distâncias para o vizinho
mais próximo - cada classe do histograma é uma contagem de eventos que ocorrem até
aquela distância.</p></li>
</ul>
<p>A plotagem dos resultados desta função de distribuição cumulativa empírica pode ser usada como um método exploratório para verificar se existe evidência de interação entre os eventos. Se esta plotagem apresentar um crescimento rápido para pequenos valores de distância, esta situação aponta para interação entre os eventos caracterizando agrupamentos nestas escalas. Se esta plotagem apresentar valores pequenos no seu início, e só crescer rapidamente para
valores maiores de distância, esta situação aponta para uma distribuição mais regular.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="padrões-pontuais-i.html#cb153-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb153-2"><a href="padrões-pontuais-i.html#cb153-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> alea_ppp, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb153-3"><a href="padrões-pontuais-i.html#cb153-3" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb153-4"><a href="padrões-pontuais-i.html#cb153-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> uni_ppp, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb153-5"><a href="padrões-pontuais-i.html#cb153-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb153-6"><a href="padrões-pontuais-i.html#cb153-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> clu_ppp, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb153-7"><a href="padrões-pontuais-i.html#cb153-7" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Agregado&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-160-1.png" width="672" style="display: block; margin: auto;" />
Embora o método do vizinho mais próximo forneça uma indicação inicial da distribuição espacial, ele considera apenas escalas pequenas. Para se ter informação mais efetiva para o padrão espacial em escalas maiores, o melhor método a ser utilizado é o da função <span class="math inline">\(K\)</span>.</p>
</div>
</div>
<div id="propriedade-de-segunda-ordem" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> Propriedade de segunda ordem<a href="padrões-pontuais-i.html#propriedade-de-segunda-ordem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="função-k-de-ripley-ou-apenas-função-k" class="section level3 hasAnchor" number="7.9.1">
<h3><span class="header-section-number">7.9.1</span> Função K de Ripley (ou apenas função K)<a href="padrões-pontuais-i.html#função-k-de-ripley-ou-apenas-função-k" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A função <span class="math inline">\(K\)</span> permite analisar as propriedades de segunda ordem de um processo isotrópico.</li>
</ul>
<p><span class="math display">\[\lambda K(h) = E(\#eventos)\]</span></p>
<p>Sendo:</p>
<ul>
<li><p><span class="math inline">\(#eventos\)</span> - o número de eventos esperados até distância <span class="math inline">\(h\)</span></p></li>
<li><p><span class="math inline">\(\lambda\)</span> - a intensidade ou número médio de eventos por unidade de área</p></li>
</ul>
<p>eventos contidos a uma distância h de um evento arbitrário<span class="math inline">\()\)</span></p>
<ul>
<li>A função <span class="math inline">\(K(h)\)</span> é, para cada distância <span class="math inline">\(h\)</span>, o somatório do total de pares cuja distância é menor de que <span class="math inline">\(h\)</span>, vezes o inverso do total de pares ordenados existente na região <span class="math inline">\(R\)</span>.</li>
</ul>
<p><span class="math display">\[K(h) = \dfrac{1}{\lambda^{2} R}\sum \sum\limits_{i \neq j} I_{h} (d_{ij})\]</span></p>
<p>Supondo:</p>
<p><span class="math display">\[I_{h}(d_{ij}) = \begin{cases} 1  \ \ se\ \  d_{ij} \leq h \\ 0 \ \ se\ \  d_{ij} &gt; h \end{cases}\]</span></p>
<p><span class="math inline">\(I_{h}(d_{ij})\)</span> é uma função indicadora</p>
<ul>
<li><p>Esta função também necessita de correção do efeito de borda;</p></li>
<li><p>A função <em>K</em> de Ripley conta quantos pontos há em círculos em torno de uma planta focal;</p></li>
<li><p>Os círculos começam com um raio pequeno e vão até um raio que inclui toda a área de estudo;</p></li>
<li><p>Faz-se uma média do número de pontos nas classes de distâncias em torno de todas as plantas focais da população.</p></li>
</ul>
<p><img src="figuras/ripley.png" style="width:100.0%" /></p>
<ul>
<li>A distribuição é cumulativa e representa o no esperado de vizinhos em um círculo de raio <em>r</em> centrado em uma planta arbitrária dividido pela intensidade <span class="math inline">\(\lambda\)</span> do padrão dos pontos na área de estudo;</li>
</ul>
<p>Possíveis resultados:</p>
<ul>
<li><p><strong>quando o processo é completamente aleatório</strong>, a curva se desvia relativamente pouco de <span class="math inline">\(\pi r²\)</span>. A curva <span class="math inline">\(K\)</span> permanece perto de o valor de referência <span class="math inline">\(\pi r²\)</span>;</p></li>
<li><p><strong>no caso de um processo regular</strong>, obtemos: <span class="math inline">\(\hat{K}(r) &lt; K_{pois}(r)\)</span> porque se os pontos forem repulsivos, eles têm menos vizinhos em média em um raio <span class="math inline">\(r\)</span> do que teriam baseado no pressuposto de uma distribuição aleatória de pontos. Graficamente, a curva K reflete isso repulsão: vemos que no gráfico à abaixo, no processo regular, a curva K está localizada abaixo da referência valor (<span class="math inline">\(\pi r²\)</span>);</p></li>
<li><p><strong>no caso de um processo agregado</strong>, há em média mais pontos em um raio <span class="math inline">\(r\)</span> ao redor os pontos do que o número esperado sob uma distribuição aleatória: consequentemente, os pontos atraem um ao outro e <span class="math inline">\(\hat{K}(r) &gt; K_{pois}(r)\)</span>. Graficamente, a curva <span class="math inline">\(K\)</span> está neste momento localizada acima da
valor de referência para todas as áreas de estudo.</p></li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="padrões-pontuais-i.html#cb154-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb154-2"><a href="padrões-pontuais-i.html#cb154-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> alea_ppp, <span class="at">fun =</span> Kest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb154-3"><a href="padrões-pontuais-i.html#cb154-3" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb154-4"><a href="padrões-pontuais-i.html#cb154-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> uni_ppp, <span class="at">fun =</span> Kest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb154-5"><a href="padrões-pontuais-i.html#cb154-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb154-6"><a href="padrões-pontuais-i.html#cb154-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> clu_ppp, <span class="at">fun =</span> Kest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb154-7"><a href="padrões-pontuais-i.html#cb154-7" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Agregado&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-161-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="função-l" class="section level3 hasAnchor" number="7.9.2">
<h3><span class="header-section-number">7.9.2</span> Função <em>L</em><a href="padrões-pontuais-i.html#função-l" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>A função <span class="math inline">\(K(h)\)</span> tem uma distribuição teórica sob condições de aleatoriedade, quando a probabilidade de ocorrência de um evento em qualquer ponto de <em>R</em> é independente da ocorrência de outros eventos e igual em toda a superfície.</li>
</ul>
<p>Neste caso, o número de eventos a uma distância <span class="math inline">\(h\)</span> será <span class="math inline">\(\pi \lambda h^2\)</span>:</p>
<p><span class="math display">\[ K(h) = \pi h^2\]</span></p>
<p>No caso de distribuição regular, <span class="math inline">\(K(h)\)</span> será menor que <span class="math inline">\(\pi h^2\)</span>.</p>
<p>Distribuição em cluster, K(h) será maior que <span class="math inline">\(\pi h^2\)</span>.</p>
<p>A função <span class="math inline">\(L(h)\)</span> permite comparar a função <span class="math inline">\(K(h)\)</span> e <span class="math inline">\(\pi h^2\)</span></p>
<p><span class="math display">\[L(h) = \sqrt {\dfrac{K(h)}{\pi}}\]</span></p>
<pre><code>- Picos positivos indicam atração espacial - cluster

- Vales negativos - repulsão espacial ou regularidade</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="padrões-pontuais-i.html#cb156-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb156-2"><a href="padrões-pontuais-i.html#cb156-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> alea_ppp, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb156-3"><a href="padrões-pontuais-i.html#cb156-3" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Aleatório&quot;</span>)</span>
<span id="cb156-4"><a href="padrões-pontuais-i.html#cb156-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> uni_ppp, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb156-5"><a href="padrões-pontuais-i.html#cb156-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Regular&quot;</span>)</span>
<span id="cb156-6"><a href="padrões-pontuais-i.html#cb156-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> clu_ppp, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb156-7"><a href="padrões-pontuais-i.html#cb156-7" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Agregado&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-162-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><strong>Exemplo</strong>: Verificando o padrão espacial de segunda ordem dos casos de homicíodos em POA/RS:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="padrões-pontuais-i.html#cb157-1" tabindex="-1"></a><span class="co"># vamos usar só a geometria para não incluir</span></span>
<span id="cb157-2"><a href="padrões-pontuais-i.html#cb157-2" tabindex="-1"></a><span class="co"># aquela variável &#39;dentro&#39;</span></span>
<span id="cb157-3"><a href="padrões-pontuais-i.html#cb157-3" tabindex="-1"></a>homic_ppp2 <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(homic_sf2<span class="sc">$</span>geometry)</span>
<span id="cb157-4"><a href="padrões-pontuais-i.html#cb157-4" tabindex="-1"></a></span>
<span id="cb157-5"><a href="padrões-pontuais-i.html#cb157-5" tabindex="-1"></a></span>
<span id="cb157-6"><a href="padrões-pontuais-i.html#cb157-6" tabindex="-1"></a><span class="fu">plot</span>(homic_ppp2, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb157-7"><a href="padrões-pontuais-i.html#cb157-7" tabindex="-1"></a><span class="fu">polymap</span>(contorno.poa, <span class="at">add =</span> T)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-163-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Note que o restangulo envolvente (<strong>bbox</strong>) foi feito com a coordenadas dos dados, não do contorno de POA.</p>
<p>Grafícos das Funções <em>K</em> , <em>G</em> e <em>L</em> dos homicíodos em POA/RS:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="padrões-pontuais-i.html#cb158-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb158-2"><a href="padrões-pontuais-i.html#cb158-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> homic_ppp2, <span class="at">fun =</span> Kest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb158-3"><a href="padrões-pontuais-i.html#cb158-3" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Funcao K&quot;</span>)</span>
<span id="cb158-4"><a href="padrões-pontuais-i.html#cb158-4" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> homic_ppp2, <span class="at">fun =</span> Gest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb158-5"><a href="padrões-pontuais-i.html#cb158-5" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Funcao G&quot;</span>)</span>
<span id="cb158-6"><a href="padrões-pontuais-i.html#cb158-6" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">envelope</span>(<span class="at">Y =</span> homic_ppp2, <span class="at">fun =</span> Lest, <span class="at">nsim =</span> <span class="dv">99</span>),</span>
<span id="cb158-7"><a href="padrões-pontuais-i.html#cb158-7" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Funcao L&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-164-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Comente esses resultados!</p>
</div>
</div>
<div id="detecção-de-cluster" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> Detecção de cluster<a href="padrões-pontuais-i.html#detecção-de-cluster" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><p>Definição (Knox): grupo de ocorrências geograficamente limitado em tamanho e concentração tais que seja improvável ocorrer por mero acaso.</p></li>
<li><p>São causas de cluster: fonte comum, contagiosidade.</p></li>
<li><p>Clusters são em geral espaço-temporais.</p></li>
<li><p>É importante considerar:</p>
<ul>
<li><p>Demais fatores de risco – sexo, idade;</p></li>
<li><p>Residência X outros locais;</p></li>
<li><p>Latência.</p></li>
</ul></li>
<li><p>Dois tipos básicos de testes:</p>
<ul>
<li><p><strong>Focados</strong>: testa-se a hipótese de excesso de casos ao redor de fonte suspeita, identificada antes de observar os dados;</p></li>
<li><p><strong>Genéricos</strong>: busca identificar áreas quentes, sem especificar quais e quantas.</p></li>
</ul></li>
<li><p>Hipóteses dos testes:</p>
<p><span class="math inline">\(H_0\)</span>: É ausência de cluster: completa aleatoriedade espacial (CSR).</p></li>
<li><p><strong>CSR</strong></p></li>
<li><p>Sendo:</p></li>
</ul>
<p><span class="math inline">\(n\)</span> são subdivisões da região do estudo,</p>
<p><span class="math inline">\(y_i\)</span> número de casos observados e <span class="math inline">\(E_i\)</span> esperados,</p>
<p><span class="math inline">\(\lambda\)</span> eventos por unidade de área (e tempo).</p>
<ul>
<li><p>Alternativas:</p>
<ul>
<li><p>Focados - <span class="math inline">\(\lambda\)</span> varia com a distância da fonte</p></li>
<li><p>Genéricos - existe regiões onde <span class="math inline">\(\lambda\)</span> é mais elevado</p></li>
</ul></li>
</ul>
<p><br />
</p>
<div id="testes-genéricos-de-cluster" class="section level3 hasAnchor" number="7.10.1">
<h3><span class="header-section-number">7.10.1</span> Testes Genéricos de Cluster<a href="padrões-pontuais-i.html#testes-genéricos-de-cluster" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p><strong>Knox:</strong> Testa um número acima do esperado de pares de casos excessivamente próximos (segundo critério pré-estabelecido) no espaço e no tempo.</p></li>
<li><p><strong>Mantel:</strong> Distância no tempo e distância no espaço, se <span class="math inline">\(x\)</span> for 1 e <span class="math inline">\(y\)</span>
for 1, equivale ao teste de Knox.</p></li>
</ul>
<p><span class="math display">\[\sum \sum\limits_{i \neq j} x_{ij} y_{ij} \]</span></p>
<ul>
<li><strong>Cuzick-Edwards:</strong> Caso-controle onde a coincidência de casos vizinhos aumenta o peso, e a junção controle-controle ou caso-controle tem peso zero; este teste permite considerar a variação populacional.</li>
</ul>
<p><br />
</p>
</div>
<div id="fonte-específica" class="section level3 hasAnchor" number="7.10.2">
<h3><span class="header-section-number">7.10.2</span> Fonte Específica<a href="padrões-pontuais-i.html#fonte-específica" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>Cluster ao redor de um ponto ou uma linha.</p></li>
<li><p>Compara-se a ocorrência de no excessivo de “casos” em relação à população a partir de uma função de decaimento em relação à possível fonte.</p></li>
</ul>
<p><span class="math display">\[\lambda (s) = \rho \lambda&#39;(s)f(h;\theta)\]</span></p>
<p><span class="math display">\[f(h;\theta) = 1 + \theta_1 e^{\theta_{2}h^2}\]</span></p>
<p>Sendo:</p>
<p><span class="math inline">\(\theta(s)\)</span> - estimativa do evento p/ unidade de área</p>
<p><span class="math inline">\(\rho\)</span> - parâmetro que indica a razão entre “casos” e “controles”</p>
<p><span class="math inline">\(\lambda&#39;(s)\)</span> - estimativa população p/ unidade de área</p>
<p><span class="math inline">\(f\)</span> - função da distância para a fonte</p>
<p><span class="math inline">\(θ\)</span> - parâmetros a estimar que descrevem como a incidência varia em torno da fonte</p>
</div>
</div>
<div id="exercícios-propostos-4" class="section level2 hasAnchor" number="7.11">
<h2><span class="header-section-number">7.11</span> Exercícios Propostos<a href="padrões-pontuais-i.html#exercícios-propostos-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li><p>Testar a CSR e explorar os Kernels para as causas de suicídio e acidentes de carro em POA/RS.</p></li>
<li><p>Fazer a razão de kernel entre suicídios e acidentes de carro em POA/RS.</p></li>
<li><p>Inspecionar o processo pontual de segunta ordem, utilizando as funções K, G e L para as causas de suicídio e acidentes de carro em POA/RS.</p></li>
</ol>
<div id="exercícios-resolvidos-1" class="section level3 hasAnchor" number="7.11.1">
<h3><span class="header-section-number">7.11.1</span> Exercícios Resolvidos<a href="padrões-pontuais-i.html#exercícios-resolvidos-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://github.com/ogcruz/dados_eco_2023/blob/main/scripts/ex_cap6_padraoponto.r">Exercícios Padrões Pontuais</a></li>
</ul>
</div>
</div>
<div id="bibliografia-sugerida-5" class="section level2 hasAnchor" number="7.12">
<h2><span class="header-section-number">7.12</span> Bibliografia sugerida<a href="padrões-pontuais-i.html#bibliografia-sugerida-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ASSUNÇÃO, Renato M. Estatística espacial com aplicações em epidemiologia, economia e sociologia. São Carlos: Associação Brasileira de Estatística, v. 131, 2001.</p>
<p>DIGGLE, Peter J. et al. Statistical analysis of spatial point patterns. Academic press, 1983.</p>
<p>GATRELL, Anthony C. et al. Spatial point pattern analysis and its application in geographical epidemiology. Transactions of the Institute of British geographers, p. 256-274, 1996.</p>
<p>BADDELEY, Adrian , RUBAK, Ege, TURNER, Rolf Turner. Spatial Point Patterns: Methodology and Applications with R Chapman and Hall/CRC 810 Pages. 1st Edition 2015.</p>
<p>BIVAND, Roger. et al. Applied Spatial Data Analysis with R, Springler 2008</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introdução-à-análise-estatística-espacial.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="padrões-pontuais-ii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"scroll_highlight": true,
"toolbar": {
"position": "fixed"
},
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
