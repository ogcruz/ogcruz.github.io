<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 4 Transformações e Suavizações | ESTUDOS ECOLÓGICOS 2021</title>
  <meta name="description" content=" 4 Transformações e Suavizações | ESTUDOS ECOLÓGICOS 2021" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content=" 4 Transformações e Suavizações | ESTUDOS ECOLÓGICOS 2021" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 4 Transformações e Suavizações | ESTUDOS ECOLÓGICOS 2021" />
  
  
  

<meta name="author" content="Oswaldo G Cruz &amp; Laís P Freitas" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introdução-às-séries-temporais.html"/>
<link rel="next" href="modelagem-em-séries-temporais.html"/>
<script src="libs/header-attrs-2.8/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.18/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estudos Ecológicos 2021</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="apresentação.html"><a href="apresentação.html"><i class="fa fa-check"></i><b>1</b> Apresentação</a></li>
<li class="chapter" data-level="2" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html"><i class="fa fa-check"></i><b>2</b> Estudos Ecológicos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#o-que-são-estudos-ecológicos"><i class="fa fa-check"></i><b>2.1</b> O que são Estudos Ecológicos ?</a></li>
<li class="chapter" data-level="2.2" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#principais-objetivos"><i class="fa fa-check"></i><b>2.2</b> Principais objetivos</a></li>
<li class="chapter" data-level="2.3" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#tipos-de-variáveis-utilizadas"><i class="fa fa-check"></i><b>2.3</b> Tipos de Variáveis Utilizadas</a></li>
<li class="chapter" data-level="2.4" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#tipos-de-desenhos-de-estudos-ecológicos"><i class="fa fa-check"></i><b>2.4</b> Tipos de Desenhos de Estudos Ecológicos</a></li>
<li class="chapter" data-level="2.5" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#aspectos-históricos"><i class="fa fa-check"></i><b>2.5</b> Aspectos históricos</a></li>
<li class="chapter" data-level="2.6" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#epidemiologia-social"><i class="fa fa-check"></i><b>2.6</b> Epidemiologia social</a></li>
<li class="chapter" data-level="2.7" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#árvores-bosques-ou-as-florestas"><i class="fa fa-check"></i><b>2.7</b> Árvores, Bosques ou as Florestas?</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#as-árvores"><i class="fa fa-check"></i><b>2.7.1</b> As Árvores</a></li>
<li class="chapter" data-level="2.7.2" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#os-bosques"><i class="fa fa-check"></i><b>2.7.2</b> Os Bosques</a></li>
<li class="chapter" data-level="2.7.3" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#as-florestas"><i class="fa fa-check"></i><b>2.7.3</b> As Florestas</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#falácia-ecológica-ou-viés-de-agregação"><i class="fa fa-check"></i><b>2.8</b> Falácia Ecológica ou viés de agregação</a></li>
<li class="chapter" data-level="2.9" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#problemas-práticos"><i class="fa fa-check"></i><b>2.9</b> Problemas práticos</a></li>
<li class="chapter" data-level="2.10" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#vantagens"><i class="fa fa-check"></i><b>2.10</b> Vantagens</a></li>
<li class="chapter" data-level="2.11" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#desvantagens"><i class="fa fa-check"></i><b>2.11</b> Desvantagens</a></li>
<li class="chapter" data-level="2.12" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#resumindo"><i class="fa fa-check"></i><b>2.12</b> Resumindo</a></li>
<li class="chapter" data-level="2.13" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#exercícios-propostos"><i class="fa fa-check"></i><b>2.13</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="2.14" data-path="estudos-ecológicos.html"><a href="estudos-ecológicos.html#bibliografia-sugerida"><i class="fa fa-check"></i><b>2.14</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html"><i class="fa fa-check"></i><b>3</b> Introdução às Séries Temporais</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#o-que-são-séries-temporais"><i class="fa fa-check"></i><b>3.1</b> O que são Séries Temporais ?</a></li>
<li class="chapter" data-level="3.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#hipóteses-básicas-do-estudo-das-séries-temporais"><i class="fa fa-check"></i><b>3.2</b> Hipóteses básicas do estudo das séries temporais</a></li>
<li class="chapter" data-level="3.3" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#classificação-dos-tipos-de-séries-temporais"><i class="fa fa-check"></i><b>3.3</b> Classificação dos tipos de séries temporais</a></li>
<li class="chapter" data-level="3.4" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#processo-estocástico"><i class="fa fa-check"></i><b>3.4</b> Processo Estocástico</a></li>
<li class="chapter" data-level="3.5" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#notação-e-nomenclatura"><i class="fa fa-check"></i><b>3.5</b> Notação e Nomenclatura</a></li>
<li class="chapter" data-level="3.6" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#objetivos-análise-de-séries-temporais"><i class="fa fa-check"></i><b>3.6</b> Objetivos: análise de séries temporais</a></li>
<li class="chapter" data-level="3.7" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#estacionariedade"><i class="fa fa-check"></i><b>3.7</b> Estacionariedade</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#função-de-autocovariância-de-um-processo-estacionário"><i class="fa fa-check"></i><b>3.7.1</b> Função de Autocovariância de um processo estacionário</a></li>
<li class="chapter" data-level="3.7.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#por-que-a-estacionariedade-é-importante"><i class="fa fa-check"></i><b>3.7.2</b> Por que a estacionariedade é importante ?</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#pressuposto-da-independência"><i class="fa fa-check"></i><b>3.8</b> Pressuposto da Independência</a></li>
<li class="chapter" data-level="3.9" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#dependência-serial"><i class="fa fa-check"></i><b>3.9</b> Dependência serial</a></li>
<li class="chapter" data-level="3.10" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#função-de-autocorrelação---fac-autocorrelation-function---acf"><i class="fa fa-check"></i><b>3.10</b> Função de Autocorrelação - FAC (<em>Autocorrelation function - ACF</em>)</a></li>
<li class="chapter" data-level="3.11" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#componentes-de-uma-série-temporal"><i class="fa fa-check"></i><b>3.11</b> Componentes de uma Série Temporal</a></li>
<li class="chapter" data-level="3.12" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#tendência"><i class="fa fa-check"></i><b>3.12</b> Tendência</a></li>
<li class="chapter" data-level="3.13" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#sazonalidade"><i class="fa fa-check"></i><b>3.13</b> Sazonalidade</a></li>
<li class="chapter" data-level="3.14" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#ciclo"><i class="fa fa-check"></i><b>3.14</b> Ciclo</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#como-detectar-a-sazonalidade"><i class="fa fa-check"></i><b>3.14.1</b> Como detectar a sazonalidade ?</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#termo-aleatório-ou-ruído-branco"><i class="fa fa-check"></i><b>3.15</b> Termo Aleatório ou Ruído Branco</a></li>
<li class="chapter" data-level="3.16" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#composição-dos-modelos-de-séries-temporais"><i class="fa fa-check"></i><b>3.16</b> Composição dos Modelos de séries temporais</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#modelo-aditivo"><i class="fa fa-check"></i><b>3.16.1</b> Modelo Aditivo</a></li>
<li class="chapter" data-level="3.16.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#modelo-multiplicativo"><i class="fa fa-check"></i><b>3.16.2</b> Modelo Multiplicativo</a></li>
</ul></li>
<li class="chapter" data-level="3.17" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#decomposição-de-séries-temporais"><i class="fa fa-check"></i><b>3.17</b> Decomposição de séries temporais</a></li>
<li class="chapter" data-level="3.18" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#prática-no-r"><i class="fa fa-check"></i><b>3.18</b> Prática no R</a>
<ul>
<li class="chapter" data-level="3.18.1" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#a-biblioteca-ts-é-a-mais-utilizada-no-r"><i class="fa fa-check"></i><b>3.18.1</b> A biblioteca <em>ts</em> é a mais utilizada no R</a></li>
<li class="chapter" data-level="3.18.2" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#simulando-uma-série-temporal"><i class="fa fa-check"></i><b>3.18.2</b> Simulando uma Série Temporal</a></li>
<li class="chapter" data-level="3.18.3" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#importando-uma-vetor-e-transformando-em-série-temporal"><i class="fa fa-check"></i><b>3.18.3</b> Importando uma vetor e transformando em Série Temporal</a></li>
<li class="chapter" data-level="3.18.4" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#utilizando-dados-da-incidência-de-dengue-nas-filipinas-2008---2016"><i class="fa fa-check"></i><b>3.18.4</b> Utilizando dados da incidência de dengue nas Filipinas, 2008 - 2016</a></li>
</ul></li>
<li class="chapter" data-level="3.19" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#exercícios-propostos-1"><i class="fa fa-check"></i><b>3.19</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="3.20" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#outros-materiais-sobre-séries-temporais"><i class="fa fa-check"></i><b>3.20</b> Outros materiais sobre Séries Temporais</a></li>
<li class="chapter" data-level="3.21" data-path="introdução-às-séries-temporais.html"><a href="introdução-às-séries-temporais.html#bibliografia-sugerida-1"><i class="fa fa-check"></i><b>3.21</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html"><i class="fa fa-check"></i><b>4</b> Transformações e Suavizações</a>
<ul>
<li class="chapter" data-level="4.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#introdução"><i class="fa fa-check"></i><b>4.1</b> Introdução</a></li>
<li class="chapter" data-level="4.2" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#transfomação-dos-dados-em-st"><i class="fa fa-check"></i><b>4.2</b> Transfomação dos dados em ST</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#transformações-box-cox-diferenciação-e-logarítmica"><i class="fa fa-check"></i><b>4.2.1</b> Transformações Box-Cox, Diferenciação e Logarítmica</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#métodos-de-alisamento-ou-suavização"><i class="fa fa-check"></i><b>4.3</b> Métodos de Alisamento ou Suavização</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#algumas-funções-de-suavização"><i class="fa fa-check"></i><b>4.3.1</b> Algumas funções de suavização</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#médias-móveis"><i class="fa fa-check"></i><b>4.4</b> Médias móveis</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#utilização-das-médias-móveis"><i class="fa fa-check"></i><b>4.4.1</b> Utilização das Médias Móveis</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#kernel"><i class="fa fa-check"></i><b>4.5</b> Kernel</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#diferentes-funções-kernel"><i class="fa fa-check"></i><b>4.5.1</b> Diferentes Funções Kernel</a></li>
<li class="chapter" data-level="4.5.2" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#largura-de-banda"><i class="fa fa-check"></i><b>4.5.2</b> Largura de Banda</a></li>
<li class="chapter" data-level="4.5.3" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#utilização-do-kernel"><i class="fa fa-check"></i><b>4.5.3</b> Utilização do Kernel</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#loess-lowess"><i class="fa fa-check"></i><b>4.6</b> Loess / Lowess</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#utilização-do-loesslowess"><i class="fa fa-check"></i><b>4.6.1</b> Utilização do loess/lowess</a></li>
<li class="chapter" data-level="4.6.2" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#comparando"><i class="fa fa-check"></i><b>4.6.2</b> Comparando</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#splines"><i class="fa fa-check"></i><b>4.7</b> Splines</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#splines-vs-loesslowess"><i class="fa fa-check"></i><b>4.7.1</b> Splines <em>vs</em> Loess/Lowess</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#exercícios-propostos-2"><i class="fa fa-check"></i><b>4.8</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="4.9" data-path="transformações-e-suavizações.html"><a href="transformações-e-suavizações.html#bibliografia-sugerida-2"><i class="fa fa-check"></i><b>4.9</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html"><i class="fa fa-check"></i><b>5</b> Modelagem em Séries Temporais</a>
<ul>
<li class="chapter" data-level="5.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#o-que-são-os-modelos-box-jenkins"><i class="fa fa-check"></i><b>5.1</b> O que são os Modelos Box &amp; Jenkins</a></li>
<li class="chapter" data-level="5.2" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#alguns-processos-estocásticos"><i class="fa fa-check"></i><b>5.2</b> Alguns processos estocásticos</a></li>
<li class="chapter" data-level="5.3" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-arima"><i class="fa fa-check"></i><b>5.3</b> Modelo ARIMA</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-autorregressivo-de-ordem-p---arp-ou-arimap00"><i class="fa fa-check"></i><b>5.3.1</b> Modelo Autorregressivo de ordem <em>p</em> - AR(p) ou ARIMA(p,0,0)</a></li>
<li class="chapter" data-level="5.3.2" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#condições-de-estacionariedade"><i class="fa fa-check"></i><b>5.3.2</b> Condições de estacionariedade</a></li>
<li class="chapter" data-level="5.3.3" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-de-médias-móveis-de-ordem-q---maq-ou-arima00q"><i class="fa fa-check"></i><b>5.3.3</b> Modelo de Médias Móveis de ordem <em>q</em> - MA(q) ou ARIMA(0,0,q)</a></li>
<li class="chapter" data-level="5.3.4" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#condições-de-invertibilidade"><i class="fa fa-check"></i><b>5.3.4</b> Condições de invertibilidade</a></li>
<li class="chapter" data-level="5.3.5" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-autorregressivo-de-médias-móveis-de-ordem-p-e-q---armapq-ou-arimap0q"><i class="fa fa-check"></i><b>5.3.5</b> Modelo Autorregressivo de Médias Móveis de ordem <em>p</em> e <em>q</em> - ARMA(p,q) ou ARIMA(p,0,q)</a></li>
<li class="chapter" data-level="5.3.6" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#modelo-autorregressivo-integrado-de-médias-móveis-de-ordem-p-d-e-q---arimapdq"><i class="fa fa-check"></i><b>5.3.6</b> Modelo Autorregressivo Integrado de Médias Móveis de ordem <em>p</em>, <em>d</em> e <em>q</em> - ARIMA(p,d,q)</a></li>
<li class="chapter" data-level="5.3.7" data-path="modelagem-em-séries-temporais.html"><a href="modelagem-em-séries-temporais.html#resumo---modelos-arima-não-sazonais"><i class="fa fa-check"></i><b>5.3.7</b> Resumo - Modelos ARIMA não sazonais</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="introdução-à-análise-estatística-espacial-padrão-de-pontos-i.html"><a href="introdução-à-análise-estatística-espacial-padrão-de-pontos-i.html"><i class="fa fa-check"></i><b>6</b> Introdução à Análise Estatística Espacial &amp; Padrão de Pontos I</a></li>
<li class="chapter" data-level="7" data-path="análise-espacial-padrão-de-pontos-ii.html"><a href="análise-espacial-padrão-de-pontos-ii.html"><i class="fa fa-check"></i><b>7</b> Análise Espacial - Padrão de Pontos II</a></li>
<li class="chapter" data-level="8" data-path="análise-espacial-dados-de-área-i.html"><a href="análise-espacial-dados-de-área-i.html"><i class="fa fa-check"></i><b>8</b> Análise Espacial - Dados de Área I</a></li>
<li class="chapter" data-level="9" data-path="dados-de-área-ii.html"><a href="dados-de-área-ii.html"><i class="fa fa-check"></i><b>9</b> Dados de Área II</a></li>
<li class="chapter" data-level="10" data-path="análise-espacial-geoestatística.html"><a href="análise-espacial-geoestatística.html"><i class="fa fa-check"></i><b>10</b> Análise Espacial - Geoestatística</a></li>
<li class="chapter" data-level="11" data-path="análise-espaço-temporal-instruções-e-dúvidas-para-o-trabalho-final.html"><a href="análise-espaço-temporal-instruções-e-dúvidas-para-o-trabalho-final.html"><i class="fa fa-check"></i><b>11</b> Análise Espaço-Temporal &amp; Instruções e Dúvidas para o Trabalho Final</a></li>
<li class="chapter" data-level="12" data-path="roteiro-para-a-execução-do-trabalho-final.html"><a href="roteiro-para-a-execução-do-trabalho-final.html"><i class="fa fa-check"></i><b>12</b> Roteiro para a execução do trabalho final</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="roteiro-para-a-execução-do-trabalho-final.html"><a href="roteiro-para-a-execução-do-trabalho-final.html#sugestões-de-locais-para-baixar-os-dados-e-os-mapas"><i class="fa fa-check"></i><b>12.0.1</b> Sugestões de locais para baixar os dados e os mapas</a></li>
<li class="chapter" data-level="12.1" data-path="roteiro-para-a-execução-do-trabalho-final.html"><a href="roteiro-para-a-execução-do-trabalho-final.html#ficha-de-avaliação"><i class="fa fa-check"></i><b>12.1</b> Ficha de Avaliação</a></li>
<li class="chapter" data-level="12.2" data-path="roteiro-para-a-execução-do-trabalho-final.html"><a href="roteiro-para-a-execução-do-trabalho-final.html#fim"><i class="fa fa-check"></i><b>12.2</b> FIM</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="anexo-i-roteiro-séries-temporais.html"><a href="anexo-i-roteiro-séries-temporais.html"><i class="fa fa-check"></i>Anexo I - Roteiro séries temporais</a></li>
<li class="chapter" data-level="" data-path="anexo-ii-fazendo-mapas-com-ggplot.html"><a href="anexo-ii-fazendo-mapas-com-ggplot.html"><i class="fa fa-check"></i>Anexo II - Fazendo mapas com ggplot</a></li>
<li class="chapter" data-level="13" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html"><i class="fa fa-check"></i><b>13</b> Estudos Ecológicos</a>
<ul>
<li class="chapter" data-level="13.1" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#o-que-são-estudos-ecológicos-1"><i class="fa fa-check"></i><b>13.1</b> O que são Estudos Ecológicos ?</a></li>
<li class="chapter" data-level="13.2" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#principais-objetivos-1"><i class="fa fa-check"></i><b>13.2</b> Principais objetivos</a></li>
<li class="chapter" data-level="13.3" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#tipos-de-variáveis-utilizadas-1"><i class="fa fa-check"></i><b>13.3</b> Tipos de Variáveis Utilizadas</a></li>
<li class="chapter" data-level="13.4" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#tipos-de-desenhos-de-estudos-ecológicos-1"><i class="fa fa-check"></i><b>13.4</b> Tipos de Desenhos de Estudos Ecológicos</a></li>
<li class="chapter" data-level="13.5" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#aspectos-históricos-1"><i class="fa fa-check"></i><b>13.5</b> Aspectos históricos</a></li>
<li class="chapter" data-level="13.6" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#epidemiologia-social-1"><i class="fa fa-check"></i><b>13.6</b> Epidemiologia social</a></li>
<li class="chapter" data-level="13.7" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#árvores-bosques-ou-as-florestas-1"><i class="fa fa-check"></i><b>13.7</b> Árvores, Bosques ou as Florestas?</a>
<ul>
<li class="chapter" data-level="13.7.1" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#as-árvores-1"><i class="fa fa-check"></i><b>13.7.1</b> As Árvores</a></li>
<li class="chapter" data-level="13.7.2" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#os-bosques-1"><i class="fa fa-check"></i><b>13.7.2</b> Os Bosques</a></li>
<li class="chapter" data-level="13.7.3" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#as-florestas-1"><i class="fa fa-check"></i><b>13.7.3</b> As Florestas</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#falácia-ecológica-ou-viés-de-agregação-1"><i class="fa fa-check"></i><b>13.8</b> Falácia Ecológica ou viés de agregação</a></li>
<li class="chapter" data-level="13.9" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#problemas-práticos-1"><i class="fa fa-check"></i><b>13.9</b> Problemas práticos</a></li>
<li class="chapter" data-level="13.10" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#vantagens-1"><i class="fa fa-check"></i><b>13.10</b> Vantagens</a></li>
<li class="chapter" data-level="13.11" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#desvantagens-1"><i class="fa fa-check"></i><b>13.11</b> Desvantagens</a></li>
<li class="chapter" data-level="13.12" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#resumindo-1"><i class="fa fa-check"></i><b>13.12</b> Resumindo</a></li>
<li class="chapter" data-level="13.13" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#exercícios-propostos-3"><i class="fa fa-check"></i><b>13.13</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="13.14" data-path="estudos-ecológicos-1.html"><a href="estudos-ecológicos-1.html#bibliografia-sugerida-3"><i class="fa fa-check"></i><b>13.14</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html"><i class="fa fa-check"></i><b>14</b> Introdução às Séries Temporais</a>
<ul>
<li class="chapter" data-level="14.1" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#o-que-são-séries-temporais-1"><i class="fa fa-check"></i><b>14.1</b> O que são Séries Temporais ?</a></li>
<li class="chapter" data-level="14.2" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#hipóteses-básicas-do-estudo-das-séries-temporais-1"><i class="fa fa-check"></i><b>14.2</b> Hipóteses básicas do estudo das séries temporais</a></li>
<li class="chapter" data-level="14.3" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#classificação-dos-tipos-de-séries-temporais-1"><i class="fa fa-check"></i><b>14.3</b> Classificação dos tipos de séries temporais</a></li>
<li class="chapter" data-level="14.4" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#processo-estocástico-1"><i class="fa fa-check"></i><b>14.4</b> Processo Estocástico</a></li>
<li class="chapter" data-level="14.5" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#notação-e-nomenclatura-1"><i class="fa fa-check"></i><b>14.5</b> Notação e Nomenclatura</a></li>
<li class="chapter" data-level="14.6" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#objetivos-análise-de-séries-temporais-1"><i class="fa fa-check"></i><b>14.6</b> Objetivos: análise de séries temporais</a></li>
<li class="chapter" data-level="14.7" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#estacionariedade-1"><i class="fa fa-check"></i><b>14.7</b> Estacionariedade</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#função-de-autocovariância-de-um-processo-estacionário-1"><i class="fa fa-check"></i><b>14.7.1</b> Função de Autocovariância de um processo estacionário</a></li>
<li class="chapter" data-level="14.7.2" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#por-que-a-estacionariedade-é-importante-1"><i class="fa fa-check"></i><b>14.7.2</b> Por que a estacionariedade é importante ?</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#pressuposto-da-independência-1"><i class="fa fa-check"></i><b>14.8</b> Pressuposto da Independência</a></li>
<li class="chapter" data-level="14.9" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#dependência-serial-1"><i class="fa fa-check"></i><b>14.9</b> Dependência serial</a></li>
<li class="chapter" data-level="14.10" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#função-de-autocorrelação---fac-autocorrelation-function---acf-1"><i class="fa fa-check"></i><b>14.10</b> Função de Autocorrelação - FAC (<em>Autocorrelation function - ACF</em>)</a></li>
<li class="chapter" data-level="14.11" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#componentes-de-uma-série-temporal-1"><i class="fa fa-check"></i><b>14.11</b> Componentes de uma Série Temporal</a></li>
<li class="chapter" data-level="14.12" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#tendência-1"><i class="fa fa-check"></i><b>14.12</b> Tendência</a></li>
<li class="chapter" data-level="14.13" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#sazonalidade-1"><i class="fa fa-check"></i><b>14.13</b> Sazonalidade</a></li>
<li class="chapter" data-level="14.14" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#ciclo-1"><i class="fa fa-check"></i><b>14.14</b> Ciclo</a>
<ul>
<li class="chapter" data-level="14.14.1" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#como-detectar-a-sazonalidade-1"><i class="fa fa-check"></i><b>14.14.1</b> Como detectar a sazonalidade ?</a></li>
</ul></li>
<li class="chapter" data-level="14.15" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#termo-aleatório-ou-ruído-branco-1"><i class="fa fa-check"></i><b>14.15</b> Termo Aleatório ou Ruído Branco</a></li>
<li class="chapter" data-level="14.16" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#composição-dos-modelos-de-séries-temporais-1"><i class="fa fa-check"></i><b>14.16</b> Composição dos Modelos de séries temporais</a>
<ul>
<li class="chapter" data-level="14.16.1" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#modelo-aditivo-1"><i class="fa fa-check"></i><b>14.16.1</b> Modelo Aditivo</a></li>
<li class="chapter" data-level="14.16.2" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#modelo-multiplicativo-1"><i class="fa fa-check"></i><b>14.16.2</b> Modelo Multiplicativo</a></li>
</ul></li>
<li class="chapter" data-level="14.17" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#decomposição-de-séries-temporais-1"><i class="fa fa-check"></i><b>14.17</b> Decomposição de séries temporais</a></li>
<li class="chapter" data-level="14.18" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#prática-no-r-1"><i class="fa fa-check"></i><b>14.18</b> Prática no R</a>
<ul>
<li class="chapter" data-level="14.18.1" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#a-biblioteca-ts-é-a-mais-utilizada-no-r-1"><i class="fa fa-check"></i><b>14.18.1</b> A biblioteca <em>ts</em> é a mais utilizada no R</a></li>
<li class="chapter" data-level="14.18.2" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#simulando-uma-série-temporal-1"><i class="fa fa-check"></i><b>14.18.2</b> Simulando uma Série Temporal</a></li>
<li class="chapter" data-level="14.18.3" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#importando-uma-vetor-e-transformando-em-série-temporal-1"><i class="fa fa-check"></i><b>14.18.3</b> Importando uma vetor e transformando em Série Temporal</a></li>
<li class="chapter" data-level="14.18.4" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#utilizando-dados-da-incidência-de-dengue-nas-filipinas-2008---2016-1"><i class="fa fa-check"></i><b>14.18.4</b> Utilizando dados da incidência de dengue nas Filipinas, 2008 - 2016</a></li>
</ul></li>
<li class="chapter" data-level="14.19" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#exercícios-propostos-4"><i class="fa fa-check"></i><b>14.19</b> Exercícios Propostos</a></li>
<li class="chapter" data-level="14.20" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#outros-materiais-sobre-séries-temporais-1"><i class="fa fa-check"></i><b>14.20</b> Outros materiais sobre Séries Temporais</a></li>
<li class="chapter" data-level="14.21" data-path="introdução-às-séries-temporais-1.html"><a href="introdução-às-séries-temporais-1.html#bibliografia-sugerida-4"><i class="fa fa-check"></i><b>14.21</b> Bibliografia sugerida</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://ogcruz.github.io" target="blank">Página Inicial</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">ESTUDOS ECOLÓGICOS 2021</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="transformações-e-suavizações" class="section level1" number="4">
<h1><span class="header-section-number"> 4</span> Transformações e Suavizações</h1>
<div id="introdução" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introdução</h2>
<p>As transformações e as funções de alisamento (suavização) em séries temporais são normalmente empregados para nos ajudar a ver melhor os padrões existentes - tais como as tendências e sazonalidade - e suavizar as oscilações irregulares (ruídos) para que possamos obter uma série mais limpa com um sinal mais claro.</p>
<p>Estas técnicas não nos fornecem um modelo, mas podem ser um bom primeiro passo na descrição para os vários componentes da série.</p>
</div>
<div id="transfomação-dos-dados-em-st" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Transfomação dos dados em ST</h2>
<p>Alguns exemplos:</p>
<ul>
<li><p><strong>Utilização de funções:</strong> Logarítmicas, Potências, Exponenciais, ou transformação <em>Box-Cox</em>.</p></li>
<li><p><strong>Diferenciação:</strong> Séries não estacionárias. Objetivo é transformar a série em estacionária, estabilizando a média ( <span class="math inline">\(\bigtriangledown Z_t\)</span> ).</p></li>
<li><p><strong>Box-Cox:</strong> Estabiliza a variância. (também o <strong>log</strong> , <strong>sqrt</strong> etc…)</p></li>
<li><p><strong>Médias Móveis:</strong> Permite a suavização dos dados da ST. Reduz <em>outliers</em> e captura a tendência.</p></li>
<li><p><strong>Outras técnicas de suavização:</strong> Kernel, Loess/Lowess, Splines e <em>Generalized Additive Model</em> (GAM).</p></li>
</ul>
<p>Para demostrar o resultado dessas transformações, iremos aplicar algumas dessas técnicas.</p>
<div id="transformações-box-cox-diferenciação-e-logarítmica" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Transformações Box-Cox, Diferenciação e Logarítmica</h3>
<p>Esta é uma técnica de transformação de dados útil para estabilizar a variância, tornar os dados mais semelhantes à distribuição normal, melhorar a validade das medidas de associação e para outros procedimentos de estabilização de dados.</p>
<ul>
<li>Box and Cox (1964) propuseram uma transformação na variável da ST <span class="math inline">\(Z_t\)</span>, que depende do parâmetro <span class="math inline">\(\lambda\)</span> da seguinte forma:</li>
</ul>
<p><span class="math display">\[ Z_{t}(\lambda) = \left\{ \begin{array}{rc} Z_t^{\lambda}, &amp;\mbox{se} \quad \lambda \neq 0, \\  ln(Z_t) , &amp;\mbox{se} \quad \lambda = 0. \end{array}\right.\]</span></p>
<ul>
<li>Se o valor de <span class="math inline">\(\lambda\)</span> é igual a zero, a transformação logarítmica da sequência inicial é realizada.</li>
<li>Se o valor de lambda difere de zero, a transformação é por lei exponencial.</li>
<li>Quando <span class="math inline">\(\lambda\)</span> = 1, a série é analisada em sua escala original.</li>
<li><span class="math inline">\(\lambda = 1/2\)</span> corresponde à transformação da raiz quadrada.</li>
<li>Para que a transformação seja aplicável, a série deve ser estritamente positiva.</li>
</ul>
<p>Ex: Utilizando os dados do dataset Air Passengers, temos:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="transformações-e-suavizações.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb41-2"><a href="transformações-e-suavizações.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb41-3"><a href="transformações-e-suavizações.html#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Série original</span></span>
<span id="cb41-4"><a href="transformações-e-suavizações.html#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(AirPassengers, <span class="at">ylab=</span><span class="st">&quot;Passageiros&quot;</span>, <span class="at">main=</span><span class="st">&quot;Original&quot;</span>)</span>
<span id="cb41-5"><a href="transformações-e-suavizações.html#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lambda = 0, Logaritmica </span></span>
<span id="cb41-6"><a href="transformações-e-suavizações.html#cb41-6" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> <span class="fu">BoxCox</span>(AirPassengers,<span class="at">lambda =</span><span class="dv">0</span> )</span>
<span id="cb41-7"><a href="transformações-e-suavizações.html#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t1, <span class="at">ylab=</span><span class="st">&quot;Passageiros&quot;</span>, <span class="at">main=</span><span class="st">&quot;Lambda = 0, Logaritmica&quot;</span>)</span>
<span id="cb41-8"><a href="transformações-e-suavizações.html#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Lambda = 0.1 </span></span>
<span id="cb41-9"><a href="transformações-e-suavizações.html#cb41-9" aria-hidden="true" tabindex="-1"></a>t2 <span class="ot">&lt;-</span> <span class="fu">BoxCox</span>(AirPassengers,<span class="at">lambda =</span>.<span class="dv">1</span> )</span>
<span id="cb41-10"><a href="transformações-e-suavizações.html#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t2, <span class="at">ylab=</span><span class="st">&quot;Passageiros&quot;</span>, <span class="at">main=</span><span class="st">&quot;Lambda = 0.1&quot;</span>)</span>
<span id="cb41-11"><a href="transformações-e-suavizações.html#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera labda automático</span></span>
<span id="cb41-12"><a href="transformações-e-suavizações.html#cb41-12" aria-hidden="true" tabindex="-1"></a>lbd <span class="ot">&lt;-</span> <span class="fu">BoxCox.lambda</span>(AirPassengers)</span>
<span id="cb41-13"><a href="transformações-e-suavizações.html#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co"># print(lbd)</span></span>
<span id="cb41-14"><a href="transformações-e-suavizações.html#cb41-14" aria-hidden="true" tabindex="-1"></a>t3 <span class="ot">&lt;-</span> <span class="fu">BoxCox</span>(AirPassengers,<span class="at">lambda =</span>lbd )</span>
<span id="cb41-15"><a href="transformações-e-suavizações.html#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t3, <span class="at">ylab=</span><span class="st">&quot;Passageiros&quot;</span>, <span class="at">main=</span><span class="fu">paste0</span>(<span class="st">&quot;Lambda Automático (&quot;</span>,<span class="fu">round</span>(lbd,<span class="dv">4</span>),<span class="st">&quot;)&quot;</span>))</span>
<span id="cb41-16"><a href="transformações-e-suavizações.html#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Diferenciação </span></span>
<span id="cb41-17"><a href="transformações-e-suavizações.html#cb41-17" aria-hidden="true" tabindex="-1"></a>t4 <span class="ot">&lt;-</span> <span class="fu">diff</span>(AirPassengers)</span>
<span id="cb41-18"><a href="transformações-e-suavizações.html#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t4, <span class="at">ylab=</span><span class="st">&quot;Passageiros&quot;</span>, <span class="at">main=</span><span class="st">&quot;Diferenciação &quot;</span>)</span>
<span id="cb41-19"><a href="transformações-e-suavizações.html#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Logarítmo </span></span>
<span id="cb41-20"><a href="transformações-e-suavizações.html#cb41-20" aria-hidden="true" tabindex="-1"></a>t5 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(AirPassengers))</span>
<span id="cb41-21"><a href="transformações-e-suavizações.html#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t5, <span class="at">ylab=</span><span class="st">&quot;Passageiros&quot;</span>, <span class="at">main=</span><span class="st">&quot;Diferença do Log&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-49-1.png" width="100%" /></p>
</div>
</div>
<div id="métodos-de-alisamento-ou-suavização" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Métodos de Alisamento ou Suavização</h2>
<ul>
<li><p>Uma função é suave quando contínua e derivável em todos os pontos.</p></li>
<li><p>Utiliza-se a expressão <em>Funções de Suavização</em> para definir funções que, aplicadas sobre um conjunto numérico, retornam outro conjunto cujos valores tendem à média (local ou global).</p></li>
<li><p>Funções de suavização são utilizadas quando se supõe que o fenômeno é, de fato, suave, e as observações apresentam variabilidade aleatória pouco relevante.</p></li>
<li><p>Também são utilizadas quando se deseja modelar a estrutura geral o fenômeno, desconsiderando cada ocorência isolada.</p></li>
</ul>
<div id="algumas-funções-de-suavização" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Algumas funções de suavização</h3>
<p>Existem diversos tipos de funções de suavização no <strong>R</strong>. Dentre as principais, destacamos:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Médias móveis:</strong> O método mais simples de suavização.</p></li>
<li><p><strong>Kernel density:</strong> Estimativa de densidade de probabilidade – equivale à uma média ponderada.</p></li>
<li><p><strong>Loess/Lowess:</strong> <em>locally (weighted) estimated scatterplot smoothing</em> – estende a mesma idéia, mas os valores entram em uma regressão (ponderada ou não), retornando não apenas a média, mas também uma inclinação (<span class="math inline">\(\beta\)</span>).</p></li>
<li><p><strong>Splines:</strong> cúbica, quadrática, p-splines, thin plate splines etc…</p></li>
</ol>
<p>Todas essas funções podem ser uni ou multi-dimensionais. Existem ainda várias outras funções para suavizar.</p>
<!-- ![](figuras/LOESS1.png){width=700px} -->
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
</div>
</div>
<div id="médias-móveis" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Médias móveis</h2>
<p>Considere a ST estacionária e localmente constante, composta de seu nível e mais um ruído aleatório:</p>
<p><span class="math display">\[ Z_t = \mu_t + a_t , \]</span> <span class="math display">\[t = 1,2,...,N \]</span></p>
<p>Sendo <span class="math inline">\(E(a_t) = 0\)</span>, <span class="math inline">\(Var(a_t)=\sigma^2_a\)</span> e <span class="math inline">\(\mu_t\)</span> é um parâmetro desconhecido que varia com o tempo.</p>
<p>A técnica de média móvel consiste em calcular a média aritmética das <span class="math inline">\(h\)</span> observcações mais recentes, ou seja:</p>
<p><span class="math display">\[M_t = \dfrac{Z_t+Z_{t-1}+...+Z_{t-h+1}}{h}\]</span></p>
<ul>
<li><p>Denotamos por <span class="math inline">\(h\)</span> o comprimento da média.</p></li>
<li><p>Desta forma, <span class="math inline">\(M_t\)</span> é uma estimativa do nível <span class="math inline">\(\mu_t\)</span> que não leva em consideração as observações mais antigas. Note que a cada período a observação mais antiga é substituída pela mais recente, calculando-se uma média nova.</p></li>
</ul>
<!-- #![](figuras/running-eps-converted-to.png){width=700px} -->
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Vamos exemplificar o que acontece quando se usa uma janela de 3 meses. Repare as 3 primeiras observações na série original:</p>
<p><img src="figuras/mm_fig2.png" width="1270" /></p>
<p>Agroa a série com Média Móvel 3. Note que o primeiro e o último valores da série agora são <strong>NA</strong>:</p>
<p><img src="figuras/mm_fig3.png" width="1270" /></p>
<p>Observe que o valor para fevereiro é calculado a partir dos 3 primeiros valores.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb42-1"><a href="transformações-e-suavizações.html#cb42-1" aria-hidden="true" tabindex="-1"></a>    (<span class="fl">16.87</span> + <span class="fl">15.08</span> + <span class="fl">15.07</span>)/<span class="dv">3</span> =  <span class="fl">15.67</span></span></code></pre></div>
<p>Note que o exemplo acima é uma media móvel <strong>centrada</strong> com uma janela de 3 meses. Nesse caso, se perde o primeiro e o último pontos da série.</p>
<p>Existe ainda a possibilidade de se alinhar a media móvel à direita ou à esquerda, sendo a media centrada o <em>default</em> na grande maioria das funções.</p>
<p><strong>Exemplo:</strong> Utilizando a ST mensal de mortes em estradas no Reino Unido (1969–1984), temos :</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="transformações-e-suavizações.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb43-2"><a href="transformações-e-suavizações.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(UKDriverDeaths,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&quot;Média Móvel Centrada&quot;</span>)</span>
<span id="cb43-3"><a href="transformações-e-suavizações.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ma</span>(UKDriverDeaths,<span class="dv">12</span>),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">1</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb43-4"><a href="transformações-e-suavizações.html#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ma</span>(UKDriverDeaths,<span class="dv">4</span>),<span class="at">col=</span><span class="dv">4</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb43-5"><a href="transformações-e-suavizações.html#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Óbitos&quot;</span>,<span class="st">&quot;Média Móvel 4&quot;</span>,<span class="st">&quot;Média Móvel 12&quot;</span>),</span>
<span id="cb43-6"><a href="transformações-e-suavizações.html#cb43-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">cex=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-52-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Existem muitas funções em diversos pacotes que possibilitam fazer a media móvel. No exemplo anterior, usamos a função <code>ma()</code> do pacote <code>forecast</code>. Vamos a seguir usar a função <code>rollmean()</code> do pacote <code>zoo</code>, mostrando como ficariam as médias móveis com esses outros alinhamentos.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="transformações-e-suavizações.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(UKDriverDeaths,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&quot;Média Móvel alinhada à direita&quot;</span>)</span>
<span id="cb44-2"><a href="transformações-e-suavizações.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(zoo<span class="sc">::</span><span class="fu">rollmean</span>(UKDriverDeaths,<span class="at">k=</span><span class="dv">6</span>,<span class="at">align =</span> <span class="st">&#39;right&#39;</span>),<span class="at">col=</span><span class="dv">4</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="transformações-e-suavizações.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(UKDriverDeaths,<span class="at">ylab=</span><span class="st">&#39;&#39;</span>,<span class="at">main=</span><span class="st">&quot;Média Móvel alinhada à esquerda&quot;</span>)</span>
<span id="cb45-2"><a href="transformações-e-suavizações.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(zoo<span class="sc">::</span><span class="fu">rollmean</span>(UKDriverDeaths,<span class="at">k=</span><span class="dv">6</span>,<span class="at">align =</span> <span class="st">&#39;left&#39;</span>),<span class="at">col=</span><span class="dv">6</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<div id="utilização-das-médias-móveis" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Utilização das Médias Móveis</h3>
<ul>
<li><p>Processo de Transformação - “Suavização da Série”</p></li>
<li><p>Remoção de outliers</p></li>
<li><p>Identificação de tendências</p></li>
</ul>
<p><strong>Ex:</strong> Médias Móveis - ordem 5</p>
</div>
</div>
<div id="kernel" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Kernel</h2>
<p>O algoritmo:</p>
<ul>
<li><p>Seja <span class="math inline">\((x)\)</span> ponto para o qual se deseja estimar f(.)</p></li>
<li><p>Defina a função <strong>kernel</strong>: simétrica, unimodal, centrada em <span class="math inline">\((x)\)</span>, que cai a zero nos limites da <strong>vizinhança</strong>.</p></li>
<li><p>Esse subconjunto dos dados, também denominado <strong>janela</strong>, <strong>largura de banda</strong> ou <strong>parâmetro de suavização</strong> controla flexibilidade do kernel.</p></li>
<li><p>Repita o procedimento para diversos <span class="math inline">\((x)\)</span></p></li>
<li><p>Conecte os pontos</p></li>
</ul>
<p><span class="math display">\[\hat{f_h}(x) = \dfrac{1}{Nh}\sum{K \left( \dfrac{x-x_i}{h}\right)}\]</span></p>
<ul>
<li><p><span class="math inline">\(h\)</span> <span class="math inline">\(\rightarrow\)</span> largura de banda</p></li>
<li><p><span class="math inline">\(K\)</span> <span class="math inline">\(\rightarrow\)</span> função de suavização</p></li>
</ul>
<p>Kernel Gaussiano: <span class="math display">\[k(x)=\dfrac{1}{\sqrt{2\pi}} exp(1/2 x^2)\]</span></p>
<div id="diferentes-funções-kernel" class="section level3" number="4.5.1">
<h3><span class="header-section-number">4.5.1</span> Diferentes Funções Kernel</h3>
<p><img src="figuras/variosKernels-eps-converted-to.png" width="700" /></p>
<p>Vamos a uma demostração:</p>
<p>Ao chamar a função <code>demo()</code> você vai ver um painel de controle como o abaixo: <img src="figuras/tk_fig1.png" /></p>
<p>E uma gráfico de uma função <strong>kernel</strong> como abaixo. Utilize o controle deslizante mostrado pela seta e altere as opções.</p>
<p><img src="figuras/tk_fig2.png" /></p>
<ul>
<li>Série Temporal: Leptospirose <em>vs</em> Clima.</li>
</ul>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="transformações-e-suavizações.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#declara local na internet onde estão os dados</span></span>
<span id="cb46-2"><a href="transformações-e-suavizações.html#cb46-2" aria-hidden="true" tabindex="-1"></a>local <span class="ot">&lt;-</span> <span class="st">&quot;https://gitlab.procc.fiocruz.br/oswaldo/eco2019/raw/master/dados/&quot;</span></span>
<span id="cb46-3"><a href="transformações-e-suavizações.html#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="transformações-e-suavizações.html#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="transformações-e-suavizações.html#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="do">## a função paste0 junta o local e o nome do arquivo!</span></span>
<span id="cb46-6"><a href="transformações-e-suavizações.html#cb46-6" aria-hidden="true" tabindex="-1"></a>lepto <span class="ot">&lt;-</span> <span class="fu">read.csv2</span>(<span class="fu">paste0</span>(local,<span class="st">&quot;leptoruido.csv&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb46-7"><a href="transformações-e-suavizações.html#cb46-7" aria-hidden="true" tabindex="-1"></a>dia <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">paste0</span>(local,<span class="st">&quot;climadia.dat&quot;</span>), <span class="at">header=</span>T)</span>
<span id="cb46-8"><a href="transformações-e-suavizações.html#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="transformações-e-suavizações.html#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb46-10"><a href="transformações-e-suavizações.html#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb46-11"><a href="transformações-e-suavizações.html#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sm)</span>
<span id="cb46-12"><a href="transformações-e-suavizações.html#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb46-13"><a href="transformações-e-suavizações.html#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="transformações-e-suavizações.html#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="co">#XY condicionado</span></span>
<span id="cb46-15"><a href="transformações-e-suavizações.html#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(cases <span class="sc">+</span> totrain <span class="sc">+</span> tempmed <span class="sc">~</span> week,</span>
<span id="cb46-16"><a href="transformações-e-suavizações.html#cb46-16" aria-hidden="true" tabindex="-1"></a> <span class="at">outer=</span><span class="cn">TRUE</span>, <span class="at">layout=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">pch=</span><span class="dv">1</span>, <span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb46-17"><a href="transformações-e-suavizações.html#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">scales=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">&#39;same&#39;</span>), <span class="at">y=</span><span class="fu">list</span>(<span class="at">relation=</span><span class="st">&#39;free&#39;</span>)),</span>
<span id="cb46-18"><a href="transformações-e-suavizações.html#cb46-18" aria-hidden="true" tabindex="-1"></a> <span class="at">data=</span>lepto)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-56-1.png" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li>Exemplos de Kernel em histogramas</li>
</ul>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="transformações-e-suavizações.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### density - default &quot;gaussian&quot;</span></span>
<span id="cb47-2"><a href="transformações-e-suavizações.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lepto<span class="sc">$</span>totrain, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">400</span>,<span class="at">by=</span><span class="dv">10</span>),<span class="at">freq=</span>F, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Chuva&quot;</span>)</span>
<span id="cb47-3"><a href="transformações-e-suavizações.html#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>totrain , <span class="dv">4</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb47-4"><a href="transformações-e-suavizações.html#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>totrain , <span class="dv">12</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb47-5"><a href="transformações-e-suavizações.html#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;4&quot;</span>,<span class="st">&quot;12&quot;</span>), <span class="at">title=</span><span class="st">&quot;BW&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-57-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="transformações-e-suavizações.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lepto<span class="sc">$</span>cases, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">36</span>,<span class="at">by=</span><span class="dv">1</span>),<span class="at">freq=</span>F, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Casos Leptospirose&quot;</span>)</span>
<span id="cb48-2"><a href="transformações-e-suavizações.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>cases , <span class="dv">1</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb48-3"><a href="transformações-e-suavizações.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>cases , <span class="dv">2</span>),<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb48-4"><a href="transformações-e-suavizações.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>cases , <span class="dv">4</span>),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb48-5"><a href="transformações-e-suavizações.html#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>,<span class="st">&quot;2&quot;</span>,<span class="st">&quot;4&quot;</span>), <span class="at">title=</span><span class="st">&quot;BW&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-57-2.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="transformações-e-suavizações.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(lepto<span class="sc">$</span>cases, <span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">36</span>,<span class="at">by=</span><span class="dv">1</span>),<span class="at">freq=</span>F, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>)</span>
<span id="cb49-2"><a href="transformações-e-suavizações.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>cases , <span class="dv">2</span>, <span class="at">kernel =</span> <span class="st">&quot;rectangular&quot;</span> ),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb49-3"><a href="transformações-e-suavizações.html#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>cases , <span class="dv">2</span>, <span class="at">kernel =</span> <span class="st">&quot;triangular&quot;</span> ),<span class="at">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb49-4"><a href="transformações-e-suavizações.html#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(lepto<span class="sc">$</span>cases , <span class="dv">2</span>, <span class="at">kernel =</span> <span class="st">&quot;gaussian&quot;</span> ),<span class="at">col=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb49-5"><a href="transformações-e-suavizações.html#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;retangular&quot;</span>,<span class="st">&quot;triangular&quot;</span>,<span class="st">&quot;gaussiano&quot;</span>), <span class="at">title=</span><span class="st">&quot;BW&quot;</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="st">&quot;green&quot;</span>,<span class="st">&quot;blue&quot;</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-57-3.png" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li>Aplicando o Kernel em ST:</li>
</ul>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="transformações-e-suavizações.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(totrain <span class="sc">~</span> week, <span class="at">data=</span>lepto, <span class="at">cex=</span>.<span class="dv">3</span>, <span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;gray35&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Kernel Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, </span>
<span id="cb50-2"><a href="transformações-e-suavizações.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">&quot;Kernel Smooth&quot;</span>)</span>
<span id="cb50-3"><a href="transformações-e-suavizações.html#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ksmooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">bandwidth =</span> <span class="dv">52</span>), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb50-4"><a href="transformações-e-suavizações.html#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ksmooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">bandwidth =</span> <span class="dv">21</span>), <span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">7</span>)</span>
<span id="cb50-5"><a href="transformações-e-suavizações.html#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ksmooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">bandwidth =</span> <span class="dv">13</span>), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb50-6"><a href="transformações-e-suavizações.html#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ksmooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>,  <span class="at">bandwidth =</span> <span class="dv">4</span>), <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb50-7"><a href="transformações-e-suavizações.html#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;52 sem.&quot;</span>,<span class="st">&quot;21 sem.&quot;</span>,<span class="st">&quot;13 sem.&quot;</span>,<span class="st">&quot;4 sem.&quot;</span>),<span class="at">fill=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="at">title=</span><span class="st">&quot;Janela&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-58-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="largura-de-banda" class="section level3" number="4.5.2">
<h3><span class="header-section-number">4.5.2</span> Largura de Banda</h3>
<p>Como estimar a largura de banda ?</p>
<ul>
<li>Validação cruzada</li>
</ul>
<p><span class="math display">\[CV(\lambda) = \frac{1}{n} \sum_{j=1}^n \left( y_i - \hat{f}_{\lambda(j)} (x_j) \right) ^2\]</span></p>
<ul>
<li><p>O ponto deixado fora do ajuste a cada vez,</p></li>
<li><p><span class="math inline">\(\lambda\)</span> o valor que minimiza essa equação.</p></li>
</ul>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="transformações-e-suavizações.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">### efeito de borda</span></span>
<span id="cb51-2"><a href="transformações-e-suavizações.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># exluindo os pontos 1 a 3 para forcar borda</span></span>
<span id="cb51-3"><a href="transformações-e-suavizações.html#cb51-3" aria-hidden="true" tabindex="-1"></a>lepto2 <span class="ot">&lt;-</span> lepto[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),]</span>
<span id="cb51-4"><a href="transformações-e-suavizações.html#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="transformações-e-suavizações.html#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hcv</span>(lepto2<span class="sc">$</span>week, lepto2<span class="sc">$</span>totrain, <span class="at">display=</span><span class="st">&quot;lines&quot;</span>)</span></code></pre></div>
<p>[1] 6.129</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="transformações-e-suavizações.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span> <span class="fl">6.129356</span>, <span class="at">col=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-59-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="transformações-e-suavizações.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(totrain <span class="sc">~</span> week, <span class="at">data=</span>lepto2, <span class="at">cex=</span>.<span class="dv">3</span>, <span class="at">pch=</span><span class="dv">19</span>,<span class="at">col=</span><span class="st">&quot;gray35&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Kernel Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, </span>
<span id="cb53-2"><a href="transformações-e-suavizações.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">&quot;Kernel Smooth -- Efeito de Borda&quot;</span>)</span>
<span id="cb53-3"><a href="transformações-e-suavizações.html#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ksmooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">bandwidth =</span> <span class="dv">21</span> ), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb53-4"><a href="transformações-e-suavizações.html#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">ksmooth</span>(lepto2<span class="sc">$</span>week, lepto2<span class="sc">$</span>totrain, <span class="at">kernel =</span> <span class="st">&quot;normal&quot;</span>, <span class="at">bandwidth =</span> <span class="fl">6.1</span> ), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb53-5"><a href="transformações-e-suavizações.html#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;21 sem.&quot;</span>,<span class="st">&quot;6 sem.&quot;</span>),<span class="at">fill=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">title=</span><span class="st">&quot;Janela&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-60-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="utilização-do-kernel" class="section level3" number="4.5.3">
<h3><span class="header-section-number">4.5.3</span> Utilização do Kernel</h3>
<ul>
<li><p>Vantagens: simples, ótimo para análise exploratória.</p></li>
<li><p>Desvantagens: efeito de borda.</p></li>
<li><p>Muito sensível à largura de banda.</p></li>
<li><p>Escolha automática de largura de banda pode não ser o desejável.</p></li>
<li><p>Pouco sensível à forma da função, desde que suave.</p></li>
</ul>
</div>
</div>
<div id="loess-lowess" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Loess / Lowess</h2>
<ul>
<li><p><em>Loess</em> (Locally Estimated Scatterplot Smoothing) e <em>lowess</em> (Locally Weighted Scatterplot Smoothing) são funções semelhante ao kernel, mas os valores são estimados a partir de uma regressão local ao invés da média ponderada.</p></li>
<li><p>No caso do <em>loess</em> a cada ponto do conjunto de dados um polinômio é ajustado utilizando uma reta a um sub-conjunto dos dados através de mínimos quadrados.</p></li>
<li><p>Já para o <em>lowess</em>, é ajustada uma reta por mínimos quadrados <strong>ponderados</strong> de forma a dar maior peso aos pontos próximos.</p></li>
<li><p>O subconjunto dos dados é também denominado <strong>janela</strong>, <strong>largura de banda</strong> ou <strong>parâmetro de suavização</strong> e controla flexibilidade da função de regressão – se a janela for igual ao total de pontos fica igual à regressão.</p></li>
<li><p>Quanto maior o tamanho da janela, maior o alisamento e vice-versa.</p></li>
<li><p>O grau do polinômio de cada regressão local em geral é baixo. Polinômio de primeiro grau é a regressão linear local; de segundo regressão quadrática.</p></li>
<li><p>A largura da janela é indicado por uma fração dos dados que varia de 0 a 1.</p>
<ul>
<li><p>Exemplo: largura 0,1 significa que a janela tem largura que equivale a 10% do eixo horizontal;</p></li>
<li><p>Polinômio de grau 0 é a média móvel;</p></li>
<li><p>Se a janela for de 100% dos pontos = média.</p></li>
</ul></li>
</ul>
<p>Existem varias funções que implementam o <em>loess/lowess</em> no R, por exemplo: <code>lowess()</code> e <code>loess()</code> .</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="transformações-e-suavizações.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain,<span class="at">cex=</span>.<span class="dv">3</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;gray35&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Lowess Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, <span class="at">main=</span><span class="st">&quot;Lowess - Bandwidth e Grau do Polinômio&quot;</span>)</span>
<span id="cb54-2"><a href="transformações-e-suavizações.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(lepto<span class="sc">$</span>totrain <span class="sc">~</span> lepto<span class="sc">$</span>week, <span class="at">f =</span> <span class="fl">0.75</span>),<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb54-3"><a href="transformações-e-suavizações.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(lepto<span class="sc">$</span>totrain <span class="sc">~</span> lepto<span class="sc">$</span>week, <span class="at">f =</span> <span class="fl">0.015</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb54-4"><a href="transformações-e-suavizações.html#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;f=0.75&quot;</span>,<span class="st">&quot;f=0.015&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>), <span class="at">title=</span><span class="st">&quot;&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>,<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-61-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="transformações-e-suavizações.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loess – Span &amp; Grau</span></span>
<span id="cb55-2"><a href="transformações-e-suavizações.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain,<span class="at">cex=</span>.<span class="dv">3</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;gray35&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Loess Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, <span class="at">main=</span><span class="st">&quot;Loess - Bandwidth e Grau do Polinômio&quot;</span>)</span>
<span id="cb55-3"><a href="transformações-e-suavizações.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.75</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb55-4"><a href="transformações-e-suavizações.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.75</span>, <span class="at">degree =</span> <span class="dv">1</span>)),<span class="at">col=</span><span class="dv">2</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb55-5"><a href="transformações-e-suavizações.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.05</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb55-6"><a href="transformações-e-suavizações.html#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.05</span>, <span class="at">degree =</span> <span class="dv">1</span>)),<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb55-7"><a href="transformações-e-suavizações.html#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;75% - 2º&quot;</span>,<span class="st">&quot;75% - Linear (default)&quot;</span>,<span class="st">&quot;5% - 2º&quot;</span>,<span class="st">&quot;5% - Linear&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="st">&quot;darkblue&quot;</span>,<span class="st">&quot;darkblue&quot;</span>), <span class="at">title=</span><span class="st">&quot;Janela e Grau&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-62-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="transformações-e-suavizações.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loess – Span</span></span>
<span id="cb56-2"><a href="transformações-e-suavizações.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># lowess - f </span></span>
<span id="cb56-3"><a href="transformações-e-suavizações.html#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain,<span class="at">cex=</span>.<span class="dv">3</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;gray35&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Loess Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, <span class="at">main=</span><span class="st">&quot;Loess - Bandwidth&quot;</span>)</span>
<span id="cb56-4"><a href="transformações-e-suavizações.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.15</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb56-5"><a href="transformações-e-suavizações.html#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.05</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb56-6"><a href="transformações-e-suavizações.html#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto,<span class="at">span =</span> <span class="fl">0.10</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb56-7"><a href="transformações-e-suavizações.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;  5% (21 sem.)&quot;</span>,<span class="st">&quot;10% (41 sem.)&quot;</span>,<span class="st">&quot;15% (61 sem.)&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="st">&quot;darkblue&quot;</span>,<span class="dv">1</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">title=</span><span class="st">&quot;Janela&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-63-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="transformações-e-suavizações.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loess – Span &amp; Borda</span></span>
<span id="cb57-2"><a href="transformações-e-suavizações.html#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain,<span class="at">cex=</span>.<span class="dv">3</span>, <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">&quot;gray35&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Loess Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, <span class="at">main=</span><span class="st">&quot;Loess - Bandwidth&quot;</span>)</span>
<span id="cb57-3"><a href="transformações-e-suavizações.html#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto2,<span class="at">span =</span> <span class="fl">0.15</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb57-4"><a href="transformações-e-suavizações.html#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto2,<span class="at">span =</span> <span class="fl">0.05</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb57-5"><a href="transformações-e-suavizações.html#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">predict</span>(<span class="fu">loess</span>(totrain <span class="sc">~</span> week , <span class="at">data=</span>lepto2,<span class="at">span =</span> <span class="fl">0.10</span>, <span class="at">degree =</span> <span class="dv">2</span>)),<span class="at">col=</span><span class="st">&quot;darkblue&quot;</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb57-6"><a href="transformações-e-suavizações.html#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;  5% (21 sem.)&quot;</span>,<span class="st">&quot;10% (41 sem.)&quot;</span>,<span class="st">&quot;15% (61 sem.)&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="st">&quot;darkblue&quot;</span>,<span class="dv">1</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">title=</span><span class="st">&quot;Janela&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-64-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="transformações-e-suavizações.html#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loess – Outra forma, mas fica pouco suave</span></span>
<span id="cb58-2"><a href="transformações-e-suavizações.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>tempmed, <span class="at">span =</span> .<span class="dv">05</span>, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">family =</span>  <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb58-3"><a href="transformações-e-suavizações.html#cb58-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">col=</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">ylab=</span><span class="st">&quot;Temperatura&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-66-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="transformações-e-suavizações.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>totrain, <span class="at">span =</span> .<span class="dv">05</span>, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">family =</span>  <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb59-2"><a href="transformações-e-suavizações.html#cb59-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">col=</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">ylab=</span><span class="st">&quot;Chuva&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-66-2.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="transformações-e-suavizações.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">span =</span> .<span class="dv">05</span>, <span class="at">degree =</span> <span class="dv">2</span>, <span class="at">family =</span>  <span class="st">&quot;gaussian&quot;</span>, </span>
<span id="cb60-2"><a href="transformações-e-suavizações.html#cb60-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">col=</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">ylab=</span><span class="st">&quot;Casos Leptospirose&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-66-3.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="utilização-do-loesslowess" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Utilização do loess/lowess</h3>
<ul>
<li><p>Vantagens: simples, ótimo para análise exploratória.</p></li>
<li><p>Menos sensível à borda.</p></li>
<li><p>Desvantagens: pode ser sensível a valores extremos.</p></li>
</ul>
</div>
<div id="comparando" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Comparando</h3>
<!-- ![Nearest neighbor smoother](figuras/suaveEX1.png){width=700px} -->
<div class="figure">
<img src="figuras/suaveEX2.png" width="7000" alt="" />
<p class="caption">Kernel average smoother</p>
</div>
<div class="figure">
<img src="figuras/suaveEX3.png" width="7000" alt="" />
<p class="caption">Local linear regression</p>
</div>
</div>
</div>
<div id="splines" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Splines</h2>
<ul>
<li><p>Splines são um conjunto de funções polinomiais que possuem muitos usos. No nosso caso, estaremos usando como uma função de suavização que juntam nós, de forma suave, mantendo propriedades matemáticas ótimas. A mais usada para este fim é a regressão penalizada chamada <em>spline cúbica natural</em>, com nós em valores distintos de <span class="math inline">\(x_i\)</span>.</p></li>
<li><p>A escolha do parâmetro de suavização pode ser visual ou mais formal, quando a definição é dada pelo valor que minimiza o erro quadrático médio do ajuste, ou através de alguma forma de validação cruzada.</p></li>
<li><p>Na regressão penalizada quer se encontrar a solução <span class="math inline">\(\hat{f}(x)\)</span> que minimize:</p></li>
</ul>
<p><span class="math display">\[\sum\left[y_i - f(x_i) \right]^2 + \tau  \int f&#39;&#39;(x)]^2 dx\]</span> sendo <span class="math inline">\(\tau\)</span> o parâmetro de alisamento:</p>
<p>Se <span class="math inline">\(\tau = 0 \Rightarrow \hat{f}(x)\)</span> é interpolação pontual (conecta os pontos)</p>
<p>Se <span class="math inline">\(\tau = 1 \Rightarrow \hat{f}(x)\)</span> é interpolação linear simples</p>
<ul>
<li>Se <span class="math inline">\(\tau\)</span> é muito grande <span class="math inline">\(\Rightarrow \hat{f}(x)\)</span> será tal que <span class="math inline">\(f&#39;&#39;(x)\)</span> seja zero em todos os pontos, ou seja, mínimos quadrados.</li>
</ul>
<div id="splines-vs-loesslowess" class="section level3" number="4.7.1">
<h3><span class="header-section-number">4.7.1</span> Splines <em>vs</em> Loess/Lowess</h3>
<ul>
<li><p>No <em>spline</em> se minimiza uma função-objetivo explícita, é mais elegante matematicamente que <em>loess/lowess</em>.</p></li>
<li><p>O ajuste dos dois é muito semelhante para o mesmo número de graus de liberdade.</p></li>
<li><p>Pode-se ajustar essas funções para diversos preditores.</p></li>
</ul>
<p>Existe uma forma mais complexa de spline mais complexo para splines (thin plate splines) que pode ser usada em modelos <em>GAM</em>.</p>
<p>Ambas as funções podem também ser utilizadas no espaço.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="transformações-e-suavizações.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">ylab=</span><span class="st">&quot;Casos Leptospirose&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>, <span class="at">main =</span> <span class="st">&quot;spline(.) -- 3 methods&quot;</span>)</span>
<span id="cb61-2"><a href="transformações-e-suavizações.html#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">n=</span><span class="dv">10</span> ), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb61-3"><a href="transformações-e-suavizações.html#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">n=</span><span class="dv">10</span>, <span class="at">method =</span> <span class="st">&quot;natural&quot;</span>), <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb61-4"><a href="transformações-e-suavizações.html#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">n=</span><span class="dv">10</span>, <span class="at">method =</span> <span class="st">&quot;periodic&quot;</span>), <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb61-5"><a href="transformações-e-suavizações.html#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Defaut&quot;</span>,<span class="st">&quot;Natural&quot;</span>,<span class="st">&quot;Periódico&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">title=</span><span class="st">&quot;Janela&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-67-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="transformações-e-suavizações.html#cb62-1" aria-hidden="true" tabindex="-1"></a>lepto.spl <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases)</span>
<span id="cb62-2"><a href="transformações-e-suavizações.html#cb62-2" aria-hidden="true" tabindex="-1"></a>lepto.spl.cv <span class="ot">&lt;-</span> <span class="fu">smooth.spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">cv =</span>T)</span>
<span id="cb62-3"><a href="transformações-e-suavizações.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">cex=</span>.<span class="dv">6</span>, <span class="at">col=</span><span class="st">&quot;darkgray&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Casos Leptospirose&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;Semana&quot;</span>)</span>
<span id="cb62-4"><a href="transformações-e-suavizações.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lepto.spl, <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb62-5"><a href="transformações-e-suavizações.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lepto.spl.cv, <span class="at">col=</span><span class="dv">5</span>)</span>
<span id="cb62-6"><a href="transformações-e-suavizações.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">smooth.spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">df=</span><span class="dv">10</span>),<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb62-7"><a href="transformações-e-suavizações.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">smooth.spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">df=</span><span class="dv">50</span>),<span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb62-8"><a href="transformações-e-suavizações.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">smooth.spline</span>(lepto<span class="sc">$</span>week, lepto<span class="sc">$</span>cases, <span class="at">df=</span><span class="dv">2</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb62-9"><a href="transformações-e-suavizações.html#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Sem CV&quot;</span>,<span class="st">&quot;Com CV&quot;</span>,<span class="st">&quot;df=10&quot;</span>, <span class="st">&quot;df=50&quot;</span>, <span class="st">&quot;df=2&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>), <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">title=</span><span class="st">&quot;Janela&quot;</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="ecologico_book_files/figure-html/unnamed-chunk-68-1.png" width="100%" style="display: block; margin: auto;" /></p>
<!-- ### Tipos de splines -->
<!-- - Cubic regression spline – polinômios de grau 3 ajustados aos -->
<!-- intervalos dos dados definidos pelos nós distribuı́dos regularmente em -->
<!-- todo o escopo dos dados. A base é a soma de nós mais 2, que -->
<!-- correspondem ao inı́cio e fim da curva. Os polinômios são unidos de -->
<!-- forma que a existir as 1 e 2 derivadas. -->
<!-- - Cyclic cubic regression spline – força a função a ter o mesmo valor e -->
<!-- mesmas derivadas no inı́cio e final. Interessante para séries de tempo -->
<!-- com sazonalidade. -->
<!-- - P-splines – Baseia-se na B-spline, na qual a função vai -->
<!-- obrigatoriamente a zero em m+3 nós adjacentes. A p-spline se baseia -->
<!-- nessa, porém aplica uma penalidade diferencial entre β’s adjacentes -->
<!-- para controlar a “wiggliness”. -->
<!-- - Thin plate – menor erro quadrático, menor número de parâmetros -->
<!-- considerado o estimador ótimo. Facilmente adaptável para duas/três -->
<!-- dimensões. -->
<!-- Tensor Product – Semelhante ao Thin Plate, mas permite escalas -->
<!-- | bs=  |    Descrição     | Vantagens                                                    | Desvantagens                                                 | -->
<!-- | :--: | :--------------: | ------------------------------------------------------------ | ------------------------------------------------------------ | -->
<!-- | "tp" |    Thin Plate    | Suaviza múltiplas covariáveis. Não se altera com a rotação. Estimador ótimo. | Computacionalmente custoso. Não é invariante quanto à escala. | -->
<!-- | "cr" | Cubic Regression | Computacionalmente barato. Parâmetros interpretáveis diretamente. | Só uma covariável. Baseado na escolha dos nós. Estimador não ótimo. | -->
<!-- | "cc" |    Cyclic CRS    | Começo e fim = 's                                            | Idem.                                                        | -->
<!-- | "ps" |    P-splines     | Qualquer combinação de base e ordem.                         | Nós em intervalos iguais. Penalidades difíceis de interpretar. Estimador não ótimo. | -->
<!-- ```{r, echo=T, warning=FALSE, results='asis', message = FALSE, out.width = "100%", fig.align = "center"} -->
<!-- ### Tipos de splines -->
<!-- library(mgcv) -->
<!-- rain.tp <- gam(totrain ~ s(week,bs="tp"), data=lepto ) -->
<!-- rain.ps <- gam(totrain ~ s(week,bs="ps"), data=lepto ) # -->
<!-- rain.cc <- gam(totrain ~ s(week,bs="cc"), data=lepto ) # -->
<!-- rain.cr <- gam(totrain ~ s(week,bs="cr"), data=lepto ) # -->
<!-- rain.ad <- gam(totrain ~ s(week,bs="ad"), data=lepto )  -->
<!-- ThinPlate  <- predict(rain.tp)   -->
<!-- P.spline <- predict(rain.ps)   -->
<!-- CubicRegression <- predict(rain.cr)   -->
<!-- CyclicCR <- predict(rain.cc)   -->
<!-- Adaptative <- predict(rain.ad)  -->
<!-- xyplot(Adaptative +CyclicCR  + CubicRegression+P.spline + ThinPlate~ week, -->
<!--  outer=TRUE, layout=c(1, 5), pch=19, cex=.2, ylab="", -->
<!--  scales=list(x=list(at=seq(0,416,52),relation='same'), y=list(relation="same")), data=lepto) -->
<!-- ``` -->
<!-- ```{r, echo=T, warning=FALSE, results='asis', message = FALSE, out.width = "100%", fig.align = "center"} -->
<!-- par(mfrow=c(5,1),mai=c(0.2,0.5412 ,0.5412,0.05),mgp=c(2,.5,0)) -->
<!-- plot(rain.tp,shade=TRUE,ylab="TP",xlab="",residuals=F,xaxp=c(0,416,8),main="Chuva", pch=19, cex=.2, xaxt="n") -->
<!-- plot(rain.ps,shade=TRUE,main="",ylab="PS",xlab="",residuals=F,xaxp=c(0,416,8),  pch=19, cex=.2,  xaxt="n") -->
<!-- plot(rain.cr,shade=TRUE,main="",ylab="CC",xlab="",residuals=F,xaxp=c(0,416,8),  pch=19, cex=.2,  xaxt="n") -->
<!-- plot(rain.cc,shade=TRUE,main="",ylab="CC",xlab="",residuals=F,xaxp=c(0,416,8),  pch=19, cex=.2,  xaxt="n") -->
<!-- plot(rain.ad,shade=TRUE,main="",ylab="Adaptative",xlab="",residuals=F,xaxp=c(0,416,8),  pch=19, cex=.2) -->
<!-- temp.tp <- gam(tempmed ~ s(week,bs="tp",k=52), data=lepto)  -->
<!-- temp.ps <- gam(tempmed ~ s(week,bs="ps",k=52), data=lepto ) # -->
<!-- temp.cc <- gam(tempmed ~ s(week,bs="cc",k=52), data=lepto ) -->
<!-- par(mfrow=c(3,1),mai=c(0.05,0.5412 ,0.5412,0.05),mgp=c(2,1,0)) -->
<!-- plot(temp.tp,shade=TRUE,ylab="TP",xlab="",xaxp=c(0,416,8) , main="Temperatura", cex=2) -->
<!-- plot(temp.ps,shade=TRUE,main="",ylab="PS",xlab="",xaxp=c(0,416,8), cex=2) -->
<!-- plot(temp.cc,shade=TRUE,main="",ylab="CC",xlab="",xaxp=c(0,416,8), cex=2) -->
<!-- cases.tp <- gam(cases ~ s(week,bs="tp",k=52), data=lepto ) #ciclica -->
<!-- cases.ps <- gam(cases ~ s(week,bs="ps",k=52), data=lepto ) # -->
<!-- cases.cc <- gam(cases ~ s(week,bs="cc",k=52), data=lepto) -->
<!-- par(mfrow=c(3,1),mai=c(0.05,0.5412 ,0.5412,0.05),mgp=c(2,1,0)) -->
<!-- plot(cases.tp,shade=TRUE,ylab="TP",xlab="",xaxp=c(0,416,8), main="Casos", cex=2) -->
<!-- plot(cases.ps,shade=TRUE,main="",ylab="PS",xlab="",xaxp=c(0,416,8), cex=2) -->
<!-- plot(cases.cc,shade=TRUE,main="",ylab="CC",xlab="",xaxp=c(0,416,8), cex=2) -->
<!-- ``` -->
</div>
</div>
<div id="exercícios-propostos-2" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Exercícios Propostos</h2>
<ol style="list-style-type: decimal">
<li><p>Seja <span class="math inline">\(Z_t\)</span> <a href="https://gitlab.procc.fiocruz.br/oswaldo/eco2019/raw/master/dados/temperaturaNY.csv"><em>(temperaturaNY.csv)</em></a> uma série temporal referente às médias anuais das temperaturas na cidade de Nova York durante os anos de 1912 e 1971. Utilize e discuta alguns métodos de transformação e/ou suavização para descrever a série.</p></li>
<li><p>Faça o mesmo com a série de dengue nas Filipinas <a href="https://gitlab.procc.fiocruz.br/oswaldo/eco2019/raw/master/dados/denguecases2.csv"><em>(denguecases2.csv)</em></a></p></li>
</ol>
<p>Verifique as séries com atenção e veja como será a melhor maneira de ler e transformar o dado em ST. Lembre-se que no windows você talvez precise precisar rodar o código:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="transformações-e-suavizações.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">url.method=</span><span class="st">&quot;libcurl&quot;</span>)</span>
<span id="cb63-2"><a href="transformações-e-suavizações.html#cb63-2" aria-hidden="true" tabindex="-1"></a>scan.win <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">scan</span>(<span class="fu">url</span>(x,<span class="at">method =</span> <span class="st">&#39;libcurl&#39;</span>))}</span></code></pre></div>
</div>
<div id="bibliografia-sugerida-2" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Bibliografia sugerida</h2>
<p>Faraway, J.J. Extending the Linear Model with R. Chapman &amp; Hall/CRC Texts in Statistical Science Series, 2006.</p>
<p>Hastie, T.; Tibshirani, R. Generalised Additive Models. Chapman &amp; Hall, 1990.</p>
<p>Wood, S.N. Generalized Additive Models: An Introduction with R. Chapman &amp; Hall/CRC Texts in Statistical Science Series, 2006.</p>
<p>Venables, W.N. &amp; Ripley, B.D. Modern Applied Statistics with S. (MASS) Fourth Edition 2002</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introdução-às-séries-temporais.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelagem-em-séries-temporais.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"scroll_highlight": true,
"toolbar": {
"position": "fixed"
},
"search": true,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
